(this.webpackJsonpreactapp=this.webpackJsonpreactapp||[]).push([[0],{162:function(e,t,a){e.exports=a(268)},26:function(e,t,a){},268:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(17),s=a.n(r),l=a(6),i=a(7),c=a(9),u=a(8),m=a(124),d=(a(18),m),h=o.a.createContext(m.initializeApp({apiKey:"AIzaSyCGE8_j8cfIBmIzcvP6CVgG2yC6EE1Ep1U",authDomain:"wodtrackrr.firebaseapp.com",databaseURL:"https://wodtrackrr.firebaseio.com",projectId:"wodtrackrr",storageBucket:"wodtrackrr.appspot.com",messagingSenderId:"743601990099",appId:"1:743601990099:web:5937e9151eaad13e93a726",measurementId:"G-39CF0BRPMH"})),p=(a(35),a(14)),f=a(22),v=a(311),b=a(337),E=a(338),y=a(127),g=a.n(y),x=(a(26),a(10)),w=(a(31),a(155)),k=a(345),D=a(64),O=a.n(D),C=a(269),j=a(77),S=a(60),I=a(54),B=a(98),M=a.n(B);function R(e){var t=e.split(":"),a=Object(S.a)(t,2),n=a[0],o=a[1];return 60*parseInt(n)+parseInt(o)}function T(e){var t=Math.floor(e/60),a=Math.floor(e-60*t);return a<10&&(a="0".concat(a)),"".concat(t,":").concat(a)}d.database();var W=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:e.stats},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"createChart",value:function(){var e=this;this.ctx=document.getElementById("lineChart");var t=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);t.addColorStop(0,"#01d3fe"),t.addColorStop(1,"#0890fd"),this.lineChart&&this.lineChart.destroy(),this.lineChart=new M.a(this.ctx,{type:"line",data:{label:"Scores",datasets:[{label:"Score",barPercentage:.5,barThickness:6,maxBarThickness:8,minBarLength:2,backgroundColor:t,data:this.state.data}]},options:{scales:{yAxes:[{ticks:{callback:function(t,a,n){return"time"===e.state.scoreType?T(t):"reps"===e.state.scoreType?t:void 0}}}]},tooltips:{callbacks:{title:function(e,t){},label:function(t,a){var n=a.datasets[t.datasetIndex].label||"";return n&&(n+=": "),"time"===e.state.scoreType?n+=T(t.yLabel):"reps"===e.state.scoreType&&(n+=t.yLabel),n}}},maintainAspectRatio:!1},plugins:[{beforeInit:function(e){e.data.datasets[0].data}}]})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(Object(x.a)({},e),(function(){t.createChart()}))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement("div",{style:{height:"25vh","max-width":"50vw"}},o.a.createElement("canvas",{id:"lineChart"})))}}]),a}(n.Component),P=W=Object(k.a)(W),L=a(149),U=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:new Map},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(Object(x.a)({},e),(function(){t.state.values.length>0&&t.createChart(t.binData(t.state.values))}))}},{key:"createChart",value:function(e){var t=Object(S.a)(e,2),a=t[0],n=t[1];this.ctx=document.getElementById("barChart");var o=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);o.addColorStop(0,"#01d3fe"),o.addColorStop(1,"#0890fd"),this.barChart&&this.barChart.destroy(),this.barChart=new M.a(this.ctx,{type:"bar",data:{labels:a,datasets:[{label:"Scores (Standard Deviation)",minBarLength:1,backgroundColor:o,data:n}]},options:{maintainAspectRatio:!1}})}},{key:"format",value:function(e){return"time"===this.state.scoreType?e<=0?0:T(e):"reps"===this.state.scoreType?parseFloat(e):void 0}},{key:"createLabels",value:function(e,t){for(var a=[],n=0;n<3;n++){var o="".concat(this.format(e-t*(n+1))," - ").concat(this.format(e-t*n)),r="".concat(this.format(e+t*n)," - ").concat(this.format(e+t*(n+1)));a.unshift(o),a.push(r)}return a}},{key:"binData",value:function(e){var t,a=Object(I.standardDeviation)(e),n=Object(I.mean)(e),o=this.createLabels(n,a),r=[0,0,0,0,0,0],s=Object(L.a)(e);try{for(s.s();!(t=s.n()).done;){var l=t.value-n,i=Math.floor(l/a);Math.abs(i)<=1?l>0?r[3]++:r[2]++:Math.abs(i)<=2?l>0?r[4]++:r[1]++:l>0?r[5]++:r[0]++}}catch(c){s.e(c)}finally{s.f()}return[o,r]}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement("div",{style:{height:"25vh","max-width":"50vw"}},o.a.createElement("canvas",{id:"barChart"})))}}]),a}(n.Component)),A=U=Object(k.a)(U),F=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,graphData:[],rawScores:[],scoreType:"",stats:{}},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){if(e.scores&&e.scores.length>0){var t=this.transformData(e.scores),a=Object(S.a)(t,4),n=a[0],o=a[1],r=a[2],s=a[3],l=o.length>1;this.setState(Object(x.a)(Object(x.a)({},e),{},{graphData:n,rawScores:o,scoreType:r,stats:s,showCharts:l}))}else this.setState(Object(x.a)({},e))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"transformData",value:function(e){for(var t=[],a="",n=e.map((function(e){return a=e.scoreType,"time"===e.scoreType?R(e.score):parseFloat(e.score)})),o=0;o<n.length;o++)t.push({x:o,y:n[o],c:0});return[t,n,a,this.getDescStats(n)]}},{key:"getDescStats",value:function(e){return console.log(e),{min:Math.min.apply(Math,Object(j.a)(e)),max:Math.max.apply(Math,Object(j.a)(e)),mean:Object(I.mean)(e),median:Object(I.median)(e),sd:Object(I.standardDeviation)(e)}}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(v.a,{item:!0,container:!0,align:"center",xs:12},o.a.createElement(v.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(C.a,null,"Low: ","time"===this.state.scoreType?T(this.state.stats.min):this.state.stats.min))),o.a.createElement(v.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(C.a,null,"High: ","time"===this.state.scoreType?T(this.state.stats.max):this.state.stats.max))),o.a.createElement(v.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(C.a,null,"Avg: ","time"===this.state.scoreType?T(this.state.stats.mean):this.state.stats.mean)))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(P,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(A,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})))}}]),a}(n.Component),N=F=Object(k.a)(F),G=a(315),K=a(316),V=a(317),z=a(318),Z=a(319),H=a(320),J=a(321),q=a(322),_=a(323),Q=a(38),X=a.n(Q),Y=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(G.a,{component:w.a},o.a.createElement(K.a,{"aria-label":"score table"},o.a.createElement(V.a,null,o.a.createElement(z.a,null,"Username"),o.a.createElement(z.a,null,"Score"),o.a.createElement(z.a,null)),o.a.createElement(Z.a,null,this.state.scores.map((function(t){var a=e.state.uid==t.uid;return o.a.createElement(ee,{info:t,onRemove:e.props.onRemove,isUserScore:a})}))))):o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(H.a,{variant:"outlined",color:"primary"},o.a.createElement(J.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))))}}]),a}(n.Component),$=Y=Object(k.a)(Y);var ee=Object(k.a)((function(e){var t=e.info.score,a=e.info.username,n=(e.info.wodID,e.info.uid,e.info.scoreID);return e.isUserScore,o.a.createElement(q.a,{selected:e.isUserScore},o.a.createElement(z.a,null,a),o.a.createElement(z.a,null,t),e.isUserScore?o.a.createElement(z.a,{align:"right"},o.a.createElement(_.a,{size:"small",onClick:function(){return e.onRemove(n)}},o.a.createElement(X.a,{color:"error"}))):o.a.createElement(z.a,null))})),te=a(21),ae=a(28),ne=a.n(ae),oe=a(347),re=a(325),se=a(326),le=a(343),ie=d.firestore();function ce(e){return new Promise((function(t,a){ie.collection("scores").doc(e).delete().then((function(){t("Successfully removed score: ".concat(e))})).catch((function(t){a("Failed to remove score: ".concat(e))}))}))}d.database();var ue=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,wodMD:e.wodMD},console.log(e),n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"objListToArray",value:function(e){return Array.from(Object.entries(e),(function(e){return new Map(Object.entries(e[1]))}))}},{key:"isNumInSane",value:function(e){return-1===e.search(/\D/)}},{key:"handleAddScore",value:function(){if(this.state.userMD){var e="";if("time"===this.state.wodMD.scoreType){var t=document.getElementById("scoreViewUserScoreMins").value,a=document.getElementById("scoreViewUserScoreSecs").value;if(!this.isNumInSane(t)||!this.isNumInSane(a))return void alert("Time must only contain numbers, entered: ".concat(t,":").concat(a));if(parseInt(a)>59)return void alert("Seconds must be 59 or below, entered: ".concat(a));if(parseInt(a)<10&&1===a.length&&(a="0".concat(a)),isNaN(parseInt(a))||isNaN(parseInt(t)))return void alert("Missing field, entered: ".concat(t,":").concat(a));if(t.length>2)return void alert("Minutes must be 99 or below, entered: ".concat(t));0===t.length&&(t="0"),0===a.length&&(a="0"),e="".concat(t,":").concat(a)}else{if((e=document.getElementById("scoreViewUserScore").value).length>3)return void alert("Score must be 3 digits or less, entered: ".concat(e));if(!e)return void alert("Must enter score.");if(!this.isNumInSane(e))return void alert("Score must be digits only, entered: ".concat(e))}var n=this.state.userMD.username,o=this.state.userMD.uid,r=this.state.wodMD.wodID,s=this.state.wodMD.gymClassID,l=this.state.wodMD.boxID;(function(e,t,a,n,o,r,s,l){return new Promise((function(i,c){var u={uid:a,wodID:o,gymClassID:r,boxID:s,username:t,title:e,score:n,scoreType:l,date:Date.now()};ie.collection("scores").where("uid","==",a).where("wodID","==",o).get().then((function(e){var t="";if(console.log(e),e.empty){var a=ie.collection("scores").doc();u.scoreID=a.id,a.set(u).then((function(){i("Added new score.")})).catch((function(e){c(e)}))}else e.forEach((function(e){t=e.data().scoreID})),u.scoreID=t,ie.collection("scores").doc(t).set(u).then((function(){i("Updated score.")})).catch((function(e){c(e)}))}),(function(e){c(e)}))}))})(this.state.wodMD.title,n,o,e,r,s,l,this.state.wodMD.scoreType).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}}},{key:"render",value:function(){var e,t,a;return o.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(oe.a,null,o.a.createElement(re.a,{style:{background:this.props.theme.palette.primary.main},expandIcon:o.a.createElement(ne.a,null),"aria-label":"Expand","aria-controls":"additional-actions2-content",id:"additional-actions2-header"},o.a.createElement(C.a,null,"Add Score")),o.a.createElement(se.a,null,o.a.createElement(C.a,null,this.state.wodMD.scoreType.replace(this.state.wodMD.scoreType[0],this.state.wodMD.scoreType[0].toUpperCase())),o.a.createElement(G.a,null,o.a.createElement(K.a,null,o.a.createElement(q.a,null,"reps"===this.state.wodMD.scoreType?o.a.createElement(z.a,{align:"center",colSpan:2},o.a.createElement(le.a,(e={id:"scoreViewUserScore",type:"number",style:{margin:8},pattern:"[0-9]{4}",inputProps:{title:"Numbers only, max length 4",placeholder:"Score"},margin:"normal"},Object(te.a)(e,"style",{width:"100%"}),Object(te.a)(e,"color","primary"),Object(te.a)(e,"InputLabelProps",{shrink:!0}),e))):o.a.createElement(o.a.Fragment,null,o.a.createElement(z.a,{align:"center"},o.a.createElement(le.a,(t={id:"scoreViewUserScoreMins",type:"number",style:{margin:8},pattern:"[0-9]{3}",inputProps:{title:"Numbers only, max length 3",placeholder:"Minutes"}},Object(te.a)(t,"style",{width:"100%"}),Object(te.a)(t,"margin","normal"),Object(te.a)(t,"color","primary"),Object(te.a)(t,"InputLabelProps",{shrink:!0}),t))),o.a.createElement(z.a,{align:"center"},o.a.createElement(le.a,(a={id:"scoreViewUserScoreSecs",type:"number",style:{margin:8},pattern:"[0-9]{2}",inputProps:{title:"Numbers only, max length 2",placeholder:"Seconds"}},Object(te.a)(a,"style",{width:"100%"}),Object(te.a)(a,"margin","normal"),Object(te.a)(a,"color","primary"),Object(te.a)(a,"InputLabelProps",{shrink:!0}),a))))),o.a.createElement(q.a,null,o.a.createElement(z.a,{colSpan:3,align:"center"},o.a.createElement(_.a,{color:"primary",style:{width:"100%"},variant:"outlined",onClick:this.handleAddScore.bind(this)},"Add"))))))))}}]),a}(n.Component),me=ue=Object(k.a)(ue),de=a(340),he=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={open:e.open},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(de.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(v.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(C.a,{style:{position:""}},this.props.modalText),o.a.createElement(_.a,{color:"primary",variant:"outlined",onClick:function(){e.props.onAction()}},this.props.actionText),o.a.createElement(_.a,{color:"error",variant:"outlined",onClick:function(){e.props.onClose()}},this.props.cancelText)))))}}]),a}(n.Component),pe=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,boxID:e.boxID,wodID:e.wodID,wodMD:{},scores:[],userScore:{},curRemoveScoreID:"",showRemoveAlert:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=d.firestore();this.wodListener=t.collection("wods").doc(this.state.wodID).onSnapshot((function(t){e.setState({wodMD:t.data()})}),(function(e){console.log(e)})),this.scoreListener=t.collection("scores").where("wodID","==",this.state.wodID).onSnapshot((function(t){if(t.empty)e.setState({scores:[],userScore:{}});else{var a=[],n={},o="";t.forEach((function(t){var r=t.data();a.push(r),o=r.scoreType,r.uid===e.state.uid&&(n=r)}));var r=o&&"time"===o?1:0;a.sort((function(e,t){return r?parseFloat(e.score)<parseFloat(t.score)?-1:1:parseFloat(e.score)>parseFloat(t.score)?1:-1})),e.setState({scores:a,userScore:n})}}),(function(e){}))}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),console.log(e)}},{key:"componentWillUnmount",value:function(){void 0!==this.scoreListener&&this.scoreListener(),void 0!==this.wodListener&&this.wodListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveScore",value:function(e){console.log("Remove score with ID: ".concat(e)),this.setState({curRemoveScoreID:e,showRemoveAlert:!0})}},{key:"removeScore",value:function(){var e=this,t=this.state.curRemoveScoreID;""===t||t.length<=0||(this.setState({showRemoveAlert:!1}),ce(t).then((function(t){console.log(t),e.setState({showRemoveAlert:!1})})).catch((function(e){console.log(e)})))}},{key:"render",value:function(){return console.log(this.state.userMD),o.a.createElement(o.a.Fragment,null,Object.keys(this.state.wodMD).length>0?o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(v.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(C.a,null,this.state.wodMD.title),o.a.createElement(C.a,null,"Type: ",this.state.wodMD.scoreType))),o.a.createElement(v.a,{item:!0,container:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(O.a,null,this.state.wodMD.wodText))),Object.keys(this.state.userMD).length>0?o.a.createElement(me,{userMD:this.state.userMD,wodMD:this.state.wodMD}):o.a.createElement(o.a.Fragment,null),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(N,{scores:this.state.scores}))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement($,{scores:this.state.scores,uid:this.state.userMD.uid,onRemove:this.handleRemoveScore.bind(this)}))),o.a.createElement(he,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.removeScore.bind(this),modalText:"Remove score?",actionText:"Remove",cancelText:"Cancel"})):o.a.createElement(o.a.Fragment,null,"Wod not found!"))}}]),a}(n.Component)),fe=pe=Object(k.a)(pe),ve=a(329),be=a(39),Ee=a.n(be),ye=d.firestore();function ge(e){return ye.collection("gymClasses").where("boxID","==",e)}function xe(e){var t=["wods","scores","gymClasses"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,o,r){var s=ye.batch();ye.collection(t).where(a,"==",n).get().then((function(l){var i=0;l.size,l.forEach((function(e){s.delete(e.ref),i++})),s.commit().then((function(){i>=500&&e(t,a,n,o,r)})).catch((function(e){return r(0)}))})),o(1)}(t,"gymClassID",e,a,n)}))}));return Promise.all(t)}d.firestore();var we=Object(k.a)((function(e){var t=e.info.title,a=(e.info.boxID,e.info.gymClassID);return o.a.createElement(q.a,{id:"class/".concat(a),name:"GymClassRow",onClick:function(t){e.onRowClick(t,"/class/".concat(a))}},o.a.createElement(z.a,{align:"left"},o.a.createElement(C.a,{variant:"subtitle",color:"primary"},t)),o.a.createElement(z.a,{align:"right"},e.isOwner?o.a.createElement(_.a,{onClick:function(){e.handleRemoveGymClass(a)}},o.a.createElement(X.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))})),ke=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,isOwner:e.isOwner,boxID:e.boxID,redirect:!1,redirectTo:"",filteredGymClasses:[],gymClasses:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getGymClasses(this.state.boxID)}},{key:"getGymClasses",value:function(e){var t=this;e&&ge(this.state.boxID).onSnapshot((function(e){if(e.empty)t.setState({gymClasses:[],filteredGymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data())})),t.setState({gymClasses:a,filteredGymClasses:a})}}),(function(e){console.log(e)}))}},{key:"handleRemoveGymClass",value:function(e){console.log("remove class",e)}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),this.getGymClasses(e.boxID)}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.gymClasses.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredGymClasses:a})}},{key:"onRowClick",value:function(e,t){"TD"===e.target.tagName&&this.setState({redirect:!0,redirectTo:t})}},{key:"handleRemoveGymClass",value:function(e){xe(e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,xs:12},this.state.redirect?o.a.createElement(f.a,{to:this.state.redirectTo}):o.a.createElement(o.a.Fragment,null),o.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(w.a,{elevation:2,component:"form"},o.a.createElement(le.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Classes",InputProps:{startAdornment:o.a.createElement(ve.a,{position:"start"},o.a.createElement(Ee.a,{color:"primary"}))}}))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(G.a,null,o.a.createElement(K.a,{stickyHeader:!0},o.a.createElement(V.a,null,o.a.createElement(q.a,null,o.a.createElement(z.a,null,"Classes"),o.a.createElement(z.a,null))),o.a.createElement(Z.a,null,this.state.filteredGymClasses.map((function(t,a){return o.a.createElement(we,{key:a,info:t,handleRemoveGymClass:e.handleRemoveGymClass.bind(e),isOwner:e.props.isOwner,onRowClick:e.onRowClick.bind(e)})})))))))}}]),a}(n.Component),De=ke=Object(k.a)(ke),Oe=a(339);function Ce(e){var t=["wods","scores"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,o,r){var s=d.firestore(),l=s.batch();s.collection(t).where(a,"==",n).get().then((function(s){var i=0;0==s.size&&o(1),s.forEach((function(e){console.log("delete"),console.log(e.data()),l.delete(e.ref),i++})),l.commit().then((function(){i>=500&&e(t,a,n,o,r)})).catch((function(e){return r(0)}))})),o(1)}(t,"wodID",e,a,n)}))}));return Promise.all(t)}d.database();var je=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={wodInfo:e.wodInfo,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,open:e.open,onClose:e.onClose,title:e.title,wodText:e.wodText},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"editWOD",value:function(){var e=this,t=document.getElementById("editOwnerBoxAddWodBoxID").value,a=document.getElementById("editOwnerBoxAddWodTitle").value,n=document.getElementById("editOwnerBoxAddWodScoreType").value,o=document.getElementById("editOwnerBoxAddWodWodText").value,r=this.state.wodInfo.wodID;if(!t||!a||!n||!o||!r)return console.log("Error with input editWod"),void console.log(t,a,n,o);(function(e,t,a,n,o){var r=d.firestore();return new Promise((function(s,l){r.collection("wods").doc(t).update({boxID:e,title:a,wodText:n,scoreType:o}).then((function(){s("Finished updating.")})).catch((function(e){l(e)}))}))})(t,r,a,o,n).then((function(t){console.log(t),e.props.onClose()})).catch((function(e){console.log(e)}))}},{key:"handleValChange",value:function(e,t){var a=e.target.name;console.log(a,t),this.setState(Object(te.a)({},a,e.target.value))}},{key:"render",value:function(){var e=this.state.wodInfo.scoreType,t=this.state.wodInfo.boxID;return o.a.createElement(de.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"edit-wod-modal","aria-describedby":"edit-wod"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(v.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(C.a,{style:{position:""}},"Edit Wod(",this.state.wodInfo.wodID,")"),o.a.createElement(v.a,{item:!0,container:!0,xs:12},o.a.createElement(v.a,{item:!0,xs:6},o.a.createElement(Oe.a,{native:!0,inputProps:{name:"Box",id:"editOwnerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,a){var n=e.boxID;return o.a.createElement("option",{key:a,value:n,selected:t===n},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!"))),o.a.createElement(v.a,{item:!0,xs:6},o.a.createElement(Oe.a,{native:!0,inputProps:{name:"Score Type",id:"editOwnerBoxAddWodScoreType"}},["time","reps"].map((function(t){return o.a.createElement("option",{value:t,selected:e===t},t)})))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(le.a,{id:"editOwnerBoxAddWodTitle",type:"text",name:"title",style:{margin:8},value:this.state.title,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(le.a,{id:"editOwnerBoxAddWodWodText",type:"text",name:"wodText",style:{margin:8},value:this.state.wodText,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Workout here"},margin:"normal",color:"primary",multiline:!0,rows:5,InputLabelProps:{shrink:!0}})),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"outlined",color:"primary",onClick:this.editWOD.bind(this)},"Update")),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"outlined",color:"primary",onClick:this.props.onClose},"Cancel")))))))}}]),a}(n.Component),Se=a(349),Ie=a(344),Be=a(110),Me=a.n(Be);var Re=Object(k.a)((function(e){var t=e.info.title,a=e.info.scoreType,n=e.info.wodText,r=e.info.wodID,s=e.info.boxID,l=e.info.date;return o.a.createElement(q.a,null,o.a.createElement(z.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},new Date(l).toLocaleDateString("en-US"))),o.a.createElement(z.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},t)),o.a.createElement(z.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},a)),o.a.createElement(z.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},o.a.createElement(O.a,null,n))),o.a.createElement(z.a,{align:"right"},o.a.createElement(p.b,{to:"/wod/".concat(s,"/").concat(r),component:_.a,color:"primary",variant:"outlined"},"View"),e.showOwnerBtns?o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{size:"small",color:"secondary",onClick:function(){return e.handleEdit(e.info)}},o.a.createElement(Me.a,null)),o.a.createElement(_.a,{size:"small",onClick:function(){return e.handleRemove(e.info)}},o.a.createElement(X.a,{color:"error"}))):o.a.createElement(o.a.Fragment,null)))})),Te=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={headers:e.headers,rows:e.rows,filteredRows:e.filteredRows,orderTableBy:"date",orderTable:"asc",pageNum:0,rowsPerPage:5,pageStart:0,pageEnd:5},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.rows.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredRows:a})}},{key:"descendingComparator",value:function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}},{key:"getComparator",value:function(e,t){var a=this;return"desc"===e?function(e,n){return a.descendingComparator(e,n,t)}:function(e,n){return-a.descendingComparator(e,n,t)}}},{key:"stableSort",value:function(e){var t=this.state.filteredRows.map((function(e,t){return[e,t]}));return t.sort((function(t,a){var n=e(t[0],a[0]);return 0!==n?n:t[1]-a[1]})),t.map((function(e){return e[0]}))}},{key:"createSortHandler",value:function(e){var t=this.state.orderTableBy===e&&"asc"===this.state.orderTable;this.setState({orderTableBy:e,orderTable:t?"desc":"asc"})}},{key:"handleChangePage",value:function(e,t){var a=t*this.state.rowsPerPage,n=t*this.state.rowsPerPage+this.state.rowsPerPage;this.setState({pageNum:t,pageStart:a,pageEnd:n})}},{key:"handleChangeRowsPerPage",value:function(e){var t=parseInt(e.target.value);console.log(t),this.setState({pageNum:0,rowsPerPage:t,pageStart:0,pageEnd:t})}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,xs:12,align:"center"},o.a.createElement(w.a,{elevation:2},o.a.createElement(w.a,{elevation:2,component:"form"},o.a.createElement(le.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search",InputProps:{startAdornment:o.a.createElement(ve.a,{position:"start"},o.a.createElement(Ee.a,{color:"primary"}))}})),o.a.createElement(v.a,{container:!0,item:!0,xs:12},o.a.createElement(G.a,null,o.a.createElement(K.a,null,o.a.createElement(V.a,null,o.a.createElement(q.a,null,this.state.headers.map((function(t){return o.a.createElement(z.a,null,t.sortable?o.a.createElement(Se.a,{active:t.id===e.state.orderTableBy,direction:t.id===e.state.orderTableBy?e.state.orderTable:"asc",onClick:function(){e.createSortHandler(t.id)}},t.label):o.a.createElement(o.a.Fragment,null,t.label))})))),o.a.createElement(Z.a,null,this.state.filteredRows.length>0?this.stableSort(this.getComparator(this.state.orderTable,this.state.orderTableBy)).slice(this.state.pageStart,this.state.pageEnd).map((function(t){return o.a.createElement(Re,{handleView:e.props.handleView,handleRemove:e.props.handleRemove,handleEdit:e.props.handleEdit,info:t,showOwnerBtns:e.props.showOwnerBtns})})):o.a.createElement("span",null,"No data!")))),o.a.createElement(Ie.a,{rowsPerPageOptions:[5,10,25],component:"div",count:this.state.filteredRows.length,rowsPerPage:this.state.rowsPerPage,page:this.state.pageNum,onChangePage:this.handleChangePage.bind(this),onChangeRowsPerPage:this.handleChangeRowsPerPage.bind(this)}))))}}]),a}(n.Component),We=Te=Object(k.a)(Te),Pe=d.firestore(),Le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),n=t.call(this,e),console.log(e),n.state={userMD:e.userMD,boxID:e.boxID,boxMD:{},userBoxes:[],hasBoxes:!1,wods:[],currentWodID:"",currentWodMD:{},showRemoveAlert:!1,showEditModal:!1,editWodInfo:{},curRemoveWodBoxID:"",curRemoveWodID:"",curRemoveWodTitle:""},n}return Object(i.a)(a,[{key:"getUserBoxListener",value:function(){var e=this;this.state.userMD.uid&&(this.userBoxesListener=Pe.collection("boxes").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a=[];console.log(t),t.empty||t.forEach((function(e){console.log(e.data()),a.push(e.data())})),e.setState({userBoxes:a,hasBoxes:!!a.length})})))}},{key:"getBoxListener",value:function(){var e=this;this.boxListener=Pe.collection("boxes").doc(this.state.boxID).onSnapshot((function(t){t.empty?e.setState({boxMD:{}}):e.setState({boxMD:t.data()})}),(function(e){console.log(e)}))}},{key:"getWodListener",value:function(){var e=this;this.wodListener=Pe.collection("wods").where("boxID","==",this.state.boxID).onSnapshot((function(t){if(t.empty)e.setState({wods:[]});else{var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({wods:a})}}),(function(e){console.log(e)}))}},{key:"checkListeners",value:function(){void 0===this.userBoxesListener&&this.getUserBoxListener(),void 0===this.boxListener&&this.getBoxListener(),void 0===this.wodListener&&this.getWodListener()}},{key:"componentDidMount",value:function(){this.checkListeners()}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.wodListener&&this.wodListener(),this.boxListener&&this.boxListener(),this.userBoxesListener&&this.userBoxesListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveWod",value:function(e){this.setState({showRemoveAlert:!0,curRemoveWodBoxID:e.boxID,curRemoveWodID:e.wodID,curRemoveWodTitle:e.title})}},{key:"deleteWod",value:function(){var e=this;Ce(this.state.curRemoveWodID).then((function(t){console.log(t),e.setState({showRemoveAlert:!1})}))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.wods.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredWods:a})}},{key:"handleEdit",value:function(e){console.log("Populate with info, show in modal with form"),console.log(e),this.userBoxesListener||this.getUserBoxListener(),this.setState({editWodInfo:e,showEditModal:!0})}},{key:"handleEditModalClose",value:function(){this.setState({showEditModal:!1})}},{key:"render",value:function(){this.state.boxMD.uid===this.state.userMD.uid&&this.props.isReadOnly;return o.a.createElement(v.a,{item:!0,xs:12},Object.keys(this.state.boxMD).length>0?o.a.createElement(De,{user:this.state.user,userMD:this.state.userMD,boxID:this.state.boxID,isOwner:!0}):o.a.createElement(o.a.Fragment,null))}}]),a}(n.Component),Ue=Le=Object(k.a)(Le),Ae=a(76),Fe=a.n(Ae);function Ne(e){var t=d.firestore();return new Promise((function(a,n){t.collection("following").doc(e).delete().then((function(){a("Finished delete.")})).catch((function(e){n(e)}))}))}function Ge(e,t,a,n){var o=d.firestore();return new Promise((function(r,s){o.collection("following").where("uid","==",e).get().then((function(l){var i=!1;if(l.empty||l.forEach((function(e){e.data().boxID===a&&(i=!0)})),!i){var c=o.collection("following").doc(),u={followID:c.id,uid:e,username:t,boxID:a,title:n,date:Date.now()};c.set(u).then((function(){r("Followed.")})).catch((function(e){s(e)}))}}))}))}var Ke=d.firestore();var Ve=Object(k.a)((function(e){var t=e.info.title,a=e.info.boxID;return o.a.createElement(q.a,{id:"box/".concat(a),name:"BoxRow",onClick:function(t){return e.onRowClick(t,"box/".concat(a))}},o.a.createElement(z.a,{align:"left"},o.a.createElement(C.a,{variant:"subtitle",color:"primary"},t)),o.a.createElement(z.a,{align:"right"},e.isUserFollowing?o.a.createElement(_.a,{variant:"outlined",onClick:function(){e.handleUnfollow(a)}},o.a.createElement(Fe.a,{color:"primary"})):o.a.createElement(_.a,{onClick:function(){e.handleFollow(e.info)}},o.a.createElement(Fe.a,null)),e.isOwner?o.a.createElement(_.a,{onClick:function(){e.handleRemoveBox(a,t)}},o.a.createElement(X.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))})),ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,isOwner:e.isOwner,allBoxes:e.allBoxes,filteredBoxes:e.allBoxes,userFollowing:{},redirect:!1,redirectTo:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForFollowing(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),this.listenForFollowing(e)}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"listenForFollowing",value:function(e){var t=this;e.user&&Ke.collection("following").where("uid","==",e.user.uid).onSnapshot((function(e){var a={};e.empty||e.forEach((function(e){var t=e.data();console.log(t),a[t.boxID]=t.followID})),t.setState({userFollowing:a})}),(function(e){return console.log(e)}))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allBoxes.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredBoxes:a})}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"handleFollow",value:function(e){Ge(this.state.user.uid,this.state.userMD.username,e.boxID,e.title).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){Ne(this.state.userFollowing[e]).then((function(e){e&&console.log("Succefully unfollowed.")})).catch((function(e){console.log(e)}))}},{key:"onRowClick",value:function(e,t){console.log(t),"TD"===e.target.tagName&&this.setState({redirect:!0,redirectTo:t})}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,xs:12},this.state.redirect?o.a.createElement(f.a,{to:this.state.redirectTo}):o.a.createElement(o.a.Fragment,null),o.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(w.a,{elevation:2,component:"form"},o.a.createElement(le.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Boxes",InputProps:{startAdornment:o.a.createElement(ve.a,{position:"start"},o.a.createElement(Ee.a,{color:"primary"}))}}))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(G.a,null,o.a.createElement(K.a,{stickyHeader:!0},o.a.createElement(V.a,null,o.a.createElement(q.a,null,o.a.createElement(z.a,null,"Boxes"),o.a.createElement(z.a,null))),o.a.createElement(Z.a,null,this.state.filteredBoxes.map((function(t,a){return o.a.createElement(Ve,{key:a,info:t,color:e.props.theme.palette.primary.mainGrad,handleBoxView:e.props.handleBoxView,handleRemoveBox:e.props.handleRemoveBox,isOwner:e.props.isOwner,isUserFollowing:e.isUserFollowing(t.boxID),handleFollow:e.handleFollow.bind(e),handleUnfollow:e.handleUnfollow.bind(e),onRowClick:e.onRowClick.bind(e)})})))))))}}]),a}(n.Component),Ze=ze=Object(k.a)(ze),He=d.firestore(),Je=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,allBoxes:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.allBoxesListener=He.collection("boxes").onSnapshot((function(t){if(!t.empty){var a=[];t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.title.toLowerCase()>t.title.toLowerCase()?-1:1})),e.setState({allBoxes:a})}}))}},{key:"componentWillUnmount",value:function(){void 0!==this.allBoxesListener&&this.allBoxesListener()}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12},this.state.allBoxes.length>0?o.a.createElement(Ze,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.allBoxes,isOwner:!1,isReadOnly:!1,handleRemoveBox:this.props.handleRemoveBox}):o.a.createElement(v.a,{xs:12},o.a.createElement(w.a,{elevation:2},"No boxes!")))}}]),a}(n.Component),qe=Je=Object(k.a)(Je),_e=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={redirect:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=document.getElementById("email"),a=document.getElementById("password"),n=document.getElementById("passwordConfirm");console.log(t.value,a.value),a.value===n.value?d.auth().createUserWithEmailAndPassword(t.value,a.value).then((function(e){console.log(e);var t=d.firestore(),a={username:"",admin:!1,uid:e.user.uid,accountType:"athlete"};t.collection("users").doc(e.user.uid).set(a)})).catch((function(e){console.log(e)})):alert("Passwords do not match")}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.state.redirect?o.a.createElement(f.a,{to:"/"}):o.a.createElement(v.a,{container:!0,xs:12,id:"login",align:"center",justify:"center"},o.a.createElement(w.a,{elevation:2},o.a.createElement("br",null),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement("h1",null,"Register")),o.a.createElement("br",null),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(le.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(le.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(le.a,{id:"passwordConfirm",type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})," ",o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Submit")))))}}]),a}(n.Component),Qe=_e=Object(k.a)(_e),Xe=d.firestore(),Ye=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),n=t.call(this,e),console.log(e),n.state={userMD:e.userMD,gymClassID:e.gymClassID,gymClassMD:{},gymClasses:[],userBoxes:[],hasBoxes:!1,wods:[],currentWodID:"",currentWodMD:{},showRemoveAlert:!1,showEditModal:!1,editWodInfo:{},curRemoveWodBoxID:"",curRemoveWodID:"",curRemoveWodTitle:""},n}return Object(i.a)(a,[{key:"getGymClassListener",value:function(){var e=this;Xe.collection("gymClasses").doc(this.state.gymClassID).onSnapshot((function(t){t.exists&&e.setState({gymClassMD:t.data()})}))}},{key:"getUserBoxListener",value:function(){var e=this;this.state.userMD.uid&&(this.userBoxesListener=Xe.collection("boxes").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a=[];console.log(t),t.empty||t.forEach((function(e){console.log(e.data()),a.push(e.data())})),e.setState({userBoxes:a,hasBoxes:!!a.length})})))}},{key:"getWodListener",value:function(){var e=this;this.wodListener=Xe.collection("wods").where("gymClassID","==",this.state.gymClassID).onSnapshot((function(t){if(t.empty)e.setState({wods:[]});else{var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({wods:a})}}),(function(e){console.log(e)}))}},{key:"checkListeners",value:function(){void 0===this.userBoxesListener&&this.getUserBoxListener(),void 0===this.wodListener&&this.getWodListener()}},{key:"componentDidMount",value:function(){this.checkListeners(),this.getGymClassListener()}},{key:"componentWillReceiveProps",value:function(e){console.log(e),this.setState(Object(x.a)({},e)),this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.wodListener&&this.wodListener(),this.boxListener&&this.boxListener(),this.userBoxesListener&&this.userBoxesListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveWod",value:function(e){this.setState({showRemoveAlert:!0,curRemoveWodBoxID:e.boxID,curRemoveWodID:e.wodID,curRemoveWodTitle:e.title})}},{key:"deleteWod",value:function(){var e=this;Ce(this.state.curRemoveWodID).then((function(t){console.log(t),e.setState({showRemoveAlert:!1})}))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.wods.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredWods:a})}},{key:"handleEdit",value:function(e){console.log("Populate with info, show in modal with form"),console.log(e),this.userBoxesListener||this.getUserBoxListener(),this.setState({editWodInfo:e,showEditModal:!0})}},{key:"handleEditModalClose",value:function(){this.setState({showEditModal:!1})}},{key:"isOwner",value:function(){return this.state.gymClassMD.uid===this.state.userMD.uid}},{key:"render",value:function(){return this.state.userMD?o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(v.a,{item:!0,align:"center",xs:12},o.a.createElement(C.a,{align:"center",variant:"h3"},this.state.gymClassMD.title),o.a.createElement(C.a,{align:"center",variant:"h4"},this.state.gymClassMD.boxTitle)),o.a.createElement(o.a.Fragment,null,this.state.wods.length>0?o.a.createElement(We,{rows:this.state.wods,filteredRows:this.state.wods,headers:(this.isOwner(),[{id:"date",sortable:!0,label:"Date"},{id:"title",sortable:!0,label:"Title"},{id:"scoreType",sortable:!0,label:"Scoring"},{id:"wodText",sortable:!1,label:"Wod"},{id:"btns",sortable:!1,label:""}]),handleRemove:this.handleRemoveWod.bind(this),handleEdit:this.handleEdit.bind(this),showOwnerBtns:this.isOwner()}):o.a.createElement(v.a,{xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(C.a,null,"No wods"))))),o.a.createElement(he,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteWod.bind(this),modalText:"Remove ".concat(this.state.curRemoveWodTitle," (").concat(this.state.curRemoveWodID,")?"),actionText:"Delete",cancelText:"Cancel"}),o.a.createElement(je,{open:this.state.showEditModal,onClose:this.handleEditModalClose.bind(this),userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,wodInfo:this.state.editWodInfo,title:this.state.editWodInfo.title,wodText:this.state.editWodInfo.wodText})):o.a.createElement(o.a.Fragment,null,"Loading")}}]),a}(n.Component),$e=Ye=Object(k.a)(Ye),et=a(324),tt=a(342),at=a(152),nt=a(331),ot=a(341),rt=a(332),st=a(150),lt=a.n(st),it=d.firestore();function ct(e){var t=["wods","scores","boxes"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,o,r){var s=it.batch();it.collection(t).where(a,"==",n).get().then((function(l){var i=0;l.size,l.forEach((function(e){s.delete(e.ref),i++})),s.commit().then((function(){i>=500&&e(t,a,n,o,r)})).catch((function(e){return r(0)}))})),o(1)}(t,"boxID",e,a,n)}))}));return Promise.all(t)}var ut=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,currentBoxID:"",showRemoveAlert:!1,curRemoveBoxID:"",curRemoveBoxTitle:""},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"handleRemoveBox",value:function(e,t){this.setState({showRemoveAlert:!0,curRemoveBoxID:e,curRemoveBoxTitle:t})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"deleteBox",value:function(){var e=this;ct(this.state.curRemoveBoxID).then((function(t){t.reduce((function(e,t){return e+t}),0);e.handleModalClose()})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:12},o.a.createElement(v.a,{item:12},this.state.userBoxes.length>0?o.a.createElement(Ze,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.userBoxes,handleRemoveBox:this.handleRemoveBox.bind(this),isOwner:!0}):o.a.createElement(v.a,{item:!0,zeroMinWidth:!0,xs:12},o.a.createElement(w.a,{elevation:4,style:{padding:"1vw"}},o.a.createElement(C.a,{noWrap:!0,align:"left"},"No gyms Found!")))),o.a.createElement(de.a,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(v.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(C.a,{style:{position:""}},"Remove ",this.state.curRemoveBoxTitle," (",this.state.curRemoveBoxID,")"),o.a.createElement(_.a,{color:"primary",variant:"outlined",onClick:function(){e.deleteBox()}},"Delete"))))))}}]),a}(n.Component),mt=ut=Object(k.a)(ut),dt=a(4),ht=(d.firestore(),Object(dt.a)({root:{borderBottom:"none"}})(z.a)),pt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.createGymClass()}},{key:"createGymClass",value:function(){var e=document.getElementById("addGymClassTitle").value,t=JSON.parse(document.getElementById("addGymClassBox").value);console.log(t),e&&t&&function(e,t,a,n){return new Promise((function(o,r){ye.collection("gymClasses").where("title","==",e).get().then((function(s){if(s.empty){var l,i=ye.collection("gymClasses").doc();i.set((l={gymClassID:i.id,boxID:a,boxTitle:n,title:e,uid:t},Object(te.a)(l,"uid",t),Object(te.a)(l,"date",Date.now()),l)).then((function(){o("Added gymClass")}))}else r("Name Taken")}))}))}(e,this.props.user.uid,t.boxID,t.title).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(K.a,null,o.a.createElement(q.a,null,o.a.createElement(ht,null,"Gym"),o.a.createElement(ht,null,o.a.createElement(Oe.a,{native:!0,style:{width:"100%"},inputProps:{name:"Box",id:"addGymClassBox"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),o.a.createElement(q.a,null,o.a.createElement(ht,null,"Title"),o.a.createElement(ht,null,o.a.createElement(le.a,{id:"addGymClassTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Name of class"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),o.a.createElement(q.a,null,o.a.createElement(ht,{align:"center",colSpan:2},o.a.createElement(_.a,{size:"small",variant:"outlined",color:"primary",onClick:this.createGymClass.bind(this)},"Submit")))))}}]),a}(n.Component),ft=pt=Object(k.a)(pt),vt=a(111),bt=a.n(vt),Et=["cm","in","ft","M","Mi","mins","secs","lb","kg"];var yt=Object(k.a)((function(e){return o.a.createElement(v.a,{item:!0,xs:6},o.a.createElement(le.a,{type:"text",pattern:"[\\sA-Za-z0-9]{35}",InputProps:{title:"Letters only, max length 35",placeholder:"Title",endAdornment:o.a.createElement(bt.a,{fontSize:"small",onClick:function(t){e.onRemove(e.colIndex,e.colIndexKey)}})},value:e.value,margin:"small",color:"primary",InputLabelProps:{shrink:!0},onChange:function(t){console.log("onchangeTextField"),e.onUpdate(e.colIndex,e.colIndexKey,t.target.value)}}))})),gt=Object(k.a)((function(e){return o.a.createElement(v.a,{item:!0,xs:6},o.a.createElement(le.a,{type:"number",pattern:"[\\sA-Za-z0-9]{35}",InputProps:{title:"Numbers only",placeholder:"Amount",endAdornment:o.a.createElement(bt.a,{onClick:function(t){e.onRemove(e.colIndex,e.colIndexKey)}})},value:e.value,margin:"small",color:"primary",InputLabelProps:{shrink:!0},onChange:function(t){e.onUpdate(e.colIndex,e.colIndexKey,t.target.value)}}))})),xt=Object(k.a)((function(e){return o.a.createElement(v.a,{item:!0,container:!0,xs:4},o.a.createElement(v.a,{item:!0,xs:11},o.a.createElement(Oe.a,{native:!0,margin:"small",color:"primary",InputProps:{name:"gymClass",id:"AddWodGymClassID"},onChange:function(t){e.onUpdate(e.colIndex,e.colIndexKey,t.target.value)}},Et.map((function(e,t){return o.a.createElement("option",{key:t,value:e},e)})))),o.a.createElement(v.a,{item:!0,xs:1,align:"left"},o.a.createElement(bt.a,{onClick:function(t){e.onRemove(e.colIndex,e.colIndexKey)}})))})),wt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={row:e.row,index:e.index,colIndex:0,selected:e.selected},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"onUpdate",value:function(e,t,a){var n=this.state.row;n[e][t]=a,this.setState({row:n}),this.props.onRowUpdate(this.state.index,n)}},{key:"onRemove",value:function(e,t){console.log("Removing",e,t);var a=this.state.row;delete a[e][t],this.setState({row:a}),this.props.onRowUpdate(this.state.index,a)}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,xs:12,onClick:function(t){e.props.onClick(e.state.index)},style:{margin:"0px 0px 8px 0px ",border:"2px solid ".concat(this.props.theme.palette.primary.main),"border-radius":"6px"}},o.a.createElement(w.a,{style:{background:this.state.selected?this.props.theme.palette.primary.main:""}},o.a.createElement(v.a,{item:!0,container:!0,xs:12,align:"center"},o.a.createElement(v.a,{item:!0,container:!0,spacing:4,align:"left",xs:11},this.state.row.map((function(t,a){var n=Object.keys(t)[0];switch(n){case"title":return o.a.createElement(yt,{key:a,onUpdate:e.onUpdate.bind(e),onRemove:e.onRemove.bind(e),value:t[n],colIndex:a,colIndexKey:"title"});case"amount":return o.a.createElement(gt,{key:a,onUpdate:e.onUpdate.bind(e),onRemove:e.onRemove.bind(e),value:t[n],colIndex:a,colIndexKey:"amount"});case"unit":return o.a.createElement(xt,{key:a,onUpdate:e.onUpdate.bind(e),onRemove:e.onRemove.bind(e),value:t[n],colIndex:a,colIndexKey:"unit"})}}))),o.a.createElement(v.a,{item:!0,xs:1,container:!0,align:"center",justify:"center",direction:"column"},o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(X.a,{color:"error",style:{margin:"0 auto"},onClick:function(t){e.props.onRemove(e.state.index)}}))))))}}]),a}(n.Component),kt=Object(k.a)(wt),Dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={rows:[],index:0},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),e.submit&&this.onRowSubmit()}},{key:"onRowClick",value:function(e){this.setState({index:e})}},{key:"addRow",value:function(){var e=this.state.rows;e.push([]),this.setState({rows:e,index:e.length-1})}},{key:"removeRow",value:function(e){var t=this.state.rows,a=0==e?t.slice(1):[].concat(Object(j.a)(t.slice(0,e)),Object(j.a)(t.slice(e+1)));this.setState({rows:a}),this.updateParent(a)}},{key:"addItem",value:function(e){if(!(!this.state.rows.length>0)){var t=this.state.rows,a=t[this.state.index],n={};n[e]="",a.push(n),t[this.state.index]=a,this.setState({rows:t})}}},{key:"onRowSubmit",value:function(){this.props.onSubmit(this.state.rows)}},{key:"onRowUpdate",value:function(e,t){console.log("Row updated!"),console.log(t);var a=this.state.rows;a[e]=t,this.setState({rows:a}),this.updateParent(a)}},{key:"updateParent",value:function(e){this.props.onUpdate(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,align:"center"},o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(_.a,{onClick:this.addRow.bind(this)},"+Row"),o.a.createElement(_.a,{onClick:function(){e.addItem("amount")}},"+Amount"),o.a.createElement(_.a,{onClick:function(){e.addItem("title")}},"+Title"),o.a.createElement(_.a,{onClick:function(){e.addItem("unit")}},"+Unit")),o.a.createElement(v.a,{item:!0,id:"workoutText",xs:12},this.state.rows.map((function(t,a){return console.log("Row: ".concat(a)),console.log(t),o.a.createElement(kt,{key:a,index:a,row:t,selected:e.state.index==a,onClick:e.onRowClick.bind(e),onRemove:e.removeRow.bind(e),onRowUpdate:e.onRowUpdate.bind(e),theme:e.props.theme})}))))}}]),a}(n.Component),Ot=Dt=Object(k.a)(Dt);var Ct=Object(k.a)((function(e){var t=e.row.map((function(e){return e[Object.keys(e)[0]]}));console.log(t);var a=t.join(" ");return o.a.createElement(v.a,{item:!0,xs:12},a)})),jt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={rows:e.rows},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,align:"center"},o.a.createElement(v.a,{item:!0,xs:12},this.state.rows.map((function(e,t){return console.log(e),o.a.createElement(Ct,{row:e,key:t})}))))}}]),a}(n.Component),St=jt=Object(k.a)(jt),It=(d.firestore(),Object(dt.a)({root:{borderBottom:"none"}})(z.a)),Bt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,gymClasses:[],submit:!1,rows:[]},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),e.userBoxes&&this.setGymClassListner(e.userBoxes[0].boxID)}},{key:"setGymClassListner",value:function(e){var t=this;console.log("Getting snapshot for",e),ge(e).onSnapshot((function(e){if(e.empty)t.setState({gymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data()),console.log(e.data())})),t.setState({gymClasses:a})}}),(function(e){console.log(e)}))}},{key:"onBoxSelectChange",value:function(e){var t=e.target.value;this.setGymClassListner(t)}},{key:"getWorkoutData",value:function(e){console.log("Create Wod with this data"),console.log(e)}},{key:"onSubmit",value:function(){this.setState({submit:!0})}},{key:"onWorkoutUpdate",value:function(e){this.setState({rows:e})}},{key:"createWOD",value:function(){var e=document.getElementById("ownerBoxAddWodBoxID").value,t=JSON.parse(document.getElementById("AddWodGymClassID").value).gymClassID,a=document.getElementById("ownerBoxAddWodTitle").value,n=document.getElementById("ownerBoxAddWodScoreType").value,o=document.getElementById("ownerBoxAddWodWodText").value;if(!e||!t||!a||!n||!o)return console.log("Error with input createWod"),void console.log(e,t,a,n,o);(function(e,t,a,n,o){var r=d.firestore().collection("wods").doc(),s={wodID:r.id,boxID:e,gymClassID:t,title:a,scoreType:o,wodText:n,date:Date.now()};return r.set(s)})(e,t,a,o,n).then((function(){console.log("Successfully added wod.")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,container:!0,xs:12},o.a.createElement(G.a,null,o.a.createElement(K.a,null,o.a.createElement(V.a,null,o.a.createElement(q.a,null,o.a.createElement(It,null),o.a.createElement(It,null))),o.a.createElement(Z.a,null,o.a.createElement(q.a,null,o.a.createElement(It,null,o.a.createElement(C.a,{color:"primary",variant:"caption"},"Box")),o.a.createElement(It,null,o.a.createElement(Oe.a,{native:!0,style:{width:"100%"},onChange:this.onBoxSelectChange.bind(this),inputProps:{name:"Box",id:"ownerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return o.a.createElement("option",{key:t,value:e.boxID},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),o.a.createElement(q.a,null,o.a.createElement(It,null,o.a.createElement(C.a,{color:"primary",variant:"caption"},"Class")),o.a.createElement(It,null,o.a.createElement(Oe.a,{native:!0,style:{width:"100%"},inputProps:{name:"gymClass",id:"AddWodGymClassID"}},this.state.gymClasses.length>0?this.state.gymClasses.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No Classes!")))),o.a.createElement(q.a,null,o.a.createElement(It,null,o.a.createElement(C.a,{color:"primary",variant:"caption"},"Score Type")),o.a.createElement(It,null,o.a.createElement(Oe.a,{native:!0,style:{width:"100%"},inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},o.a.createElement("option",{value:"time"},"Time"),o.a.createElement("option",{value:"reps"},"Reps")))),o.a.createElement(q.a,null,o.a.createElement(It,null,o.a.createElement(C.a,{color:"primary",variant:"caption"},"Title")),o.a.createElement(It,null,o.a.createElement(le.a,{id:"ownerBoxAddWodTitle",type:"text",style:{width:"100%"},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),o.a.createElement(q.a,null,o.a.createElement(It,{colSpan:2,align:"center"},o.a.createElement(C.a,{color:"primary",variant:"caption"},"Workout"))),o.a.createElement(q.a,null,o.a.createElement(It,{colSpan:2},o.a.createElement(St,{rows:this.state.rows}))),o.a.createElement(q.a,null,o.a.createElement(It,{colSpan:2},o.a.createElement(Ot,{submit:this.state.submit,onSubmit:this.getWorkoutData.bind(this),onUpdate:this.onWorkoutUpdate.bind(this)})))))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"outlined",color:"primary",onClick:this.onSubmit.bind(this)},"Enter WOD")))}}]),a}(n.Component),Mt=(d.firestore(),Object(dt.a)({root:{borderBottom:"none"}})(z.a)),Rt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"onKeyUp",value:function(e){if(13==(e.keyCode||e.which)){var t=document.getElementById("ownerBoxAddBoxTitle").value;this.createBox(t)}}},{key:"createBox",value:function(e){e&&function(e,t){return new Promise((function(a,n){it.collection("boxes").where("title","==",e).get().then((function(o){if(o.empty){var r,s=it.collection("boxes").doc();s.set((r={boxID:s.id,title:e,uid:t},Object(te.a)(r,"uid",t),Object(te.a)(r,"date",Date.now()),r)).then((function(){a("Added box")}))}else n("Name Taken")}))}))}(e,this.props.user.uid).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(K.a,null,o.a.createElement(q.a,null,o.a.createElement(Mt,null,"Title"),o.a.createElement(Mt,null,o.a.createElement(le.a,{id:"ownerBoxAddBoxTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Name of gym"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),o.a.createElement(q.a,null,o.a.createElement(Mt,{align:"center",colSpan:2},o.a.createElement(_.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){var t=document.getElementById("ownerBoxAddBoxTitle");e.createBox(t.value)}},"Submit")))))}}]),a}(n.Component),Tt=Rt=Object(k.a)(Rt),Wt=d.firestore();function Pt(e){var t=e.children,a=e.value,n=e.index,r=Object(at.a)(e,["children","value","index"]);return o.a.createElement(v.a,Object.assign({item:!0,xs:12,role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},r),a===n&&o.a.createElement(v.a,{item:!0,xs:12},t))}var Lt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:[],hasBoxes:!1,addBoxProgress:!0,value:0},console.log(e),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForBoxes()}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),"owner"===e.userMD.accountType&&this.listenForBoxes()}},{key:"componentWillUnmount",value:function(){}},{key:"listenForBoxes",value:function(){var e=this;this.state.user&&Wt.collection("boxes").where("uid","==",this.state.user.uid).onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({hasBoxes:!0,userBoxes:a})}),(function(t){e.setState({hasBoxes:!1,userBoxes:[]})}))}},{key:"a11yProps",value:function(e){return{id:"ownerbox-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}},{key:"handleChange",value:function(e,t){this.setState({value:t})}},{key:"handleChangeIndex",value:function(e){this.setState({value:e})}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12,id:"ownerBox"},o.a.createElement(nt.a,{position:"static"},o.a.createElement(ot.a,{value:this.state.value,variant:"fullWidth",selectionFollowsFocus:!0,onChange:this.handleChange.bind(this),"aria-label":"simple tabs example"},o.a.createElement(rt.a,Object.assign({label:"Add Gym"},this.a11yProps(0))),o.a.createElement(rt.a,Object.assign({label:"Add Class"},this.a11yProps(1))),o.a.createElement(rt.a,Object.assign({label:"Add Workout"},this.a11yProps(2))),o.a.createElement(rt.a,Object.assign({label:"View Gyms & Workouts"},this.a11yProps(3))))),o.a.createElement(lt.a,{axis:"rtl"===this.props.theme.direction?"x-reverse":"x",index:this.state.value,onChangeIndex:this.handleChangeIndex.bind(this)},o.a.createElement(Pt,{value:this.state.value,index:0},o.a.createElement(Tt,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(Pt,{value:this.state.value,index:1},o.a.createElement(ft,{user:this.state.user,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes})),o.a.createElement(Pt,{value:this.state.value,index:2},o.a.createElement(Bt,{uid:this.state.user.uid,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes})),o.a.createElement(Pt,{value:this.state.value,index:3},o.a.createElement(mt,{user:this.state.user,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes}))))}}]),a}(n.Component),Ut=Object(k.a)(Lt),At=d.firestore();var Ft=Object(dt.a)({root:{borderBottom:"none"}})(z.a),Nt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,showUpdate:!1},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"updateUsername",value:function(e){var t=this,a=document.getElementById("updateUsernameInput");if("none"===a.style.display)a.style.display="block";else{if(a.value.length>12)return void alert("Username cannot be longer than 12 characters");if(null!==/\W/g.exec(a.value))return void alert("Username can only contain letters & numbers");if(a.value.length<=0)return void this.hideUpdate();(function(e,t){var a={username:t},n=[At.collection("users").doc(e).update(a)];return At.collection("scores").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),At.collection("scores").doc(e.data().scoreID).update(a)}))})),At.collection("following").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),At.collection("following").doc(e.data().followID).update(a)}))})),new Promise((function(e,t){Promise.all(n).then((function(){e("Updated!")})).catch((function(e){t(e)}))}))})(this.state.user.uid,a.value).then((function(e){console.log(e),t.hideUpdate()})).catch((function(e){console.log(e)}))}}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.updateUsername()}},{key:"toggleUpdate",value:function(){this.setState({showUpdate:!this.state.showUpdate})}},{key:"hideUpdate",value:function(){this.setState({showUpdate:!1})}},{key:"render",value:function(){return o.a.createElement(v.a,{container:!0,id:"usernamePanel"},this.state.userMD?o.a.createElement(G.a,null,o.a.createElement(K.a,null,o.a.createElement(q.a,null,o.a.createElement(Ft,null,"Username"),o.a.createElement(Ft,null,o.a.createElement(C.a,{gutterBottom:!0,variant:"h5"},this.state.userMD.username)),o.a.createElement(Ft,null,o.a.createElement(_.a,{size:"small",onClick:this.toggleUpdate.bind(this)},o.a.createElement(Me.a,{color:"primary"})))),this.state.showUpdate?o.a.createElement(q.a,null,o.a.createElement(Ft,{colSpan:2},o.a.createElement(le.a,{id:"updateUsernameInput",type:"text",style:{margin:8},pattern:"[A-Za-z]{12}",inputProps:{title:"Letters only, max length 12",placeholder:"New username"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(Ft,{align:"right"},o.a.createElement(C.a,{gutterBottom:!0,variant:"h5"},o.a.createElement(_.a,{size:"small",variant:"outlined",color:"primary",onClick:this.updateUsername.bind(this)},"Update")))):o.a.createElement(o.a.Fragment,null))):o.a.createElement("h1",null," Loading "))}}]),a}(n.Component),Gt=Nt=Object(k.a)(Nt),Kt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userFollows:[],userFollowing:{}},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e,t=this;(e=this.state.user.uid,d.firestore().collection("following").where("uid","==",e)).onSnapshot((function(e){e.docChanges().forEach((function(a){switch(a.type){case"added":console.log("Case Added!");var n=[],o={};e.forEach((function(e){var t=e.data();n.push(t),o[t.boxID]=t.followID})),t.setState({userFollows:n,userFollowing:o});break;case"modified":break;case"removed":var r=a.doc.data(),s=t.state.userFollowing;s[r.boxID]=void 0,t.setState({userFollowing:s});break;default:console.log("Uncaught change.")}}))}))}},{key:"handleFollow",value:function(e){Ge(this.state.user.uid,this.state.userMD.username,e.boxID,e.title).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){var t=this;Ne(this.state.userFollowing[e]).then((function(a){if(a){var n=t.state.userFollowing;n[e]=void 0,t.setState({userFollowing:n}),console.log("Succefully unfollowed.")}})).catch((function(e){console.log(e)}))}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{xs:12},o.a.createElement(v.a,{xs:12},o.a.createElement(v.a,{xs:12},o.a.createElement(C.a,null,"Following")),o.a.createElement(G.a,null,o.a.createElement(K.a,null,this.state.userFollows.length>0?this.state.userFollows.map((function(t){return o.a.createElement(q.a,null,o.a.createElement(z.a,null,o.a.createElement(p.b,{to:"box/".concat(t.boxID),component:_.a},t.title)),o.a.createElement(z.a,{align:"right"},e.isUserFollowing(t.boxID)?o.a.createElement(_.a,{variant:"outlined",onClick:function(){e.handleUnfollow(t.boxID)}},o.a.createElement(Fe.a,{color:"primary"})):o.a.createElement(_.a,{variant:"outlined",color:"error",onClick:function(){e.handleFollow(t)}},o.a.createElement(Fe.a,null))))})):o.a.createElement(o.a.Fragment,null,"Not following anyone!")))))}}]),a}(n.Component),Vt=Kt=Object(k.a)(Kt),zt=a(333),Zt=a(334),Ht=a(335),Jt=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid,showRemoveAlert:!1,removeScoreID:""},n}return Object(i.a)(a,[{key:"handleViewWod",value:function(e){console.log("Go to wodID: ".concat(e))}},{key:"handleViewBox",value:function(e){console.log("Go to boxID: ".concat(e))}},{key:"showRemoveAlert",value:function(e){this.setState({showRemoveAlert:!0,removeScoreID:e})}},{key:"onRemove",value:function(){var e=this;ce(this.state.removeScoreID).then((function(t){e.hideRemoveAlert()})).catch((function(e){console.log(e)}))}},{key:"hideRemoveAlert",value:function(){this.setState({showRemoveAlert:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(G.a,{component:w.a},o.a.createElement(K.a,{"aria-label":"score table"},o.a.createElement(V.a,null,o.a.createElement(z.a,null,"Username"),o.a.createElement(z.a,null,"Score"),o.a.createElement(z.a,null,"Box"),o.a.createElement(z.a,null,"Wod"),o.a.createElement(z.a,null,"Remove")),o.a.createElement(Z.a,null,this.state.scores.map((function(t){return o.a.createElement(_t,{info:t,onViewBox:e.handleViewBox.bind(e),onViewWod:e.handleViewWod.bind(e),onRemove:e.showRemoveAlert.bind(e)})}))))):o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(H.a,{variant:"outlined",color:"primary"},o.a.createElement(J.a,null,o.a.createElement(C.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))),o.a.createElement(he,{open:this.state.showRemoveAlert,actionText:"Remove",cancelText:"Cancel",modalText:"Remove score?",onAction:this.onRemove.bind(this),onClose:this.hideRemoveAlert.bind(this)}))}}]),a}(n.Component)),qt=Jt=Object(k.a)(Jt);function _t(e){var t=e.info.score,a=e.info.username,n=e.info.wodID,r=(e.info.uid,e.info.scoreID),s=e.info.boxID;return o.a.createElement(q.a,null,o.a.createElement(z.a,null,a),o.a.createElement(z.a,null,t),o.a.createElement(z.a,null,o.a.createElement(p.b,{to:"box/".concat(s)},o.a.createElement(zt.a,null))),o.a.createElement(z.a,null,o.a.createElement(p.b,{to:"wod/".concat(s,"/").concat(n)},o.a.createElement(Zt.a,null))),o.a.createElement(z.a,null,o.a.createElement(_.a,{size:"small",color:"error",onClick:function(){return e.onRemove(r)}},o.a.createElement(Ht.a,null))))}var Qt=d.database(),Xt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userScores:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForUserScores()}},{key:"listenForUserScores",value:function(){var e=this;Qt.ref("scores").orderByChild("uid").equalTo(this.state.user.uid).on("value",(function(t){if(t&&t.exists()){var a=t.val(),n=Object.keys(a).map((function(e){return a[e]}));console.log(n),e.setState({userScores:n})}}))}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(v.a,{xs:12},o.a.createElement(v.a,{xs:12},o.a.createElement(v.a,{xs:12},o.a.createElement(C.a,null,"Scores"),o.a.createElement(qt,{uid:this.state.user.uid,scores:this.state.userScores}))))}}]),a}(n.Component),Yt=Xt=Object(k.a)(Xt),$t=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,emailAlertOpen:!1},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"sendVerificationEmail",value:function(){var e=this;this.state.user.sendEmailVerification().then((function(){e.setState({emailAlertOpen:!0})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,{item:!0,container:!0,align:"center"},o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(et.a,{in:this.state.emailAlertOpen},o.a.createElement(tt.a,{onClose:function(){e.setState({emailAlertOpen:!1})}},"Email sent!"))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(v.a,{item:!0,container:!0,xs:12},this.state.user.emailVerified?o.a.createElement(o.a.Fragment,null):o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:4},o.a.createElement(C.a,null,"Verification"),o.a.createElement(_.a,{variant:"outlined",onClick:this.sendVerificationEmail.bind(this)},o.a.createElement(C.a,{variant:"h5",component:"h3"},"Send Verification Email")))),o.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(w.a,{elevation:4},o.a.createElement(Gt,{user:this.state.user,userMD:this.state.userMD}))),o.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(w.a,{elevation:4},o.a.createElement(Vt,{user:this.state.user,userMD:this.state.userMD})))),o.a.createElement(w.a,{elevation:2,style:{margin:"8px 0px 0px 0px"}},"owner"===this.state.userMD.accountType?o.a.createElement(Ut,{user:this.state.user,userMD:this.state.userMD}):o.a.createElement(Yt,{user:this.state.user,userMD:this.state.userMD}))))}}]),a}(n.Component),ea=Object(k.a)($t),ta=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(i.a)(a,[{key:"handleLogIn",value:function(e){this.setState({user:e})}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(v.a,{item:!0,xs:12,id:"profilepage"},"? ",o.a.createElement(ea,{user:this.state.user,userMD:this.state.userMD}))}}]),a}(n.Component),aa=ta=Object(k.a)(ta),na=a(330),oa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(nt.a,{position:"static",style:{background:this.props.theme.palette.background.toolbar}},o.a.createElement(na.a,{disableGutters:!1},o.a.createElement(C.a,{gutterBottom:!0,variant:"h3"},"WodTrackrr"),o.a.createElement("section",{style:{marginLeft:"auto",marginRight:-12}},this.state.user?o.a.createElement(_.a,{variant:"outlined",color:"secondary",onClick:this.props.handleLogout},o.a.createElement(C.a,{variant:"h6",component:"h6"},"Logout")):o.a.createElement(p.b,{to:"/login",component:_.a,variant:"outlined",color:"secondary"},o.a.createElement(C.a,{variant:"h6",component:"h6"},"Login")))))}}]),a}(n.Component),ra=oa=Object(k.a)(oa),sa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=document.getElementById("email"),n=document.getElementById("password");document.getElementById("passwordConfirm");console.log(a.value,n),d.auth().signInWithEmailAndPassword(a.value,n.value).then((function(e){console.log("Firebase res"),console.log(e),t.props.onLogin(e.user)})).catch((function(e){console.log(e);e.code,e.message}))}},{key:"render",value:function(){return o.a.createElement(v.a,{container:!0,id:"login",align:"center",justify:"center"},o.a.createElement("br",null),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:"2"},o.a.createElement(C.a,{variant:"h4"},"Login"),o.a.createElement("br",null),o.a.createElement(le.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(le.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:"2"},o.a.createElement(_.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Login"),o.a.createElement(p.b,{to:"/register",className:"no-line",style:{"padding-left":"10px"}},o.a.createElement(_.a,{variant:"outlined",color:"secondary"},"Register")))))}}]),a}(n.Component),la=a(33),ia=Object(la.a)(),ca=a(151),ua=a(346),ma=a(336),da={palette:{common:{black:"#000",white:"#fff"},background:{paper:"#2e3134",toolbar:"#0d0e0e",tableHeader:"#1b1d1e",default:"rgba(48, 48, 48, 1)"},primary:{main:"#0072fff7",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#14eac3",main:"#14eac3",dark:"#14eac3",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},follow:{main:"#09e073"},unfollow:{main:"#e07609"},text:{primary:"#ffffff",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},ha=da=da,pa=Object(ca.a)(ha);pa=Object(ua.a)(pa);var fa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={btmnav:0,user:d.auth().currentUser,userMD:!1},n}return Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this;this.firebaseAuthListener=d.auth().onAuthStateChanged((function(t){var a=d.firestore();if(t){var n=a.collection("users").doc(t.uid);e.userMDListener=n.onSnapshot((function(a){a.exists?e.setState({user:t,userMD:a.data()}):e.setState({user:t,userMD:!1})}),(function(e){console.log(e)}))}else e.setState({user:null,userMD:!1})}))}},{key:"handleLogin",value:function(e){this.setState({user:e})}},{key:"handleLogout",value:function(){var e=this;d.auth().signOut().then((function(){e.setState({user:null})}),(function(e){console.error("Sign Out Error",e)}))}},{key:"componentWillUnmount",value:function(){void 0!==this.firebaseAuthListener&&this.firebaseAuthListener&&this.firebaseAuthListener(),null!==this.userMDListener&&this.userMDListener&&this.userMDListener()}},{key:"render",value:function(){var e=this;return o.a.createElement(h.Provider,null,o.a.createElement(p.a,{history:ia},o.a.createElement(ma.a,{theme:pa},o.a.createElement(v.a,{container:!0},o.a.createElement(v.a,{item:!0,xs:12,id:"page-header"},o.a.createElement(ra,{className:"header",user:this.state.user,userMD:this.state.userMD,handleLogout:this.handleLogout.bind(this)})),o.a.createElement(v.a,{item:!0,xs:12,id:"page-container",className:"page-content"},o.a.createElement(f.d,null,o.a.createElement(f.b,{exact:!0,path:"/boxSearch"},o.a.createElement(qe,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(f.b,{exact:!0,path:"/profile"},this.state.user?o.a.createElement(aa,{user:this.state.user,userMD:this.state.userMD}):o.a.createElement(f.a,{to:"/login"})),o.a.createElement(f.b,{path:"/box/:boxID",render:function(t){return o.a.createElement(Ue,{userMD:e.state.userMD,boxID:t.match.params.boxID})}}),o.a.createElement(f.b,{path:"/class/:gymClassID",render:function(t){return o.a.createElement($e,{userMD:e.state.userMD,gymClassID:t.match.params.gymClassID})}}),o.a.createElement(f.b,{path:"/wod/:boxID/:wodID",render:function(t){return o.a.createElement(fe,{userMD:e.state.userMD,boxID:t.match.params.boxID,wodID:t.match.params.wodID,isReadOnly:!0})}}),o.a.createElement(f.b,{exact:!0,path:"/register",render:function(t){return e.state.user?o.a.createElement(f.a,{to:"/profile"}):o.a.createElement(Qe,null)}}),o.a.createElement(f.b,{exact:!0,path:"/login"},this.state.user?o.a.createElement(f.a,{to:"/boxSearch"}):o.a.createElement(sa,{onLogin:this.handleLogin.bind(this)}))),o.a.createElement("div",{style:{margin:"10vh"}})),o.a.createElement(v.a,{item:!0,xs:12,className:"footer"},o.a.createElement(b.a,{value:this.state.btmnav,onChange:function(t,a){e.setState({btmnav:a})},style:{background:pa.palette.background.toolbar},showLabels:!0},o.a.createElement(E.a,{label:"Search",component:p.b,to:"/boxSearch",icon:o.a.createElement(g.a,null)}),o.a.createElement(E.a,{label:"Profile",component:p.b,to:"/profile",icon:o.a.createElement(g.a,null)})))))))}}]),a}(o.a.Component);fa.contextType=h,s.a.render(o.a.createElement(fa,null),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.83f492e1.chunk.js.map