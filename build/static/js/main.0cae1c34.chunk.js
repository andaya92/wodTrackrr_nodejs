(this.webpackJsonpreactapp=this.webpackJsonpreactapp||[]).push([[0],{150:function(e,t,a){e.exports=a(239)},239:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(16),s=a.n(r),l=a(6),i=a(7),c=a(9),u=a(8),m=a(117),d=(a(14),m),h=o.a.createContext(m.initializeApp({apiKey:"AIzaSyCGE8_j8cfIBmIzcvP6CVgG2yC6EE1Ep1U",authDomain:"wodtrackrr.firebaseapp.com",databaseURL:"https://wodtrackrr.firebaseio.com",projectId:"wodtrackrr",storageBucket:"wodtrackrr.appspot.com",messagingSenderId:"743601990099",appId:"1:743601990099:web:5937e9151eaad13e93a726",measurementId:"G-39CF0BRPMH"})),p=(a(116),a(19),a(43),a(13)),v=a(20),f=a(281),b=a(306),E=a(307),y=a(120),g=a.n(y),x=(a(27),a(10)),w=a(144),D=a(313),k=a(240),O=a(54),B=a.n(O),S=a(121),I=a(58),j=a(52),C=a(89),M=a.n(C);function R(e){console.log("Split",e);var t=e.split(":"),a=Object(I.a)(t,2),n=a[0],o=a[1];return 60*parseInt(n)+parseInt(o)}function T(e){var t=Math.floor(e/60),a=Math.floor(e-60*t);return a<10&&(a="0".concat(a)),"".concat(t,":").concat(a)}d.database();var P=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:e.stats},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"createChart",value:function(){var e=this;console.log("LineChart____________"),console.log(this.state),this.ctx=document.getElementById("lineChart");var t=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);t.addColorStop(0,"#01d3fe"),t.addColorStop(1,"#0890fd"),this.lineChart&&this.lineChart.destroy(),this.lineChart=new M.a(this.ctx,{type:"line",data:{label:"Scores",datasets:[{label:"Score",barPercentage:.5,barThickness:6,maxBarThickness:8,minBarLength:2,backgroundColor:t,data:this.state.data}]},options:{scales:{yAxes:[{ticks:{callback:function(t,a,n){return"time"===e.state.scoreType?T(t):"reps"===e.state.scoreType?t:void 0}}}]},tooltips:{callbacks:{title:function(e,t){},label:function(t,a){var n=a.datasets[t.datasetIndex].label||"";return n&&(n+=": "),"time"===e.state.scoreType?n+=T(t.yLabel):"reps"===e.state.scoreType&&(n+=t.yLabel),n}}},maintainAspectRatio:!1},plugins:[{beforeInit:function(e){e.data.datasets[0].data}}]})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(Object(x.a)({},e),(function(){t.createChart()}))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"objListToArray",value:function(e){return Array.from(Object.entries(e),(function(e){return new Map(Object.entries(e[1]))}))}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement("div",{style:{height:"25vh","max-width":"50vw"}},o.a.createElement("canvas",{id:"lineChart"})))}}]),a}(n.Component),W=P=Object(D.a)(P),L=a(140),A=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:new Map},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState(Object(x.a)({},e),(function(){t.state.values.length>0&&t.createChart(t.binData(t.state.values))}))}},{key:"createChart",value:function(e){var t=Object(I.a)(e,2),a=t[0],n=t[1];this.ctx=document.getElementById("barChart");var o=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);o.addColorStop(0,"#01d3fe"),o.addColorStop(1,"#0890fd"),this.barChart&&this.barChart.destroy(),this.barChart=new M.a(this.ctx,{type:"bar",data:{labels:a,datasets:[{label:"Scores (Standard Deviation)",minBarLength:1,backgroundColor:o,data:n}]},options:{maintainAspectRatio:!1}})}},{key:"format",value:function(e){return"time"===this.state.scoreType?e<=0?0:T(e):"reps"===this.state.scoreType?parseFloat(e):void 0}},{key:"createLabels",value:function(e,t){for(var a=[],n=0;n<3;n++){var o="".concat(this.format(e-t*(n+1))," - ").concat(this.format(e-t*n)),r="".concat(this.format(e+t*n)," - ").concat(this.format(e+t*(n+1)));a.unshift(o),a.push(r)}return a}},{key:"binData",value:function(e){console.log(e);var t,a=Object(j.standardDeviation)(e),n=Object(j.mean)(e),o=this.createLabels(n,a),r=[0,0,0,0,0,0],s=Object(L.a)(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,i=l-n,c=Math.floor(i/a);console.log("SD: ".concat(a,", x: ").concat(l,", mean: ").concat(n," Diff: ").concat(i,", sdAway: ").concat(c)),Math.abs(c)<=1?i>0?r[3]++:r[2]++:Math.abs(c)<=2?i>0?r[4]++:r[1]++:i>0?r[5]++:r[0]++}}catch(u){s.e(u)}finally{s.f()}return[o,r]}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement("div",{style:{height:"25vh","max-width":"50vw"}},o.a.createElement("canvas",{id:"barChart"})))}}]),a}(n.Component)),U=A=Object(D.a)(A),F=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,graphData:[],rawScores:[],scoreType:"",stats:{}},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){if(e.scores&&e.scores.length>0){var t=this.transformData(e.scores),a=Object(I.a)(t,4),n=a[0],o=a[1],r=a[2],s=a[3],l=o.length>1;this.setState(Object(x.a)(Object(x.a)({},e),{},{graphData:n,rawScores:o,scoreType:r,stats:s,showCharts:l}))}else this.setState(Object(x.a)({},e))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"transformData",value:function(e){for(var t=[],a="",n=e.map((function(e){return console.log(e),a=e.scoreType,"time"===e.scoreType?R(e.score):parseFloat(e.score)})),o=0;o<n.length;o++)t.push({x:o,y:n[o],c:0});return[t,n,a,this.getDescStats(n)]}},{key:"getDescStats",value:function(e){return{min:Math.min.apply(Math,Object(S.a)(e)),max:Math.max.apply(Math,Object(S.a)(e)),mean:Object(j.mean)(e),median:Object(j.median)(e),sd:Object(j.standardDeviation)(e)}}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(f.a,{item:!0,container:!0,align:"center",xs:12},o.a.createElement(f.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(k.a,null,"Low: ","time"===this.state.scoreType?T(this.state.stats.min):this.state.stats.min))),o.a.createElement(f.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(k.a,null,"High: ","time"===this.state.scoreType?T(this.state.stats.max):this.state.stats.max))),o.a.createElement(f.a,{item:!0,xs:4},o.a.createElement(w.a,{elevation:6},o.a.createElement(k.a,null,"Avg: ","time"===this.state.scoreType?T(this.state.stats.mean):this.state.stats.mean)))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(W,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(U,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})))}}]),a}(n.Component)),N=F=Object(D.a)(F),V=a(285),z=a(286),K=a(287),G=a(288),_=a(289),Z=a(290),H=a(291),J=a(292),q=a(293),Q=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(V.a,{component:w.a},o.a.createElement(z.a,{"aria-label":"score table"},o.a.createElement(K.a,null,o.a.createElement(G.a,null,"Username"),o.a.createElement(G.a,null,"Score"),o.a.createElement(G.a,null)),o.a.createElement(_.a,null,this.state.scores.map((function(t){var a=e.state.uid==t.uid;return o.a.createElement(Y,{info:t,onRemove:e.props.onRemove,isUserScore:a})}))))):o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(Z.a,{variant:"outlined",color:"primary"},o.a.createElement(H.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))))}}]),a}(n.Component)),X=Q=Object(D.a)(Q);function Y(e){var t=e.info.score,a=e.info.username,n=(e.info.wodID,e.info.uid,e.info.scoreID);e.isUserScore;return o.a.createElement(J.a,{selected:e.isUserScore},o.a.createElement(G.a,null,a),o.a.createElement(G.a,null,t),e.isUserScore?o.a.createElement(G.a,null,o.a.createElement(q.a,{size:"small",color:"error",onClick:function(){return e.onRemove(n)}},"Remove")):o.a.createElement(G.a,null))}var $=a(24),ee=a.n($),te=a(315),ae=a(295),ne=a(296),oe=a(312),re=(d.storage(),d.database());var se=d.firestore();d.database();var le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,wodMD:e.wodMD},console.log(e),n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"objListToArray",value:function(e){return Array.from(Object.entries(e),(function(e){return new Map(Object.entries(e[1]))}))}},{key:"isNumInSane",value:function(e){return-1===e.search(/\D/)}},{key:"handleAddScore",value:function(){if(this.state.userMD){var e="";if("time"===this.state.wodMD.scoreType){var t=document.getElementById("scoreViewUserScoreMins").value,a=document.getElementById("scoreViewUserScoreSecs").value;if(!this.isNumInSane(t)||!this.isNumInSane(a))return void alert("Time must only contain numbers, entered: ".concat(t,":").concat(a));if(parseInt(a)>59)return void alert("Seconds must be 59 or below, entered: ".concat(a));if(parseInt(a)<10&&1===a.length&&(a="0".concat(a)),isNaN(parseInt(a))||isNaN(parseInt(t)))return void alert("Missing field, entered: ".concat(t,":").concat(a));if(t.length>2)return void alert("Minutes must be 99 or below, entered: ".concat(t));0===t.length&&(t="0"),0===a.length&&(a="0"),e="".concat(t,":").concat(a)}else{if((e=document.getElementById("scoreViewUserScore").value).length>3)return void alert("Score must be 3 digits or less, entered: ".concat(e));if(!this.isNumInSane(e))return void alert("Score must be digits only, entered: ".concat(e))}var n=this.state.userMD.username,o=this.state.userMD.uid,r=this.state.wodMD.wodID,s=this.state.wodMD.boxID;(function(e,t,a,n,o,r,s){return new Promise((function(l,i){var c={uid:a,wodID:o,boxID:r,username:t,title:e,score:n,scoreType:s,date:Date.now()};se.collection("scores").where("uid","==",a).where("wodID","==",o).get().then((function(e){var t="";if(console.log(e),e.empty){var a=se.collection("scores").doc();c.scoreID=a.id,a.set(c).then((function(){l("Added new score.")})).catch((function(e){i(e)}))}else e.forEach((function(e){t=e.data().scoreID})),c.scoreID=t,se.collection("scores").doc(t).set(c).then((function(){l("Updated score.")})).catch((function(e){i(e)}))}),(function(e){i(e)}))}))})(this.state.wodMD.title,n,o,e,r,s,this.state.wodMD.scoreType).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(te.a,null,o.a.createElement(ae.a,{style:{background:this.props.theme.palette.primary.main},expandIcon:o.a.createElement(ee.a,null),"aria-label":"Expand","aria-controls":"additional-actions2-content",id:"additional-actions2-header"},o.a.createElement(k.a,null,"Add Score")),o.a.createElement(ne.a,null,o.a.createElement(f.a,{container:!0},o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(k.a,null,this.state.wodMD.scoreType.replace(this.state.wodMD.scoreType[0],this.state.wodMD.scoreType[0].toUpperCase()))),"reps"===this.state.scoreType?o.a.createElement(f.a,{item:!0,xs:10},o.a.createElement(oe.a,{id:"scoreViewUserScore",type:"number",style:{margin:8},pattern:"[0-9]{4}",inputProps:{title:"Numbers only, max length 4",placeholder:"Score"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})):o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{item:!0,xs:5},o.a.createElement(oe.a,{id:"scoreViewUserScoreMins",type:"number",style:{margin:8},pattern:"[0-9]{3}",inputProps:{title:"Numbers only, max length 3",placeholder:"Minutes"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(f.a,{item:!0,xs:5},o.a.createElement(oe.a,{id:"scoreViewUserScoreSecs",type:"number",style:{margin:8},pattern:"[0-9]{2}",inputProps:{title:"Numbers only, max length 2",placeholder:"Seconds"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),o.a.createElement(f.a,{item:!0,xs:2},o.a.createElement(q.a,{variant:"outline",color:"primary",onClick:this.handleAddScore.bind(this)},"Add"))))))}}]),a}(n.Component),ie=le=Object(D.a)(le),ce=a(310),ue=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={open:e.open},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(ce.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(f.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(k.a,{style:{position:""}},this.props.modalText),o.a.createElement(q.a,{color:"primary",variant:"outlined",onClick:function(){e.props.onAction()}},this.props.actionText),o.a.createElement(q.a,{color:"error",variant:"outlined",onClick:function(){e.props.onClose()}},this.props.cancelText)))))}}]),a}(n.Component),me=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,boxID:e.boxID,wodID:e.wodID,wodMD:{},scores:[],userScore:{},curRemoveScoreID:"",showRemoveAlert:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=d.firestore();this.wodListener=t.collection("wods").doc(this.state.wodID).onSnapshot((function(t){e.setState({wodMD:t.data()})}),(function(e){console.log(e)})),this.scoreListener=t.collection("scores").where("wodID","==",this.state.wodID).onSnapshot((function(t){if(t.empty)e.setState({scores:[],userScore:{}});else{var a=[],n={},o="";t.forEach((function(t){var r=t.data();a.push(r),o=r.scoreType,r.uid===e.state.uid&&(n=r)}));var r=o&&"time"===o?1:0;a.sort((function(e,t){return r?parseFloat(e.score)<parseFloat(t.score)?-1:1:parseFloat(e.score)>parseFloat(t.score)?1:-1})),e.setState({scores:a,userScore:n})}}),(function(e){}))}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"componentWillUnmount",value:function(){void 0!==this.scoreListener&&this.scoreListener(),void 0!==this.wodListener&&this.wodListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveScore",value:function(e){console.log("Remove score with ID: ".concat(e)),this.setState({curRemoveScoreID:e,showRemoveAlert:!0})}},{key:"removeScore",value:function(){var e=this,t=this.state.curRemoveScoreID;""===t||t.length<=0||(this.setState({showRemoveAlert:!1}),function(e){return new Promise((function(t,a){se.collection("scores").doc(e).delete().then((function(){t("Successfully removed score: ".concat(e))})).catch((function(t){a("Failed to remove score: ".concat(e))}))}))}(t).then((function(t){console.log(t),e.setState({showRemoveAlert:!1})})).catch((function(e){console.log(e)})))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,Object.keys(this.state.wodMD).length>0?o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(f.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(k.a,null,this.state.wodMD.title),o.a.createElement(k.a,null,"Type: ",this.state.wodMD.scoreType))),o.a.createElement(f.a,{item:!0,container:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(B.a,null,this.state.wodMD.wodText))),o.a.createElement(ie,{userMD:this.state.userMD,wodMD:this.state.wodMD}),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(N,{scores:this.state.scores}))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(X,{scores:this.state.scores,uid:this.state.userMD.uid,onRemove:this.handleRemoveScore.bind(this)}))),o.a.createElement(ue,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.removeScore.bind(this),modalText:"Remove score?",actionText:"Remove",cancelText:"Cancel"})):o.a.createElement(o.a.Fragment,null,"Wod not found!"))}}]),a}(n.Component)),de=me=Object(D.a)(me),he=a(42),pe=a(308);function ve(e){var t=["wods","scores"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,o,r){var s=d.firestore(),l=s.batch();s.collection(t).where(a,"==",n).get().then((function(s){var i=0;0==s.size&&o(1),s.forEach((function(e){console.log("delete"),console.log(e.data()),l.delete(e.ref),i++})),l.commit().then((function(){i>=500&&e(t,a,n,o,r)})).catch((function(e){return r(0)}))})),o(1)}(t,"wodID",e,a,n)}))}));return Promise.all(t)}d.database();var fe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={wodInfo:e.wodInfo,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,open:e.open,onClose:e.onClose,title:e.title,wodText:e.wodText},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"editWOD",value:function(){var e=this,t=document.getElementById("editOwnerBoxAddWodBoxID").value,a=document.getElementById("editOwnerBoxAddWodTitle").value,n=document.getElementById("editOwnerBoxAddWodScoreType").value,o=document.getElementById("editOwnerBoxAddWodWodText").value,r=this.state.wodInfo.wodID;if(!t||!a||!n||!o||!r)return console.log("Error with input editWod"),void console.log(t,a,n,o);(function(e,t,a,n,o){var r=d.firestore();return new Promise((function(s,l){r.collection("wods").doc(t).update({boxID:e,title:a,wodText:n,scoreType:o}).then((function(){s("Finished updating.")})).catch((function(e){l(e)}))}))})(t,r,a,o,n).then((function(t){console.log(t),e.props.onClose()})).catch((function(e){console.log(e)}))}},{key:"handleValChange",value:function(e,t){var a=e.target.name;console.log(a,t),this.setState(Object(he.a)({},a,e.target.value))}},{key:"render",value:function(){var e=this.state.wodInfo.scoreType,t=this.state.wodInfo.boxID;return o.a.createElement(ce.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"edit-wod-modal","aria-describedby":"edit-wod"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(f.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(k.a,{style:{position:""}},"Edit Wod(",this.state.wodInfo.wodID,")"),o.a.createElement(f.a,{item:!0,container:!0,xs:12},o.a.createElement(f.a,{item:!0,xs:6},o.a.createElement(pe.a,{native:!0,inputProps:{name:"Box",id:"editOwnerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,a){var n=e.boxID;return o.a.createElement("option",{key:a,value:n,selected:t===n},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!"))),o.a.createElement(f.a,{item:!0,xs:6},o.a.createElement(pe.a,{native:!0,inputProps:{name:"Score Type",id:"editOwnerBoxAddWodScoreType"}},["time","reps"].map((function(t){return o.a.createElement("option",{value:t,selected:e===t},t)})))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"editOwnerBoxAddWodTitle",type:"text",name:"title",style:{margin:8},value:this.state.title,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"editOwnerBoxAddWodWodText",type:"text",name:"wodText",style:{margin:8},value:this.state.wodText,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Workout here"},margin:"normal",color:"primary",multiline:!0,rows:5,InputLabelProps:{shrink:!0}})),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.editWOD.bind(this)},"Update")),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.props.onClose},"Cancel")))))))}}]),a}(n.Component),be=a(299),Ee=a(317),ye=a(309),ge=a(55),xe=a.n(ge),we=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={headers:e.headers,rows:e.rows,filteredRows:e.filteredRows,orderTableBy:"date",orderTable:"asc",pageNum:0,rowsPerPage:5,pageStart:0,pageEnd:5},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.rows.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredRows:a})}},{key:"descendingComparator",value:function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}},{key:"getComparator",value:function(e,t){var a=this;return"desc"===e?function(e,n){return a.descendingComparator(e,n,t)}:function(e,n){return-a.descendingComparator(e,n,t)}}},{key:"stableSort",value:function(e){var t=this.state.filteredRows.map((function(e,t){return[e,t]}));return t.sort((function(t,a){var n=e(t[0],a[0]);return 0!==n?n:t[1]-a[1]})),t.map((function(e){return e[0]}))}},{key:"createSortHandler",value:function(e){var t=this.state.orderTableBy===e&&"asc"===this.state.orderTable;this.setState({orderTableBy:e,orderTable:t?"desc":"asc"})}},{key:"handleChangePage",value:function(e,t){var a=t*this.state.rowsPerPage,n=t*this.state.rowsPerPage+this.state.rowsPerPage;this.setState({pageNum:t,pageStart:a,pageEnd:n})}},{key:"handleChangeRowsPerPage",value:function(e){var t=parseInt(e.target.value);console.log(t),this.setState({pageNum:0,rowsPerPage:t,pageStart:0,pageEnd:t})}},{key:"render",value:function(){var e=this;return o.a.createElement(f.a,{item:!0,xs:12,align:"center"},o.a.createElement(w.a,{elevation:2},o.a.createElement(w.a,{elevation:2,component:"form"},o.a.createElement(oe.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search",InputProps:{startAdornment:o.a.createElement(be.a,{position:"start"},o.a.createElement(xe.a,{color:"primary"}))}})),o.a.createElement(f.a,{container:!0,item:!0,xs:12},o.a.createElement(V.a,null,o.a.createElement(z.a,null,o.a.createElement(K.a,null,o.a.createElement(J.a,null,this.state.headers.map((function(t){return o.a.createElement(G.a,null,t.sortable?o.a.createElement(Ee.a,{active:t.id===e.state.orderTableBy,direction:t.id===e.state.orderTableBy?e.state.orderTable:"asc",onClick:function(){e.createSortHandler(t.id)}},t.label):o.a.createElement(o.a.Fragment,null,t.label))})))),o.a.createElement(_.a,null,this.state.filteredRows.length>0?this.stableSort(this.getComparator(this.state.orderTable,this.state.orderTableBy)).slice(this.state.pageStart,this.state.pageEnd).map((function(t){return o.a.createElement(De,{handleView:e.props.handleView,handleRemove:e.props.handleRemove,handleEdit:e.props.handleEdit,info:t,showOwnerBtns:e.props.showOwnerBtns})})):o.a.createElement("span",null,"No data!")))),o.a.createElement(ye.a,{rowsPerPageOptions:[5,10,25],component:"div",count:this.state.filteredRows.length,rowsPerPage:this.state.rowsPerPage,page:this.state.pageNum,onChangePage:this.handleChangePage.bind(this),onChangeRowsPerPage:this.handleChangeRowsPerPage.bind(this)}))))}}]),a}(n.Component);function De(e){var t=e.info.title,a=e.info.scoreType,n=e.info.wodText,r=e.info.wodID,s=e.info.boxID,l=e.info.date;return o.a.createElement(J.a,null,o.a.createElement(G.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},new Date(l).toLocaleDateString("en-US"))),o.a.createElement(G.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},t)),o.a.createElement(G.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},a)),o.a.createElement(G.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},o.a.createElement(B.a,null,n))),o.a.createElement(G.a,null,o.a.createElement(p.b,{component:q.a,to:"/wod/".concat(s,"/").concat(r)},"View Scores")),o.a.createElement(o.a.Fragment,null,e.showOwnerBtns?o.a.createElement(G.a,null,o.a.createElement(q.a,{size:"small",color:"secondary",onClick:function(){return e.handleEdit(e.info)}},"Edit")):o.a.createElement(o.a.Fragment,null)),o.a.createElement(o.a.Fragment,null,e.showOwnerBtns?o.a.createElement(G.a,null,o.a.createElement(q.a,{size:"small",color:"error",onClick:function(){return e.handleRemove(e.info)}},"Remove")):o.a.createElement(o.a.Fragment,null)))}var ke=we=Object(D.a)(we),Oe=d.firestore(),Be=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),n=t.call(this,e),console.log(e),n.state={userMD:e.userMD,boxID:e.boxID,boxMD:{},userBoxes:[],hasBoxes:!1,wods:[],currentWodID:"",currentWodMD:{},showRemoveAlert:!1,showEditModal:!1,editWodInfo:{},curRemoveWodBoxID:"",curRemoveWodID:"",curRemoveWodTitle:""},n}return Object(i.a)(a,[{key:"getUserBoxListener",value:function(){var e=this;this.state.userMD.uid&&(this.userBoxesListener=Oe.collection("boxes").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a=[];console.log(t),t.empty||t.forEach((function(e){console.log(e.data()),a.push(e.data())})),e.setState({userBoxes:a,hasBoxes:!!a.length})})))}},{key:"getBoxListener",value:function(){var e=this;this.boxListener=Oe.collection("boxes").doc(this.state.boxID).onSnapshot((function(t){t.empty?e.setState({boxMD:{}}):e.setState({boxMD:t.data()})}),(function(e){console.log(e)}))}},{key:"getWodListener",value:function(){var e=this;this.wodListener=Oe.collection("wods").where("boxID","==",this.state.boxID).onSnapshot((function(t){if(t.empty)e.setState({wods:[]});else{var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({wods:a})}}),(function(e){console.log(e)}))}},{key:"checkListeners",value:function(){void 0===this.userBoxesListener&&this.getUserBoxListener(),void 0===this.boxListener&&this.getBoxListener(),void 0===this.wodListener&&this.getWodListener()}},{key:"componentDidMount",value:function(){this.checkListeners()}},{key:"componentWillReceiveProps",value:function(e){console.log(e),this.setState(Object(x.a)({},e)),this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.wodListener&&this.wodListener(),this.boxListener&&this.boxListener(),this.userBoxesListener&&this.userBoxesListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveWod",value:function(e){this.setState({showRemoveAlert:!0,curRemoveWodBoxID:e.boxID,curRemoveWodID:e.wodID,curRemoveWodTitle:e.title})}},{key:"deleteWod",value:function(){var e=this;ve(this.state.curRemoveWodID).then((function(t){console.log(t),e.setState({showRemoveAlert:!1})}))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.wods.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredWods:a})}},{key:"handleEdit",value:function(e){console.log("Populate with info, show in modal with form"),console.log(e),this.userBoxesListener||this.getUserBoxListener(),this.setState({editWodInfo:e,showEditModal:!0})}},{key:"handleEditModalClose",value:function(){this.setState({showEditModal:!1})}},{key:"render",value:function(){var e=this.state.boxMD.uid===this.state.userMD.uid&&!this.props.isReadOnly;return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(f.a,{item:!0,align:"center",xs:12},o.a.createElement(k.a,{align:"center",variant:"h3"},this.state.boxMD.title)),o.a.createElement(o.a.Fragment,null,this.state.wods.length>0?o.a.createElement(ke,{rows:this.state.wods,filteredRows:this.state.wods,headers:e?[{id:"date",sortable:!0,label:"Date"},{id:"title",sortable:!0,label:"Title"},{id:"scoreType",sortable:!0,label:"Scoring"},{id:"wodText",sortable:!1,label:"Wod"},{id:"view",sortable:!1,label:""},{id:"edit",sortable:!1,label:""},{id:"remove",sortable:!1,label:""}]:[{id:"date",sortable:!0,label:"Date"},{id:"title",sortable:!0,label:"Title"},{id:"scoreType",sortable:!0,label:"Scoring"},{id:"wodText",sortable:!1,label:"Wod"},{id:"view",sortable:!1,label:""}],handleRemove:this.handleRemoveWod.bind(this),handleEdit:this.handleEdit.bind(this),showOwnerBtns:e}):o.a.createElement(f.a,{xs:12},o.a.createElement(w.a,{elevation:2},o.a.createElement(k.a,null,"No wods"))))),o.a.createElement(ue,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteWod.bind(this),modalText:"Remove ".concat(this.state.curRemoveWodTitle," (").concat(this.state.curRemoveWodID,")?"),actionText:"Delete",cancelText:"Cancel"}),o.a.createElement(fe,{open:this.state.showEditModal,onClose:this.handleEditModalClose.bind(this),userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,wodInfo:this.state.editWodInfo,title:this.state.editWodInfo.title,wodText:this.state.editWodInfo.wodText}))}}]),a}(n.Component),Se=Be=Object(D.a)(Be);var Ie=d.firestore(),je=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,isOwner:e.isOwner,allBoxes:e.allBoxes,filteredBoxes:e.allBoxes,userFollowing:{}},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForFollowing(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),console.log(e),this.listenForFollowing(e)}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"listenForFollowing",value:function(e){var t=this;e.user&&Ie.collection("following").where("uid","==",e.user.uid).onSnapshot((function(e){var a={};console.log("Getting follows"),console.log(e),e.empty||e.forEach((function(e){var t=e.data();console.log(t),a[t.boxID]=t.followID})),t.setState({userFollowing:a})}),(function(e){return console.log(e)}))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allBoxes.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredBoxes:a})}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"handleFollow",value:function(e){(function(e,t,a,n){var o=d.firestore();return new Promise((function(r,s){o.collection("following").where("uid","==",e).get().then((function(l){var i=!1;if(l.empty||l.forEach((function(e){e.data().boxID===a&&(i=!0)})),!i){var c=o.collection("following").doc(),u={followID:c.id,uid:e,username:t,boxID:a,title:n,date:Date.now()};c.set(u).then((function(){r("Followed.")})).catch((function(e){s(e)}))}}))}))})(this.state.user.uid,this.state.userMD.username,e.boxID,e.title).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){(function(e){var t=d.firestore();return new Promise((function(a,n){t.collection("following").doc(e).delete().then((function(){a("Finished delete.")})).catch((function(e){n(e)}))}))})(this.state.userFollowing[e]).then((function(e){e&&console.log("Succefully unfollowed.")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2,component:"form"},o.a.createElement(oe.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Boxes",InputProps:{startAdornment:o.a.createElement(be.a,{position:"start"},o.a.createElement(xe.a,{color:"primary"}))}})),o.a.createElement(f.a,{item:!0,xs:12},this.state.filteredBoxes.map((function(t,a){return console.log(e.isUserFollowing(t.boxID)),o.a.createElement(Ce,{key:a,info:t,color:e.props.theme.palette.primary.mainGrad,handleBoxView:e.props.handleBoxView,handleRemoveBox:e.props.handleRemoveBox,isOwner:e.props.isOwner,isUserFollowing:e.isUserFollowing(t.boxID),handleFollow:e.handleFollow.bind(e),handleUnfollow:e.handleUnfollow.bind(e)})}))))}}]),a}(n.Component);function Ce(e){var t=e.info.title,a=e.info.boxID,n=e.isUserFollowing;return o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,null,o.a.createElement(f.a,{container:!0,itemxs:12},o.a.createElement(f.a,{item:!0,xs:6},o.a.createElement(k.a,{align:"left",style:{padding:"2.5vw"},variant:"body1"},t)),o.a.createElement(f.a,{container:!0,item:!0,xs:2,align:"center",alignItems:"center"},o.a.createElement(p.b,{to:"box/".concat(a),component:q.a},"View")),o.a.createElement(f.a,{container:!0,item:!0,xs:2,align:"center",alignItems:"center"},n?o.a.createElement(q.a,{variant:"outlined",color:"error",onClick:function(){e.handleUnfollow(a)}},"Unfollow"):o.a.createElement(q.a,{variant:"outlined",color:"error",onClick:function(){e.handleFollow(e.info)}},"Follow")),o.a.createElement(f.a,{container:!0,item:!0,xs:2,align:"center",alignItems:"center"},e.isOwner?o.a.createElement(q.a,{variant:"outlined",color:"error",onClick:function(){e.handleRemoveBox(a,t)}},"Remove"):o.a.createElement(o.a.Fragment,null)))))}var Me=je=Object(D.a)(je),Re=d.firestore(),Te=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,allBoxes:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.allBoxesListener=Re.collection("boxes").onSnapshot((function(t){if(!t.empty){var a=[];t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.title.toLowerCase()>t.title.toLowerCase()?-1:1})),e.setState({allBoxes:a})}}))}},{key:"componentWillUnmount",value:function(){void 0!==this.allBoxesListener&&this.allBoxesListener()}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12},this.state.allBoxes.length>0?o.a.createElement(Me,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.allBoxes,isOwner:!1,isReadOnly:!1,handleRemoveBox:this.props.handleRemoveBox}):o.a.createElement(f.a,{xs:12},o.a.createElement(w.a,{elevation:2},"No boxes!")))}}]),a}(n.Component),Pe=Te=Object(D.a)(Te),We=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={redirect:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=document.getElementById("email"),a=document.getElementById("password"),n=document.getElementById("passwordConfirm");console.log(t.value,a.value),a.value===n.value?d.auth().createUserWithEmailAndPassword(t.value,a.value).then((function(e){console.log(e);var t=d.firestore(),a={username:"",admin:!1,uid:e.user.uid,accountType:"athlete"};t.collection("users").doc(e.user.uid).set(a)})).catch((function(e){console.log(e)})):alert("Passwords do not match")}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.state.redirect?o.a.createElement(v.a,{to:"/"}):o.a.createElement(f.a,{container:!0,xs:12,id:"login",align:"center",justify:"center"},o.a.createElement(w.a,{elevation:2},o.a.createElement("br",null),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement("h1",null,"Register")),o.a.createElement("br",null),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"passwordConfirm",type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})," ",o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Submit")))))}}]),a}(n.Component),Le=We=Object(D.a)(We),Ae=a(294),Ue=a(311),Fe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=document.getElementById("email"),n=document.getElementById("password");document.getElementById("passwordConfirm");console.log(a.value,n),d.auth().signInWithEmailAndPassword(a.value,n.value).then((function(e){console.log("Firebase res"),console.log(e),t.props.onLogin(e.user)})).catch((function(e){console.log(e);e.code,e.message}))}},{key:"render",value:function(){return o.a.createElement(f.a,{container:!0,id:"login",align:"center",justify:"center"},o.a.createElement("br",null),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:"2"},o.a.createElement(k.a,{variant:"h4"},"Login"),o.a.createElement("br",null),o.a.createElement(oe.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(oe.a,{id:"password",type:"password",style:{margin:8},placeholder:"Passowrd",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:"2"},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Login"),o.a.createElement(p.b,{to:"/register",className:"no-line",style:{"padding-left":"10px"}},o.a.createElement(q.a,{variant:"outlined",color:"secondary"},"Register")))))}}]),a}(n.Component),Ne=d.firestore();function Ve(e){var t=["wods","scores","boxes"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,o,r){var s=Ne.batch();Ne.collection(t).where(a,"==",n).get().then((function(l){var i=0;l.size,l.forEach((function(e){s.delete(e.ref),i++})),s.commit().then((function(){i>=500&&e(t,a,n,o,r)})).catch((function(e){return r(0)}))})),o(1)}(t,"boxID",e,a,n)}))}));return Promise.all(t)}d.database();var ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,currentBoxID:"",showRemoveAlert:!1,curRemoveBoxID:"",curRemoveBoxTitle:""},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"handleRemoveBox",value:function(e,t){this.setState({showRemoveAlert:!0,curRemoveBoxID:e,curRemoveBoxTitle:t})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"deleteBox",value:function(){var e=this;Ve(this.state.curRemoveBoxID).then((function(t){t.reduce((function(e,t){return e+t}),0);e.handleModalClose()})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(te.a,{id:"BoxListAccordion"},o.a.createElement(ae.a,{style:{background:this.props.theme.palette.primary.main},expandIcon:o.a.createElement(ee.a,null),"aria-label":"Expand","aria-controls":"additional-actions2-content",id:"additional-actions2-header"},o.a.createElement(k.a,null,"Boxes and Wods")),o.a.createElement(ne.a,null,o.a.createElement(f.a,{container:!0,item:12},this.state.userBoxes.length>0?o.a.createElement(Me,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.userBoxes,handleRemoveBox:this.handleRemoveBox.bind(this),isOwner:!0}):o.a.createElement(f.a,{item:!0,zeroMinWidth:!0,xs:6},o.a.createElement(w.a,{elevation:4,style:{padding:"1vw"}},o.a.createElement(k.a,{noWrap:!0,align:"left"},"No boxes Found!"))))),o.a.createElement(ce.a,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(f.a,{item:!0,align:"center",xs:12},o.a.createElement(w.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(k.a,{style:{position:""}},"Remove ",this.state.curRemoveBoxTitle," (",this.state.curRemoveBoxID,")"),o.a.createElement(q.a,{color:"primary",variant:"outlined",onClick:function(){e.deleteBox()}},"Delete"))))))}}]),a}(n.Component),Ke=ze=Object(D.a)(ze),Ge=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userBoxes:e.userBoxes,hasBoxes:e.hasBoxes},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"createWOD",value:function(){var e=document.getElementById("ownerBoxAddWodBoxID").value,t=document.getElementById("ownerBoxAddWodTitle").value,a=document.getElementById("ownerBoxAddWodScoreType").value,n=document.getElementById("ownerBoxAddWodWodText").value;if(!e||!t||!a||!n)return console.log("Error with input createWod"),void console.log(e,t,a,n);(function(e,t,a,n){var o=d.firestore().collection("wods").doc(),r={wodID:o.id,boxID:e,title:t,scoreType:n,wodText:a,date:Date.now()};return o.set(r)})(e,t,n,a).then((function(){console.log("Successfully added wod.")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,container:!0,xs:12},o.a.createElement(f.a,{item:!0,xs:6},o.a.createElement(pe.a,{native:!0,inputProps:{name:"Box",id:"ownerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return o.a.createElement("option",{key:t,value:e.boxID},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!"))),o.a.createElement(f.a,{item:!0,xs:6},o.a.createElement(pe.a,{native:!0,inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},o.a.createElement("option",{value:"time"},"Time"),o.a.createElement("option",{value:"reps"},"Reps"))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"ownerBoxAddWodTitle",type:"text",style:{margin:8},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"ownerBoxAddWodWodText",type:"text",style:{margin:8},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Workout here"},margin:"normal",color:"primary",multiline:!0,rows:10,InputLabelProps:{shrink:!0}})),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.createWOD.bind(this)},"Enter WOD")))}}]),a}(n.Component)),_e=(d.database(),d.firestore()),Ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:[],hasBoxes:!1,addBoxProgress:!0,scoreTypeSelectVal:"",boxIDSelectVal:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForBoxes()}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e)),"owner"===e.userMD.accountType&&this.listenForBoxes()}},{key:"componentWillUnmount",value:function(){void 0!==this.boxListener&&this.boxListener()}},{key:"listenForBoxes",value:function(){var e=this;_e.collection("boxes").where("uid","==",this.state.user.uid).onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({hasBoxes:!0,userBoxes:a})}),(function(t){e.setState({hasBoxes:!1,userBoxes:[]})}))}},{key:"onKeyUp",value:function(e){if(13==(e.keyCode||e.which)){var t=document.getElementById("ownerBoxAddBoxTitle").value;this.setState({showAddBoxProgress:!0}),this.createBox(t)}}},{key:"createBox",value:function(e){(function(e,t){return new Promise((function(a,n){Ne.collection("boxes").where("title","==",e).get().then((function(o){if(o.empty){var r,s=Ne.collection("boxes").doc();s.set((r={boxID:s.id,title:e,uid:t},Object(he.a)(r,"uid",t),Object(he.a)(r,"date",Date.now()),r)).then((function(){a("Added box")}))}else n("Name Taken")}))}))})(e,this.props.user.uid).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"handleSelectValChange",value:function(e){var t=e.target.name;console.log(t),this.setState(Object(he.a)({},t,e.target.value))}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12,id:"ownerBox"},o.a.createElement(k.a,{variant:"h3"},"Welcome, ",this.state.userMD.accountType,"!"),o.a.createElement(te.a,null,o.a.createElement(ae.a,{style:{background:this.props.theme.palette.primary.mainGrad},expandIcon:o.a.createElement(ee.a,null),"aria-label":"Expand","aria-controls":"additional-actions1-content",id:"additional-actions1-header"},o.a.createElement(k.a,null,"Add Box")),o.a.createElement(ne.a,null,o.a.createElement(oe.a,{id:"ownerBoxAddBoxTitle",type:"text",style:{margin:8},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Name of box"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),o.a.createElement(te.a,null,o.a.createElement(ae.a,{style:{background:this.props.theme.palette.primary.mainGrad},expandIcon:o.a.createElement(ee.a,null),"aria-label":"Expand","aria-controls":"additional-actions0-content",id:"additional-actions0-header"},o.a.createElement(k.a,null,"Add WOD")),o.a.createElement(ne.a,null,this.state.hasBoxes?o.a.createElement(Ge,{uid:this.state.user.uid,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes}):o.a.createElement("span",null,"No boxes"))),o.a.createElement(Ke,{user:this.state.user,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes}))}}]),a}(n.Component),He=Ze=Object(D.a)(Ze),Je=d.firestore();d.database();var qe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"componentDidMount",value:function(){this.hideUsernameInput()}},{key:"componentDidUpdate",value:function(){this.hideUsernameInput()}},{key:"updateUsername",value:function(e){var t=this,a=document.getElementById("updateUsernameInput");if("none"===a.style.display)a.style.display="block";else{if(a.value.length>12)return void alert("Username cannot be longer than 12 characters");if(null!==/\W/g.exec(a.value))return void alert("Username can only contain letters & numbers");if(a.value.length<=0)return void this.hideUsernameInput();(function(e,t){var a={username:t},n=[Je.collection("users").doc(e).update(a)];return Je.collection("scores").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),Je.collection("scores").doc(e.data().scoreID).update(a)}))})),new Promise((function(e,t){Promise.all(n).then((function(){e("Updated!")})).catch((function(e){t(e)}))}))})(this.state.user.uid,a.value).then((function(e){console.log(e),t.hideUsernameInput()})).catch((function(e){console.log(e)}))}}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.updateUsername()}},{key:"hideUsernameInput",value:function(){try{var e=document.getElementById("updateUsernameInput");e.value="",e.style.display="none"}catch(t){return}}},{key:"render",value:function(){return o.a.createElement(f.a,{container:!0,id:"usernamePanel"},this.state.userMD?o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(k.a,{gutterBottom:!0,variant:"h4"},"Username"),o.a.createElement(k.a,{gutterBottom:!0,variant:"h5"},this.state.userMD.username)),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(q.a,{variant:"outlined",color:"primary",onClick:this.updateUsername.bind(this)},o.a.createElement(k.a,null,"Update Username"))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(oe.a,{id:"updateUsernameInput",type:"text",style:{margin:8},pattern:"[A-Za-z]{12}",inputProps:{title:"Letters only, max length 12",placeholder:"New username"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))):o.a.createElement("h1",null," Loading "))}}]),a}(n.Component),Qe=a(301),Xe=a(302),Ye=a(303),$e=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid,showRemoveAlert:!1,removeScoreID:""},n}return Object(i.a)(a,[{key:"handleViewWod",value:function(e){console.log("Go to wodID: ".concat(e))}},{key:"handleViewBox",value:function(e){console.log("Go to boxID: ".concat(e))}},{key:"showRemoveAlert",value:function(e){this.setState({showRemoveAlert:!0,removeScoreID:e})}},{key:"onRemove",value:function(){var e,t=this;(e=this.state.removeScoreID,new Promise((function(t,a){re.ref("scores/".concat(e)).remove().then((function(){t("Successfully removed score: ".concat(e))})).catch((function(t){a("Failed to remove score: ".concat(e))}))}))).then((function(e){t.hideRemoveAlert()})).catch((function(e){console.log(e)}))}},{key:"hideRemoveAlert",value:function(){this.setState({showRemoveAlert:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(V.a,{component:w.a},o.a.createElement(z.a,{"aria-label":"score table"},o.a.createElement(K.a,null,o.a.createElement(G.a,null,"Username"),o.a.createElement(G.a,null,"Score"),o.a.createElement(G.a,null,"Box"),o.a.createElement(G.a,null,"Wod"),o.a.createElement(G.a,null,"Remove")),o.a.createElement(_.a,null,this.state.scores.map((function(t){return o.a.createElement(tt,{info:t,onViewBox:e.handleViewBox.bind(e),onViewWod:e.handleViewWod.bind(e),onRemove:e.showRemoveAlert.bind(e)})}))))):o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(Z.a,{variant:"outlined",color:"primary"},o.a.createElement(H.a,null,o.a.createElement(k.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))),o.a.createElement(ue,{open:this.state.showRemoveAlert,actionText:"Remove",cancelText:"Cancel",modalText:"Remove score?",onAction:this.onRemove.bind(this),onClose:this.hideRemoveAlert.bind(this)}))}}]),a}(n.Component)),et=$e=Object(D.a)($e);function tt(e){var t=e.info.score,a=e.info.username,n=e.info.wodID,r=(e.info.uid,e.info.scoreID),s=e.info.boxID;return o.a.createElement(J.a,null,o.a.createElement(G.a,null,a),o.a.createElement(G.a,null,t),o.a.createElement(G.a,null,o.a.createElement(p.b,{to:"box/".concat(s)},o.a.createElement(Qe.a,null))),o.a.createElement(G.a,null,o.a.createElement(p.b,{to:"wod/".concat(s,"/").concat(n)},o.a.createElement(Xe.a,null))),o.a.createElement(G.a,null,o.a.createElement(q.a,{size:"small",color:"error",onClick:function(){return e.onRemove(r)}},o.a.createElement(Ye.a,null))))}d.storage();var at=d.database();d.database();var nt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userFollowing:[]},n}return Object(i.a)(a,[{key:"toList",value:function(e){return Object.keys(e).map((function(t){return e[t]}))}},{key:"componentDidMount",value:function(){var e,t=this;(e=this.state.user.uid,at.ref("users/".concat(e,"/following"))).on("value",(function(e){e&&e.exists()?t.setState({userFollowing:t.toList(e.val())}):t.setState({userFollowing:{}})}))}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(f.a,{xs:12},o.a.createElement(f.a,{xs:12},o.a.createElement(f.a,{xs:12},o.a.createElement(k.a,null,"Following")),this.state.userFollowing.length>0?this.state.userFollowing.map((function(e){return o.a.createElement(p.b,{to:"box/".concat(e.boxID),component:q.a},e.boxID)})):o.a.createElement(o.a.Fragment,null,"Not following anyone!")))}}]),a}(n.Component),ot=nt=Object(D.a)(nt),rt=d.database(),st=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userScores:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.listenForUserScores()}},{key:"listenForUserScores",value:function(){var e=this;rt.ref("scores").orderByChild("uid").equalTo(this.state.user.uid).on("value",(function(t){if(t&&t.exists()){var a=t.val(),n=Object.keys(a).map((function(e){return a[e]}));console.log(n),e.setState({userScores:n})}}))}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(f.a,{xs:12},o.a.createElement(f.a,{xs:12},o.a.createElement(f.a,{xs:12},o.a.createElement(ot,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(f.a,{xs:12},o.a.createElement(k.a,null,"Scores"),o.a.createElement(et,{uid:this.state.user.uid,scores:this.state.userScores}))))}}]),a}(n.Component),lt=st=Object(D.a)(st),it=(d.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,emailAlertOpen:!1},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"sendVerificationEmail",value:function(){var e=this;this.state.user.sendEmailVerification().then((function(){e.setState({emailAlertOpen:!0})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(f.a,{container:!0,align:"center"},o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(Ae.a,{in:this.state.emailAlertOpen},o.a.createElement(Ue.a,{onClose:function(){e.setState({emailAlertOpen:!1})}},"Email sent!"))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(w.a,{elevation:2}),this.state.user.emailVerified?o.a.createElement(o.a.Fragment,null):o.a.createElement(w.a,{elevation:2},o.a.createElement(q.a,{variant:"outline",onClick:this.sendVerificationEmail.bind(this)},o.a.createElement(k.a,{variant:"h5",component:"h3"},"Send Verification Email"))),o.a.createElement(w.a,{elevation:4},o.a.createElement(qe,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(w.a,{elevation:2},"owner"===this.state.userMD.accountType?o.a.createElement(He,{user:this.state.user,userMD:this.state.userMD}):o.a.createElement(lt,{user:this.state.user,userMD:this.state.userMD}))),o.a.createElement(f.a,{item:!0,xs:12},o.a.createElement(f.a,{item:!0,xs:12,className:"compBorderOutline"},o.a.createElement(w.a,{elevation:2},o.a.createElement(q.a,{variant:"outlined",color:"secondary",onClick:this.props.onLogout},o.a.createElement(k.a,{variant:"h6",component:"h6"},"Logout"))))))}}]),a}(n.Component)),ct=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(i.a)(a,[{key:"handleLogout",value:function(){var e=this;d.auth().signOut().then((function(){alert("Signed Out"),e.setState({user:null})}),(function(e){console.error("Sign Out Error",e)}))}},{key:"handleLogIn",value:function(e){this.setState({user:e})}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(x.a)({},e))}},{key:"render",value:function(){return o.a.createElement(f.a,{item:!0,xs:12,id:"profilepage"},null!==this.state.user?o.a.createElement(it,{onLogout:this.handleLogout.bind(this),user:this.state.user,userMD:this.state.userMD}):o.a.createElement(Fe,{onLogin:this.handleLogIn.bind(this)}))}}]),a}(n.Component),ut=ct=Object(D.a)(ct),mt=a(304),dt=a(300),ht=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(mt.a,{position:"static",style:{background:this.props.theme.palette.background.toolbar}},o.a.createElement(dt.a,{disableGutters:!1},o.a.createElement(k.a,{gutterBottom:!0,variant:"h3",style:{margin:"0 auto"}},"WodTrackrr")))}}]),a}(n.Component),pt=ht=Object(D.a)(ht),vt=a(31),ft=Object(vt.a)(),bt=a(141),Et=a(314),yt=a(305),gt={palette:{common:{black:"#000",white:"#fff"},background:{paper:"#2e3134",toolbar:"#0d0e0e",tableHeader:"#1b1d1e",default:"rgba(48, 48, 48, 1)"},primary:{main:"#03ceec",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#6C30FF",main:"#6C30FF",dark:"#6C30FF",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},text:{primary:"#ffffff",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},xt=gt=gt,wt=Object(bt.a)(xt);wt=Object(Et.a)(wt);var Dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={btmnav:0,user:d.auth().currentUser,userMD:!1},n}return Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this;this.firebaseAuthListener=d.auth().onAuthStateChanged((function(t){var a=d.firestore();if(t){var n=a.collection("users").doc(t.uid);e.userMDListener=n.onSnapshot((function(a){a.exists?e.setState({user:t,userMD:a.data()}):e.setState({user:t,userMD:!1})}),(function(e){console.log(e)}))}}))}},{key:"componentWillUnmount",value:function(){void 0!==this.firebaseAuthListener&&this.firebaseAuthListener&&this.firebaseAuthListener(),null!==this.userMDListener&&this.userMDListener&&this.userMDListener()}},{key:"render",value:function(){var e=this;return o.a.createElement(h.Provider,null,o.a.createElement(p.a,{history:ft},o.a.createElement(yt.a,{theme:wt},o.a.createElement(f.a,{container:!0},o.a.createElement(f.a,{item:!0,xs:12,id:"page-header"},o.a.createElement(pt,{className:"header"})),o.a.createElement(f.a,{item:!0,xs:11,id:"page-container",className:"page-content"},o.a.createElement(v.d,null,o.a.createElement(v.b,{exact:!0,path:"/boxSearch"},o.a.createElement(Pe,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(v.b,{exact:!0,path:"/profile"},o.a.createElement(ut,{user:this.state.user,userMD:this.state.userMD})),o.a.createElement(v.b,{path:"/box/:boxID",render:function(t){return o.a.createElement(Se,{userMD:e.state.userMD,boxID:t.match.params.boxID})}}),o.a.createElement(v.b,{path:"/wod/:boxID/:wodID",render:function(t){return o.a.createElement(de,{userMD:e.state.userMD,boxID:t.match.params.boxID,wodID:t.match.params.wodID,isReadOnly:!0})}}),o.a.createElement(v.b,{exact:!0,path:"/register",render:function(e){return o.a.createElement(Le,null)}})),o.a.createElement("div",{style:{margin:"10vh"}})),o.a.createElement(f.a,{item:!0,xs:12,className:"footer"},o.a.createElement(b.a,{value:this.state.btmnav,onChange:function(t,a){e.setState({btmnav:a})},style:{background:wt.palette.background.toolbar},showLabels:!0},o.a.createElement(E.a,{label:"Search",component:p.b,to:"/boxSearch",icon:o.a.createElement(g.a,null)}),o.a.createElement(E.a,{label:"Profile",component:p.b,to:"/profile",icon:o.a.createElement(g.a,null)})))))))}}]),a}(o.a.Component);Dt.contextType=h,s.a.render(o.a.createElement(Dt,null),document.getElementById("root"))},27:function(e,t,a){}},[[150,1,2]]]);
//# sourceMappingURL=main.0cae1c34.chunk.js.map