(this.webpackJsonpreactapp=this.webpackJsonpreactapp||[]).push([[0],{170:function(e,t,a){e.exports=a(277)},18:function(e,t,a){},277:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(20),r=a.n(s),i=a(5),l=a(6),c=a(8),u=a(7),m=a(130),h=(a(17),m),d=o.a.createContext(m.initializeApp({apiKey:"AIzaSyCGE8_j8cfIBmIzcvP6CVgG2yC6EE1Ep1U",authDomain:"wodtrackrr.firebaseapp.com",databaseURL:"https://wodtrackrr.firebaseio.com",projectId:"wodtrackrr",storageBucket:"wodtrackrr.appspot.com",messagingSenderId:"743601990099",appId:"1:743601990099:web:5937e9151eaad13e93a726",measurementId:"G-39CF0BRPMH"})),f=(a(19),a(13)),p=a(24),g=a(312),v=a(340),y=a(342),b=a(155),E=a(353),x=a(4),w=a(341),D=a(133),C=a.n(D),k=(a(18),a(34),a(158)),O=a(352),M=a(315),I=a(316),S=a(280),j=a(281),A=a(314),P=a(349),T=a(319),L=a(320),B=a(321),U=a(322),R=a(323),F=a(30),N=a.n(F),W=a(39),V=a.n(W),G=a(89),z=a.n(G),K=a(348),H=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={open:e.open},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(K.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(g.a,{item:!0,align:"center",xs:12},o.a.createElement(k.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,{style:{marginTop:"32px"}},this.props.modalText)),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{variant:"outlined",onClick:function(){e.props.onClose()}},this.props.cancelText)),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{color:"primary",variant:"outlined",onClick:function(){e.props.onAction()}},this.props.actionText)))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),J=H=Object(O.a)(H),Z=a(16),Y=a(23),_=h.firestore();function q(e,t,a,n){var o=_.collection("adminNotifications").doc(t.boxID).collection("classes").doc(t.gymClassID).collection("adminNotifications"),s=_.collection("userAdminNotifications").doc(e).collection("notifications").doc(),r={uid:e,sender:a,senderUsername:n,owner:t.owner,boxID:t.boxID,gymClassID:t.gymClassID,boxTitle:t.boxTitle,gymClassTitle:t.title,date:Date.now()};return new Promise((function(a,n){console.log("idAdmin?"),Q(e,t.boxID,t.gymClassID).then((function(i){i?a("Already an admin."):(console.log("isSent?"),function(e,t,a){return new Promise((function(n,o){console.log("isSent: start"),_.collection("adminNotifications").doc(t).collection("classes").doc(a).collection("adminNotifications").doc(e).get().then((function(e){console.log("isSent: snapshot"),console.log(e),n(e.exists)}),(function(e){o(e)}))}))}(e,t.boxID,t.gymClassID).then((function(t){t?a("Admin notified already."):(console.log("Setting adminf notify data"),Promise.all([s.set(Object(Y.a)(Object(Y.a)({},r),{},{notifyID:s.id})),o.doc(e).set(r)]).then((function(){a("Sent admin invite.")})).catch((function(e){n(e)})))})).catch((function(e){n(e)})))}))}))}function Q(e,t,a){return new Promise((function(n,o){_.collection("classAdmins").doc(t).collection("classes").doc(a).collection("admins").doc(e).get().then((function(e){console.log(e),e.exists?n(!0):n(!1)})).catch((function(e){o(e)}))}))}function X(e,t,a,n,o,s,r){return new Promise((function(i,l){Q(e,t,a).then((function(c){if(c)i("User is an admin.");else{var u={uid:e,boxID:t,gymClassID:a,owner:n,username:o,boxTitle:s,classTitle:r,date:Date.now()},m=_.collection("classAdmins").doc(t).collection("classes").doc(a).collection("admins").doc(e),h=_.collection("userClassAdmins").doc(e).collection("classes").doc(a);Promise.all([m.set(Object(Y.a)(Object(Y.a)({},u),{},{classAdminID:m.id})),h.set(Object(Y.a)(Object(Y.a)({},u),{},{classAdminID:m.id}))]).then((function(){i("Added user as an admin.")})).catch((function(e){l(e)}))}})).catch((function(e){l(e)}))}))}function $(e){var t=e.boxID,a=e.gymClassID,n=e.uid;return Promise.all([_.collection("classAdmins").doc(t).collection("classes").doc(a).collection("admins").doc(n).delete(),_.collection("userClassAdmins").doc(n).collection("classes").doc(a).delete()])}var ee=h.firestore();function te(e,t,a){return ee.collection("wods").doc(e).collection("classes").doc(t).collection("wods").doc(a)}function ae(e,t,a,n,o,s,r,i,l){var c=ee.collection("wods").doc(t).collection("classes").doc(a).collection("wods").doc(),u={title:e,boxID:t,gymClassID:a,owner:n,boxTitle:o,classTitle:s,scoreType:r,wodText:i,isPrivate:l,date:Date.now(),wodID:c.id};return new Promise((function(e,t){c.set(u).then((function(){e(c.id)})).catch((function(e){t(e)}))}))}function ne(e,t,a){var n=ee.batch();(function(e){var t="".concat(e.boxID,"/classes/").concat(e.gymClassID,"/wods/").concat(e.wodID),a="scores/".concat(t,"/scores");return new Promise((function(e,t){ee.collection(a).get().then((function(t){var a=[];t.empty||(t.forEach((function(e){a.push(e.data().uid)})),console.log(a),e(a)),e(null)})).catch((function(e){console.log(e),t(e)}))}))})(e).then((function(o){null==o&&t(!1);var s=o.map((function(t){return ee.collection("userScores").doc(t).collection("scores").where("wodID","==",e.wodID).get()})),r=0;Promise.all(s).then((function(e){e.forEach((function(e){0==e.size&&t(!0),console.log(e),e.empty||e.forEach((function(e){console.log(e),n.delete(e.ref),r++}))}))})).then((function(){n.commit().then((function(){r>=500&&ne(e,t,a),t(!0)})).catch((function(e){console.log(e),a(e)}))}))})).catch((function(e){console.log(e),a(e)}))}function oe(e){return new Promise((function(t,a){(function(e){return new Promise((function(t,a){ne(e,t,a)}))})(e).then((function(n){new Promise((function(t,a){console.log("scores removed? ",n),n?function e(t,a,n,o,s){var r=ee.batch();ee.collection(t).where(a,"==",n).get().then((function(i){var l=0;0==i.size&&o(1),i.forEach((function(e){r.delete(e.ref),l++})),r.commit().then((function(){l>=500&&e(t,a,n,o,s)})).catch((function(e){console.log(e),s(e)}))})).catch((function(e){console.log(e),s(e)})),o(1)}("scores/".concat(e.boxID,"/classes/").concat(e.gymClassID,"/wods/").concat(e.wodID,"/scores"),"wodID",e.wodID,t,a):t(!1)})).then((function(){ee.collection("wods/".concat(e.boxID,"/classes/").concat(e.gymClassID,"/wods")).doc(e.wodID).delete(),t(!0)})).catch((function(e){console.log(e),a(e)}))})).catch((function(e){console.log(e),a(e)}))}))}var se=h.firestore();function re(e,t,a,n){var o=se.collection("memberNotifications").doc(t.boxID).collection("classes").doc(t.gymClassID).collection("memberNotifications"),s=se.collection("userMemberNotifications").doc(e).collection("notifications").doc(),r={uid:e,sender:a,senderUsername:n,owner:t.owner,boxID:t.boxID,gymClassID:t.gymClassID,boxTitle:t.boxTitle,gymClassTitle:t.title,date:Date.now()};return new Promise((function(a,n){console.log("idAdmin?"),ie(e,t.boxID,t.gymClassID).then((function(i){i?a("Already an admin."):(console.log("isSent?"),function(e,t,a){return new Promise((function(n,o){console.log("isSent: start"),se.collection("memberNotifications").doc(t).collection("classes").doc(a).collection("memberNotifications").doc(e).get().then((function(e){console.log("isSent: snapshot"),console.log(e),n(e.exists)}),(function(e){o(e)}))}))}(e,t.boxID,t.gymClassID).then((function(t){t?a("Admin notified already."):(console.log("Setting adminf notify data"),Promise.all([s.set(Object(Y.a)(Object(Y.a)({},r),{},{notifyID:s.id})),o.doc(e).set(r)]).then((function(){a("Sent admin invite.")})).catch((function(e){n(e)})))})).catch((function(e){n(e)})))}))}))}function ie(e,t,a){return new Promise((function(n,o){se.collection("classMembers").doc(t).collection("classes").doc(a).collection("members").doc(e).get().then((function(e){console.log(e),e.exists?n(!0):n(!1)})).catch((function(e){o(e)}))}))}function le(e,t,a,n,o,s,r){return new Promise((function(i,l){ie(e,t,a).then((function(c){if(c)i("User is an admin.");else{var u={uid:e,boxID:t,gymClassID:a,owner:n,username:o,boxTitle:s,classTitle:r,date:Date.now()},m=se.collection("classMembers").doc(t).collection("classes").doc(a).collection("members").doc(e),h=se.collection("userClassMembers").doc(e).collection("classes").doc(a);Promise.all([m.set(Object(Y.a)(Object(Y.a)({},u),{},{classAdminID:m.id})),h.set(Object(Y.a)(Object(Y.a)({},u),{},{classAdminID:m.id}))]).then((function(){i("Added user as an admin.")})).catch((function(e){l(e)}))}})).catch((function(e){l(e)}))}))}function ce(e){var t=e.boxID,a=e.gymClassID,n=e.uid;return Promise.all([se.collection("classMembers").doc(t).collection("classes").doc(a).collection("members").doc(n).delete(),se.collection("userClassMembers").doc(n).collection("classes").doc(a).delete()])}var ue=h.firestore();function me(e){return ue.collection("gymClasses").doc(e).collection("classes")}function he(e,t,a,n,o,s){return new Promise((function(r,i){ue.collection("gymClasses").doc(a).collection("classes").where("title","==",e).get().then((function(l){if(l.empty){var c,u=ue.collection("gymClasses").doc(a).collection("classes").doc();u.set((c={gymClassID:u.id,boxID:a,boxTitle:n,title:e,uid:t},Object(Z.a)(c,"uid",t),Object(Z.a)(c,"isPrivate",o),Object(Z.a)(c,"owner",s),Object(Z.a)(c,"date",Date.now()),c)).then((function(){r(u.id)})).catch((function(e){i(e)}))}else r("Name Taken")})).catch((function(e){i(e)}))}))}function de(e){return new Promise((function(t,a){var n;(n=e,new Promise((function(e,t){ue.collection("classAdmins").doc(n.boxID).collection("classes").doc(n.gymClassID).collection("admins").get().then((function(t){var a=[];t.empty||(t.forEach((function(e){a.push(e.data().uid)})),console.log(a),e(a)),e(null)})).catch((function(e){console.log(e),t(e)}))}))).then((function(n){if(null!=n){var o=n.map((function(t){return $({boxID:e.boxID,gymClassID:e.gymClassID,uid:t})}));Promise.all(o).then((function(){t(!0)})).catch((function(e){a(e)}))}else t(!1)}))}))}function fe(e){return new Promise((function(t,a){var n;(n=e,new Promise((function(e,t){ue.collection("classMembers").doc(n.boxID).collection("classes").doc(n.gymClassID).collection("members").get().then((function(t){var a=[];t.empty||(t.forEach((function(e){a.push(e.data().uid)})),console.log(a),e(a)),e(null)})).catch((function(e){console.log(e),t(e)}))}))).then((function(n){if(null!=n){var o=n.map((function(t){return ce({boxID:e.boxID,gymClassID:e.gymClassID,uid:t})}));Promise.all(o).then((function(){t(!0)})).catch((function(e){a(e)}))}else t(!1)}))}))}function pe(e){return new Promise((function(t,a){(function(e){return new Promise((function(t,a){ue.collection("adminNotifications").doc(e.boxID).collection("classes").doc(e.gymClassID).collection("adminNotifications").where("owner","==",e.owner).get().then((function(e){console.log(e);var a=[];e.empty||(e.forEach((function(e){a.push(e.data().uid)})),console.log(a),t(a)),t(null)})).catch((function(e){console.log(e),a(e)}))}))})(e).then((function(n){if(console.log(n),null!=n){var o=n.map((function(t){var a,n={boxID:e.boxID,gymClassID:e.gymClassID,uid:t};return console.log(n),a=n,new Promise((function(e,t){ue.collection("userAdminNotifications").doc(a.uid).collection("notifications").where("uid","==",a.uid).get().then((function(e){console.log(e),e.empty||e.forEach((function(e){e.ref.delete()})),ue.collection("adminNotifications").doc(a.boxID).collection("classes").doc(a.gymClassID).collection("adminNotifications").doc(a.uid).delete().catch((function(e){console.log(e)}))})).then((function(){e("Removed notification.")})).catch((function(e){console.log(e),t(e)}))}))}));Promise.all(o).then((function(){t(!0)})).catch((function(e){console.log(e),a(e)}))}else t(!1)}))}))}function ge(e){return new Promise((function(t,a){(function(e){return new Promise((function(t,a){ue.collection("memberNotifications").doc(e.boxID).collection("classes").doc(e.gymClassID).collection("memberNotifications").where("owner","==",e.owner).get().then((function(e){console.log(e);var a=[];e.empty||(e.forEach((function(e){a.push(e.data().uid)})),console.log(a),t(a)),t(null)})).catch((function(e){console.log(e),a(e)}))}))})(e).then((function(n){if(console.log(n),null!=n){var o=n.map((function(t){var a,n={boxID:e.boxID,gymClassID:e.gymClassID,uid:t};return console.log(n),a=n,new Promise((function(e,t){ue.collection("userMemberNotifications").doc(a.uid).collection("notifications").where("uid","==",a.uid).get().then((function(e){console.log(e),e.empty||e.forEach((function(e){e.ref.delete()})),ue.collection("memberNotifications").doc(a.boxID).collection("classes").doc(a.gymClassID).collection("memberNotifications").doc(a.uid).delete().catch((function(e){console.log(e)}))})).then((function(){e("Removed notification.")})).catch((function(e){console.log(e),t(e)}))}))}));Promise.all(o).then((function(){t(!0)})).catch((function(e){console.log(e),a(e)}))}else t(!1)}))}))}function ve(e){return new Promise((function(t,a){var n=[pe(e),ge(e),de(e),fe(e),new Promise((function(t,a){var n,o,s;(n=e.boxID,o=e.gymClassID,s=e.isPrivate,new Promise((function(e,t){ue.collection("wods").doc(n).collection("classes").doc(o).collection("wods").where("isPrivate","==",s).get().then((function(t){console.log(t);var a=[];t.empty||(t.forEach((function(e){a.push(e.data().wodID)})),console.log(a),e(a)),e(!1)})).catch((function(e){console.log(e),t(e)}))}))).then((function(n){if(n){var o=n.map((function(t){return oe({boxID:e.boxID,gymClassID:e.gymClassID,wodID:t,isPrivate:e.isPrivate})}));Promise.all(o).then((function(){console.log("Deleted wods from class: ".concat(e.gymClassID)),t("Deleted wods from class: ".concat(e.gymClassID))})).catch((function(t){console.log("Error deleteing wods from class: ".concat(e.gymClassID)),a(t)}))}else t(!1)}))}))];Promise.all(n).then((function(n){console.log(n),console.log("DELETING CLASSSSSSSS"),ue.collection("gymClasses").doc(e.boxID).collection("classes").doc(e.gymClassID).delete().then((function(){t("Deleted class: ".concat(e.gymClassID))})).catch((function(t){console.log(t),a("Error deleting class: ".concat(e.gymClassID))}))})).catch((function(e){console.log("Errorasdlkasndlkasndlknaskldn"),console.log(e)}))}))}h.firestore();var ye=Object(O.a)((function(e){var t=e.info.title,a=e.info.boxID,n=e.info.gymClassID;return o.a.createElement(M.a,{id:"class/".concat(n),name:"GymClassRow",onClick:function(t){e.onRowClick(t,"/class/".concat(a,"/").concat(n))}},o.a.createElement(I.a,{align:"left"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},t)),o.a.createElement(I.a,{align:"right"},e.isOwner?o.a.createElement(A.a,{onClick:function(){e.onRemove(e.info)}},o.a.createElement(V.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))}));var be=Object(O.a)((function(e){return o.a.createElement(M.a,null,o.a.createElement(I.a,{colSpan:3,align:"center"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"No Classes!")))})),Ee=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,isOwner:e.isOwner,boxID:e.boxID,filteredGymClasses:[],gymClasses:[],removeClass:{},openModal:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){console.log(this.state),this.getGymClasses(this.state.boxID)}},{key:"getGymClasses",value:function(e){var t=this;e&&!this.gymClassListener&&(this.gymClassListener=me(this.state.boxID).onSnapshot((function(e){if(console.log(e),e.empty)t.setState({gymClasses:[],filteredGymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data())})),t.setState({gymClasses:a,filteredGymClasses:a})}}),(function(e){console.log(e)})))}},{key:"componentDidUpdate",value:function(){this.getGymClasses(this.state.boxID)}},{key:"componentWillUnmount",value:function(){this.gymClassListener&&this.gymClassListener()}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.gymClasses.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredGymClasses:a})}},{key:"onRowClick",value:function(e,t){var a=e.target.tagName;["span","svg","path"].indexOf(a)<0&&(console.log("pushed ",t),this.props.history.push(t))}},{key:"handleRemoveGymClass",value:function(){var e=this;this.closeModal(),this.state.boxID||this.state.removeClass.gymClassID?ve(this.state.removeClass).then((function(t){console.log(t),e.props.onAlert({type:"success",message:"Deleted class!"})})).catch((function(e){console.log(e)})):this.props.onAlert({type:"error",message:"Class info missing!"})}},{key:"onRemove",value:function(e){this.setState({openModal:!0,removeClass:e})}},{key:"closeModal",value:function(){this.setState({openModal:!1})}},{key:"render",value:function(){var e=this;return console.log(this.state.gymClasses),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(k.a,{elevation:2,component:"form"},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Classes",InputProps:{startAdornment:o.a.createElement(T.a,{position:"start"},o.a.createElement(N.a,{color:"primary"}))}}))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(L.a,null,o.a.createElement(B.a,{stickyHeader:!0},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Classes"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.filteredGymClasses.length>0?this.state.filteredGymClasses.map((function(t,a){return o.a.createElement(ye,{key:a,info:t,onRemove:e.onRemove.bind(e),isOwner:e.props.isOwner,onRowClick:e.onRowClick.bind(e)})})):o.a.createElement(be,null)))))),o.a.createElement(J,{open:this.state.openModal,actionText:"Remove",cancelText:"Cancel",modalText:"Remove Class (".concat(this.state.removeClass.title,")?"),onAction:this.handleRemoveGymClass.bind(this),onClose:this.closeModal.bind(this)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),xe=Ee=Object(p.g)(Object(O.a)(Ee)),we=a(344),De=a(324),Ce=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"render",value:function(){return o.a.createElement(we.a,{style:{}},o.a.createElement(j.a,{onClick:this.props.history.goBack,style:{color:this.props.theme.palette.text.primary}},o.a.createElement(De.a,null)))}}]),a}(n.Component),ke=Ce=Object(p.g)(Object(O.a)(Ce)),Oe=h.firestore(),Me=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),n=t.call(this,e),console.log(e),n.state={userMD:e.userMD,boxID:e.boxID,boxMD:{}},n}return Object(l.a)(a,[{key:"getBoxListener",value:function(){var e=this;this.boxListener||(this.boxListener=Oe.collection("boxes").doc(this.state.boxID).onSnapshot((function(t){t.exists?e.setState({boxMD:t.data()}):e.setState({boxMD:{}})}),(function(e){console.log(e)})))}},{key:"checkListeners",value:function(){void 0===this.boxListener&&this.getBoxListener()}},{key:"componentDidMount",value:function(){this.checkListeners()}},{key:"componentDidUpdate",value:function(){this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.boxListener&&this.boxListener()}},{key:"render",value:function(){var e=this.state.userMD.uid===this.state.boxMD.uid;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ke,null),Object.keys(this.state.boxMD).length>0?o.a.createElement(xe,{user:this.state.user,userMD:this.state.userMD,boxID:this.state.boxID,isOwner:e,onAlert:this.props.onAlert}):o.a.createElement(o.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ie=Me=Object(O.a)(Me);function Se(e,t){var a=h.firestore();return Promise.all([a.collection("userFollowing").doc(e).collection("following").doc(t).delete(),a.collection("followers").doc(t).collection("followers").doc(e).delete()])}function je(e){return h.firestore().collection("userFollowing").doc(e).collection("following").where("uid","==",e)}function Ae(e,t,a,n,o){var s=h.firestore();return new Promise((function(r,i){var l=s.collection("userFollowing").doc(e).collection("following").doc(a),c=s.collection("followers").doc(a).collection("followers").doc(e),u={uid:e,owner:o,username:t,boxID:a,title:n,date:Date.now()};Promise.all([l.set(u),c.set(u)]).then((function(){r("Followed.")})).catch((function(e){i(e)}))}))}h.firestore();var Pe=Object(O.a)((function(e){var t=e.info.title,a=e.info.boxID;return o.a.createElement(M.a,{id:"box/".concat(a),onClick:function(t){return e.onRowClick(t,"box/".concat(a))}},o.a.createElement(I.a,{align:"left"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},t)),o.a.createElement(I.a,{align:"right"},e.isUserFollowing?o.a.createElement(j.a,{variant:"outlined",onClick:function(){e.handleUnfollow(a)}},o.a.createElement(z.a,{color:"primary"})):o.a.createElement(j.a,{onClick:function(){e.handleFollow(e.info)}},o.a.createElement(z.a,{style:{fill:e.theme.palette.text.primary}})),e.isOwner?o.a.createElement(A.a,{onClick:function(){e.handleRemoveBox(a,t)}},o.a.createElement(V.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))}));var Te=Object(O.a)((function(e){return o.a.createElement(M.a,null,o.a.createElement(I.a,{colSpan:3,align:"center"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"No Gyms!")))})),Le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,isOwner:e.isOwner,allBoxes:e.allBoxes,filteredBoxes:e.filteredBoxes,userFollowing:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.listenForFollowing()}},{key:"componentWillUnmount",value:function(){this.followListener&&this.followListener()}},{key:"componentDidUpdate",value:function(){this.listenForFollowing()}},{key:"listenForFollowing",value:function(){var e=this;this.state.userMD&&!this.followListener&&(this.followListener=je(this.state.userMD.uid).onSnapshot((function(t){var a=function(e){var t=[];return e.empty||e.docs.forEach((function(e){t.push(e.data().boxID)})),t}(t),n={};a.forEach((function(e){n[e]=!0})),e.setState({userFollowing:n})}),(function(e){console.log(e)})))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allBoxes.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));console.log("filteredBoxes"),console.log(a),this.setState({filteredBoxes:a})}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"handleFollow",value:function(e){Ae(this.state.userMD.uid,this.state.userMD.username,e.boxID,e.title,e.uid).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){Se(this.state.userMD.uid,e).then((function(e){e&&console.log("Succefully unfollowed.")})).catch((function(e){console.log(e)}))}},{key:"onRowClick",value:function(e,t){var a=e.target.tagName;["span","svg","path","BUTTON","SPAN"].indexOf(a)<0&&this.props.history.push(t)}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"3vh"}},o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(k.a,{elevation:2,component:"form"},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Boxes",InputProps:{startAdornment:o.a.createElement(T.a,{position:"start"},o.a.createElement(N.a,{color:"primary"}))}}))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(L.a,null,o.a.createElement(B.a,{stickyHeader:!0},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Boxes"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.filteredBoxes.length>0?this.state.filteredBoxes.map((function(t,a){return o.a.createElement(Pe,{key:a,theme:e.props.theme,info:t,color:e.props.theme.palette.primary.mainGrad,handleBoxView:e.props.handleBoxView,handleRemoveBox:e.props.handleRemoveBox,isOwner:e.props.isOwner,isUserFollowing:e.isUserFollowing(t.boxID),handleFollow:e.handleFollow.bind(e),handleUnfollow:e.handleUnfollow.bind(e),onRowClick:e.onRowClick.bind(e)})})):o.a.createElement(Te,null))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.userMD?t:e}}]),a}(n.Component),Be=Le=Object(p.g)(Object(O.a)(Le)),Ue=a(53),Re=h.firestore();function Fe(e,t){return new Promise((function(a,n){Re.collection("boxes").where("title","==",e).get().then((function(o){if(o.empty){var s,r=Re.collection("boxes").doc();r.set((s={boxID:r.id,title:e,uid:t},Object(Z.a)(s,"uid",t),Object(Z.a)(s,"date",Date.now()),s)).then((function(){a(r.id)}))}else n("Name Taken")}))}))}function Ne(e){return new Promise((function(t,a){!function e(t,a,n){var o=Re.batch();Re.collection("followers").doc(t).collection("followers").get().then((function(s){var r=0;if(s.empty)a(1);else{var i=[];s.forEach((function(e){i.push(Re.collection("userFollowing").doc(e.data().uid).collection("following").doc(t).get())})),Promise.all(i).then((function(s){var i,l=Object(Ue.a)(s);try{for(l.s();!(i=l.n()).done;){var c=i.value;o.delete(c.ref),r++}}catch(u){l.e(u)}finally{l.f()}o.commit().then((function(){r>=500&&e(t,a,n)})).catch((function(e){console.log(e),n(e.message)}))})).catch((function(e){}))}})).catch((function(e){console.log(e),n(e.message)})),a(1)}(e,t,a)}))}function We(e){return new Promise((function(t,a){!function e(t,a,n){var o=Re.batch();Re.collection("followers").doc(t).collection("followers").get().then((function(s){var r=0;if(s.empty)a(1);else{s.forEach((function(e){o.delete(e.ref),r++})),o.commit().then((function(){r>=500&&e(t,a,n)})).catch((function(e){console.log(e),n(e.message)}))}})).catch((function(e){console.log(e),n(e.message)})),a(1)}(e,t,a)}))}function Ve(e){return new Promise((function(t,a){Ne(e).then((function(){We(e).then((function(){console.log("Removed Followers"),t(!0)}))})).catch((function(e){console.log(e),a(e)}))}))}function Ge(e){return new Promise((function(t,a){Re.collection("gymClasses").doc(e).collection("classes").get().then((function(n){if(console.log(n),n.empty)t(!1);else{var o=[];n.docs.forEach((function(e){console.log("Remove class w. data: "),console.log(e.data()),o.push(ve(e.data()))})),Promise.all(o).then((function(a){Re.collection("userFollowing").doc(e),console.log(a),t(a)})).catch((function(e){console.log(e),a(e.message)}))}})).catch((function(e){console.log(e),a(e.message)}))}))}function ze(e){return new Promise((function(t,a){(function(e){return Promise.all([Ve(e),Ge(e)])})(e).then((function(n){Re.collection("boxes").doc(e).get().then((function(e){console.log(e),e.exists&&e.ref.delete().then((function(){t("Deleted box!")})).catch((function(e){console.log(e),a(e.message)}))})).catch((function(e){console.log(e),a(e.message)}))})).catch((function(e){console.log(e),a(e.message)}))}))}var Ke=h.firestore();function He(e,t,a,n,o,s,r,i,l){return new Promise((function(c,u){var m={uid:s,wodID:n,gymClassID:a,boxID:t,username:r,title:e,score:i,scoreType:l,owner:o,date:Date.now()},h=Ke.collection("scores").doc(t).collection("classes").doc(a).collection("wods").doc(n).collection("scores").doc(s),d=Ke.collection("userScores").doc(s).collection("scores");d.where("wodID","==",n).get().then((function(e){if(console.log(e),e.empty){var t=d.doc();t.set(Object(Y.a)(Object(Y.a)({},m),{},{scoreID:t.id}))}else{var a=e.docs[0].data().scoreID;d.doc(a).update(m)}h.set(m).then((function(){c("Added new score.")})).catch((function(e){u(e)}))})).catch((function(e){console.log(e)}))}))}function Je(e,t,a,n,o){return new Promise((function(o,s){Promise.all([Ke.collection("scores").doc(e).collection("classes").doc(t).collection("wods").doc(a).collection("scores").doc(n).delete(),Ke.collection("userScores").doc(n).collection("scores").where("wodID","==",a).get().then((function(e){console.log("userScores SS"),console.log(e),e.empty||e.forEach((function(e){console.log(e),e.ref.delete()}))})).catch((function(e){console.log(e),s(e)}))]).then((function(){o("Successfully removed score: ".concat(a))})).catch((function(e){s(e.message)}))}))}h.firestore();var Ze=h.firestore(),Ye=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,allBoxes:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.allBoxesListener=Ze.collection("boxes").onSnapshot((function(t){if(!t.empty){var a=[];t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.title.toLowerCase()>t.title.toLowerCase()?-1:1})),e.setState({allBoxes:a})}}))}},{key:"componentWillUnmount",value:function(){this.allBoxesListener&&this.allBoxesListener()}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},this.state.allBoxes.length>0?o.a.createElement(Be,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.allBoxes,filteredBoxes:this.state.allBoxes,isOwner:!1,isReadOnly:!1,handleRemoveBox:this.props.handleRemoveBox}):o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:2},"No boxes!")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),_e=Ye=Object(O.a)(Ye),qe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,currentPassword:"",newPassword:"",confirmPassword:""},n}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=this.state.currentPassword,n=this.state.newPassword,o=this.state.confirmPassword;if(console.log(this.state),console.log(a,n,o),n===o){var s=h.auth.EmailAuthProvider.credential(this.state.user.email,a);this.state.user.reauthenticateWithCredential(s).then((function(){t.state.user.updatePassword(n).then((function(e){console.log("Changed password.")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),console.log("Incorrect password.")}))}else console.log("New passwords do not match.")}},{key:"onChange",value:function(e){console.log(e),e.persist();var t=e.target,a=t.name,n=t.value;this.setState(Object(Z.a)({},a,n))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.state.user?o.a.createElement(k.a,{elevation:6},o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(S.a,{variant:"h3"},"Change Password")),o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(P.a,{id:"currentPassword",type:"password",name:"currentPassword",onChange:this.onChange.bind(this),style:{margin:8},placeholder:"Current Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement(P.a,{id:"password",type:"password",name:"newPassword",color:"primary",onChange:this.onChange.bind(this),style:{margin:8},placeholder:"New Password",margin:"normal",InputLabelProps:{shrink:!0}})),o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(P.a,{id:"passwordConfirm",name:"confirmPassword",onChange:this.onChange.bind(this),type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})),o.a.createElement(g.a,{item:!0,xs:12,align:"center",style:{margin:"16px 0px 16px 0px"}},o.a.createElement(A.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Change Password")))):o.a.createElement("h1",null,"Loading"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.user?t:e}}]),a}(n.Component),Qe=qe=Object(O.a)(qe),Xe=(h.firestore(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userConfirmText:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"confirmText",value:function(){return this.state.user.uid.slice(-5)}},{key:"onChange",value:function(e){var t=e.target.value;this.setState({userConfirmText:t})}},{key:"removeUser",value:function(){this.state.userConfirmText===this.confirmText()?(console.log("Deleting user, actual code commented out."),this.setState({redirect:!0,redirectUrl:"/boxSearch"}),this.props.history("/boxSearch")):console.log("User entered incorrect confirmation.")}},{key:"render",value:function(){return o.a.createElement(k.a,{elevation:6},o.a.createElement(g.a,{item:!0,container:!0,align:"center",xs:12,style:{marginTop:"16px"}},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,null,"Type to Confirm Delete: ",this.confirmText())),o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"16px"}},o.a.createElement(P.a,{type:"text",placeholder:"Type username to confirm delete",onChange:this.onChange.bind(this)})),o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"32px"}},o.a.createElement(A.a,{size:"small",fullWidth:!0,variant:"outlined",onClick:this.removeUser.bind(this),style:{color:this.props.theme.palette.error.main}},"Confirm Remove"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.user?t:e}}]),a}(n.Component)),$e=Xe=Object(p.g)(Object(O.a)(Xe)),et=h.firestore();Object(x.a)({root:{borderBottom:"none"}})(I.a);var tt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD},n}return Object(l.a)(a,[{key:"updateUsername",value:function(e){var t=document.getElementById("updateUsernameInput");if("none"===t.style.display)t.style.display="block";else{if(t.value.length>12)return void this.props.onAlert({type:"warning",message:"Username cannot be longer than 12 characters"});if(null!==/\W/g.exec(t.value))return void this.props.onAlert({type:"warning",message:"Username can only contain letters & numbers"});if(t.value.length<=0)return;(function(e,t){var a={username:t},n=[et.collection("users").doc(e).update(a)];return et.collection("scores").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),et.collection("scores").doc(e.data().scoreID).update(a)}))})),et.collection("following").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),et.collection("following").doc(e.data().followID).update(a)}))})),new Promise((function(e,t){Promise.all(n).then((function(){e("Updated!")})).catch((function(e){t(e)}))}))})(this.state.userMD.uid,t.value).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.updateUsername()}},{key:"render",value:function(){return o.a.createElement(g.a,{container:!0,id:"usernamePanel"},this.state.userMD?o.a.createElement(g.a,{item:!0,container:!0,align:"center",xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,{variant:"h5",color:"primary"},this.state.userMD.username)),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(P.a,{id:"updateUsernameInput",type:"text",pattern:"[A-Za-z]{12}",inputProps:{title:"Letters only, max length 12",placeholder:"New username"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"8px"}},o.a.createElement(A.a,{size:"small",variant:"outlined",color:"primary",onClick:this.updateUsername.bind(this)},"Update"))):o.a.createElement("h1",null," Loading "))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),at=tt=Object(O.a)(tt);var nt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user},n}return Object(l.a)(a,[{key:"sendVerificationEmail",value:function(){var e=this,t=new Promise((function(t,a){e.state.user.sendEmailVerification().then((function(){console.log("Sent Email verification."),e.props.onAlert({type:"success",message:"Sent email verification"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}));this.cancelablePromise=function(e){var t=!1;return{promise:new Promise((function(a,n){e.then((function(e){return t?n({isCanceled:!0}):a(e)}),(function(e){return n(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}(t)}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:6,align:"center"},o.a.createElement(k.a,null,o.a.createElement(S.a,null,"Email"))),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(k.a,null,o.a.createElement(S.a,null,this.state.user.email)))),this.state.user.emailVerified?o.a.createElement(o.a.Fragment,null):o.a.createElement(g.a,{item:!0,xs:12,align:"center",style:{margin:"16px 0px 0px 0px "}},o.a.createElement(k.a,{elevation:4},o.a.createElement(S.a,null,"Verification"),o.a.createElement(A.a,{color:"secondary",style:{margin:"0px 0px 4px 0px "},onClick:this.sendVerificationEmail.bind(this)},o.a.createElement(S.a,{variant:"subtitle2"},"Send Verification Email")))))}}]),a}(n.Component),ot=nt=Object(O.a)(nt);h.firestore();var st=Object(O.a)((function(e){return o.a.createElement(M.a,{onClick:function(){e.openSetting(e.info.id)}},o.a.createElement(I.a,{align:"left",colSpan:2},e.info.title))})),rt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,currentPage:"home"},n.settings=[{id:"change username",title:"Change Username"},{id:"email",title:"Email"},{id:"change password",title:"Change Password"},{id:"delete account",title:"Delete Account"}],n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"openSetting",value:function(e){console.log("clicked ",e),this.setState({currentPage:e})}},{key:"handleBack",value:function(){this.setState({currentPage:"home"})}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},"home"===this.state.currentPage?o.a.createElement(B.a,null,o.a.createElement(U.a,null,o.a.createElement(ke,null),o.a.createElement(M.a,null,o.a.createElement(I.a,{align:"center",colSpan:2},o.a.createElement(S.a,{gutterBottom:!0,variant:"h3"},"Settings")))),o.a.createElement(R.a,null,this.settings.map((function(t,a){return o.a.createElement(st,{key:a,info:t,openSetting:e.openSetting.bind(e)})})))):"change password"===this.state.currentPage?o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(Qe,{user:this.state.user}))):"delete account"==this.state.currentPage?o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement($e,{user:this.state.user}))):"change username"===this.state.currentPage?o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(at,{userMD:this.state.userMD,onAlert:this.props.onAlert}))):"email"===this.state.currentPage?o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ot,{user:this.state.user,onAlert:this.props.onAlert}))):o.a.createElement("span",null,"Default"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.userMD.currentPage!==t.userMD.currentPage||t.user?t:e}}]),a}(n.Component),it=rt=Object(O.a)(rt),lt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={redirect:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=this,a=document.getElementById("email"),n=document.getElementById("password"),o=document.getElementById("passwordConfirm");console.log(a.value,n.value),n.value===o.value?h.auth().createUserWithEmailAndPassword(a.value,n.value).then((function(e){console.log(e);var a=h.firestore(),n={username:"",admin:!1,uid:e.user.uid,accountType:"athlete"};a.collection("users").doc(e.user.uid).set(n).then((function(){console.log("Set user data."),t.props.history.push("/profile")}))})).catch((function(e){console.log(e)})):alert("Passwords do not match")}},{key:"render",value:function(){return o.a.createElement(g.a,{container:!0,xs:12,id:"login",align:"center",justify:"center"},o.a.createElement(k.a,{elevation:2},o.a.createElement("br",null),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement("h1",null,"Register")),o.a.createElement("br",null),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(P.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(P.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(P.a,{id:"passwordConfirm",type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})," ",o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(A.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Submit"))))}}]),a}(n.Component),ct=lt=Object(p.g)(Object(O.a)(lt)),ut=(h.database(),Object(x.a)((function(e){return{root:{marginTop:"2.5vh",marginBottom:"2.5vh"}}}))(g.a)),mt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,o;return Object(i.a)(this,a),(o=t.call(this,e)).state=(n={open:e.open,wodInfo:e.wodInfo,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes},Object(Z.a)(n,"open",e.open),Object(Z.a)(n,"onClose",e.onClose),n),o}return Object(l.a)(a,[{key:"editWOD",value:function(){var e=this;this.props.onClose();var t=this.state.wodInfo.boxID,a=this.state.wodInfo.gymClassID,n=this.state.wodInfo.wodID,o=this.state.wodInfo.title,s=this.state.wodInfo.wodText;if(!t||!a||!n||!o||!s)return console.log("Missing edit wod info: "),void console.log(t,a,n,o,s);(function(e,t,a,n,o){var s=h.firestore(),r={title:n,wodText:o};return new Promise((function(n,o){s.collection("wods").doc(e).collection("classes").doc(t).collection("wods").doc(a).update(r).then((function(){n("Finished updating.")})).catch((function(e){o(e)}))}))})(t,a,n,o,s).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"handleValChange",value:function(e){var t=this.state.wodInfo,a=e.target,n=a.name,o=a.value;t[n]=o,this.setState({wodInfo:t})}},{key:"render",value:function(){return o.a.createElement(K.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"edit-wod-modal","aria-describedby":"edit-wod"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},o.a.createElement(g.a,{item:!0,align:"center",xs:12},o.a.createElement(k.a,{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(S.a,{variant:"h6"},"Edit Wod (",this.state.wodInfo.wodID,")"),o.a.createElement(ut,{item:!0,xs:12},o.a.createElement(P.a,{type:"text",name:"title",style:{margin:8},value:this.state.wodInfo.title,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),o.a.createElement(ut,{item:!0,xs:12},o.a.createElement(P.a,{type:"text",name:"wodText",style:{margin:8},value:this.state.wodInfo.wodText,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Workout here"},margin:"normal",color:"primary",multiline:!0,rows:5,InputLabelProps:{shrink:!0}})),o.a.createElement(ut,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{variant:"outlined",color:"primary",onClick:this.props.onClose},"Cancel")),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{variant:"outlined",color:"primary",onClick:this.editWOD.bind(this)},"Update")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),ht=mt=Object(O.a)(mt),dt=(a(97),a(351)),ft=a(357),pt=a(129),gt=a.n(pt),vt=a(48);function yt(e){var t=e.split(":"),a=Object(vt.a)(t,2),n=a[0],o=a[1];return 60*parseInt(n)+parseInt(o)}function bt(e){var t=Math.floor(e/60),a=Math.floor(e-60*t);return a<10&&(a="0".concat(a)),"".concat(t,":").concat(a)}var Et=Object(x.a)({root:{padding:"4px 0px 4px 4px"}})(I.a),xt=Object(x.a)((function(e){return{root:{margin:"8px 0px 8px 0px",padding:"4px 0px 4px 4px",backgroundColor:e.palette.primary.main,borderRadius:"8px"}}}))(g.a);var wt=Object(O.a)((function(e){var t=e.info.title,a=(e.info.scoreType,e.info.wodText,e.info.boxID),n=e.info.wodID,s=e.info.gymClassID,r=e.info.date;return o.a.createElement(xt,{container:!0,item:!0,xs:12,style:{margin:"8px 0px 8px 0px"},onClick:function(t){var o=t.target.tagName;["path","svg"].indexOf(o)>-1||e.onViewScores("/wod/".concat(a,"/").concat(s,"/").concat(n))}},o.a.createElement(g.a,{item:!0,xs:10,align:"left"},o.a.createElement(S.a,{variant:"subtitle2",component:"h2",gutterBottom:!0,style:{overflowWrap:"break-word"}},t),o.a.createElement(S.a,{variant:"caption",component:"h2",gutterBottom:!0},new Date(r).toLocaleDateString("en-US"))),o.a.createElement(g.a,{item:!0,alignItems:"center",container:!0,xs:2,align:"right",justify:"center"},e.showOwnerBtns?o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(j.a,{size:"small",color:"secondary",onClick:function(){return e.handleEdit(e.info)}},o.a.createElement(gt.a,null))),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(j.a,{size:"small",onClick:function(){return e.handleRemove(e.info)}},o.a.createElement(V.a,{color:"error"})))):o.a.createElement(o.a.Fragment,null)))}));var Dt=Object(O.a)((function(e){return o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"No Workouts!"))})),Ct=Object(x.a)({root:{overflow:"hidden"},actions:{margin:"0px"}})(dt.a),kt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={headers:e.headers,rows:e.rows,filteredRows:e.filteredRows,orderTableBy:"date",orderTable:"asc",pageNum:0,rowsPerPage:5,pageStart:0,pageEnd:5},n}return Object(l.a)(a,[{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.rows.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredRows:a})}},{key:"descendingComparator",value:function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}},{key:"getComparator",value:function(e,t){var a=this;return"desc"===e?function(e,n){return a.descendingComparator(e,n,t)}:function(e,n){return-a.descendingComparator(e,n,t)}}},{key:"stableSort",value:function(e){var t=this.state.filteredRows.map((function(e,t){return[e,t]}));return t.sort((function(t,a){var n=e(t[0],a[0]);return 0!==n?n:t[1]-a[1]})),t.map((function(e){return e[0]}))}},{key:"createSortHandler",value:function(e){var t=this.state.orderTableBy===e&&"asc"===this.state.orderTable;this.setState({orderTableBy:e,orderTable:t?"desc":"asc"})}},{key:"handleChangePage",value:function(e,t){var a=t*this.state.rowsPerPage,n=t*this.state.rowsPerPage+this.state.rowsPerPage;this.setState({pageNum:t,pageStart:a,pageEnd:n})}},{key:"handleChangeRowsPerPage",value:function(e){var t=parseInt(e.target.value);console.log(t),this.setState({pageNum:0,rowsPerPage:t,pageStart:0,pageEnd:t})}},{key:"onViewScores",value:function(e){this.props.history.push(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(k.a,{style:{margin:"16px 0px 0px 0px"},component:"form"},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search",InputProps:{startAdornment:o.a.createElement(T.a,{position:"start"},o.a.createElement(N.a,{color:"primary"}))}})),o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(L.a,{style:{margin:"8px 0px 0px 0px"}},o.a.createElement(B.a,null,o.a.createElement(U.a,null,o.a.createElement(M.a,null,this.state.headers.map((function(t,a){return o.a.createElement(Et,{key:a},t.sortable?o.a.createElement(ft.a,{active:t.id===e.state.orderTableBy,direction:t.id===e.state.orderTableBy?e.state.orderTable:"asc",onClick:function(){e.createSortHandler(t.id)}},t.label):o.a.createElement(o.a.Fragment,null,t.label))})))))),this.state.filteredRows.length>0?this.stableSort(this.getComparator(this.state.orderTable,this.state.orderTableBy)).slice(this.state.pageStart,this.state.pageEnd).map((function(t,a){return o.a.createElement(wt,{key:a,handleView:e.props.handleView,handleRemove:e.props.handleRemove,handleEdit:e.props.handleEdit,info:t,showOwnerBtns:e.props.showOwnerBtns,onViewScores:e.onViewScores.bind(e)})})):o.a.createElement(Dt,null),o.a.createElement(Ct,{rowsPerPageOptions:[5,10,25],component:g.a,count:this.state.filteredRows.length,rowsPerPage:this.state.rowsPerPage,page:this.state.pageNum,onChangePage:this.handleChangePage.bind(this),onChangeRowsPerPage:this.handleChangeRowsPerPage.bind(this)})),o.a.createElement(g.a,{item:!0,xs:12}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.rows.length>0?t:e}}]),a}(n.Component),Ot=kt=Object(p.g)(Object(O.a)(kt)),Mt=a(345),It=(h.firestore(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={filteredUsers:e.filteredUsers},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return o.a.createElement(K.a,{open:this.props.modalOpen,onClose:this.props.onModalClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"90vw",transform:"translate(-50%, -50%)"}},o.a.createElement(k.a,{style:{padding:"8px",display:"flex",flexDirection:"column",justifyContent:"center"}},o.a.createElement(g.a,{item:!0,container:!0,align:"center",xs:12},o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"16px"}},o.a.createElement(S.a,{variant:"h6"},this.props.title)),o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"16px"}},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",onChange:this.props.onChange.bind(this),placeholder:"Search Users",style:{margin:"0px 0px 8px 0px"},InputProps:{endAdornment:o.a.createElement(T.a,{position:"end"},o.a.createElement(N.a,{color:"primary"}))}})),o.a.createElement(g.a,{item:!0,xs:12,style:{marginTop:"16px"}},o.a.createElement(Mt.a,{native:!0,style:{width:"100%",margin:"0px 0px 8px 0px",padding:"4px"},color:"primary",onChange:this.props.onSelectChange.bind(this)},this.state.filteredUsers?this.state.filteredUsers.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.username)})):o.a.createElement("option",{"aria-label":"None",value:""},"No users!"))),o.a.createElement(g.a,{item:!0,xs:6,style:{margin:"16px 0px 16px 0px"}},o.a.createElement(A.a,{fullWidth:!0,style:{borderColor:this.props.theme.palette.text.primary},size:"small",onClick:this.props.onModalClose},"Cancel")),o.a.createElement(g.a,{item:!0,xs:6,style:{marginTop:"16px"}},o.a.createElement(A.a,{fullWidth:!0,color:"primary",size:"small",onClick:this.props.sendInvite.bind(this)},"Invite"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),St=It=Object(O.a)(It),jt=h.firestore(),At=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,gymClassMD:e.gymClassMD,allUsers:[],filteredUsers:[],selectedUser:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.listener=jt.collection("users").onSnapshot((function(t){var a=[];t.empty?e.setState({allUsers:a,filteredUsers:a,selectedUser:{}}):(t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.username>t.username?1:-1})),e.setState({allUsers:a,filteredUsers:a,selectedUser:a[0]}))}))}},{key:"componentWillUnmount",value:function(){this.listener&&this.listener()}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.allUsers.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredUsers:a,selectedUser:a[0]})}},{key:"sendInvite",value:function(){var e=this;this.state.selectedUser&&(console.log("Send invite to ".concat(this.state.selectedUser.uid," from ").concat(this.state.userMD.uid)),this.props.onModalClose(),console.log("Sending data",this.state.selectedUser.uid,this.state.gymClassMD,this.state.userMD.uid,this.state.userMD.username),q(this.state.selectedUser.uid,this.state.gymClassMD,this.state.userMD.uid,this.state.userMD.username).then((function(t){e.props.onAlert({type:"success",message:String(t)})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})})))}},{key:"onSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.setState({selectedUser:t})}},{key:"render",value:function(){return o.a.createElement(St,Object(Z.a)({modalOpen:this.state.open,title:"Invite Admin",onChange:this.onChange.bind(this),onSelectChange:this.onSelectChange.bind(this),onModalClose:this.props.onModalClose,sendInvite:this.sendInvite.bind(this),filteredUsers:this.state.filteredUsers},"modalOpen",this.props.modalOpen))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Pt=At=Object(O.a)(At),Tt=h.firestore(),Lt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,gymClassMD:e.gymClassMD,allUsers:[],filteredUsers:[],selectedUser:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;Tt.collection("users").onSnapshot((function(t){var a=[];t.empty?e.setState({allUsers:a,filteredUsers:a,selectedUser:{}}):(t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.username>t.username?1:-1})),e.setState({allUsers:a,filteredUsers:a,selectedUser:a[0]}))}))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allUsers.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredUsers:a,selectedUser:a[0]})}},{key:"sendInvite",value:function(){var e=this;if(this.state.selectedUser){this.state.gymClassMD.gymClassID,this.state.userMD.uid,this.state.userMD.username,this.state.gymClassMD.title,this.state.gymClassMD.boxTitle,this.state.gymClassMD.boxID,this.state.selectedUser.uid,Date.now();this.props.onModalClose(),console.log("Send invite to ".concat(this.state.selectedUser.uid," from ").concat(this.state.userMD.uid)),re(this.state.selectedUser.uid,this.state.gymClassMD,this.state.userMD.uid,this.state.userMD.username).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}}},{key:"onSelectChange",value:function(e){var t=JSON.parse(e.target.value);console.log(t),this.setState({selectedUser:t})}},{key:"render",value:function(){return o.a.createElement(St,Object(Z.a)({modalOpen:this.state.open,title:"Invite Member",onChange:this.onChange.bind(this),onSelectChange:this.onSelectChange.bind(this),onModalClose:this.props.onModalClose,sendInvite:this.sendInvite.bind(this),filteredUsers:this.state.filteredUsers},"modalOpen",this.props.modalOpen))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Bt=Lt=Object(O.a)(Lt);h.firestore();var Ut=Object(O.a)((function(e){return console.log(e),o.a.createElement(M.a,null,o.a.createElement(I.a,{align:"left"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},e.info.username)),o.a.createElement(I.a,{align:"right"},e.isOwner?o.a.createElement(A.a,{onClick:function(){e.handleRemoveAdmin(e.info)}},o.a.createElement(V.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))}));var Rt=Object(O.a)((function(e){return o.a.createElement(M.a,null,o.a.createElement(I.a,{colSpan:3,align:"center"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"No Admins!")))})),Ft=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassID:e.gymClassID,isOwner:e.isOwner,filteredAdmins:e.filteredAdmins,admins:e.admins,showRemoveAlert:!1,removeClassAdmin:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.admins.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredAdmins:a})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveAdmin",value:function(e){console.log("remove admin w/ data: ",e),this.setState({removeClassAdmin:e,showRemoveAlert:!0})}},{key:"onRemoveAdmin",value:function(){var e=this;this.setState({showRemoveAlert:!1}),console.log(this.state.removeClassAdmin),$(this.state.removeClassAdmin).then((function(t){e.props.onAlert({type:"success",message:"Removed admin!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(k.a,{elevation:2,component:"form"},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",inputProps:{style:{fontSize:"0.8em"}},onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Admins",InputProps:{startAdornment:o.a.createElement(T.a,{position:"start"},o.a.createElement(N.a,{color:"primary"}))}}),o.a.createElement(L.a,null,o.a.createElement(B.a,{stickyHeader:!0,size:"small"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Admin Username"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.filteredAdmins.length>0?this.state.filteredAdmins.map((function(t,a){return o.a.createElement(Ut,{key:a,info:t,handleRemoveAdmin:e.handleRemoveAdmin.bind(e),isOwner:e.props.isOwner})})):o.a.createElement(Rt,null))))))),o.a.createElement(J,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.onRemoveAdmin.bind(this),modalText:"Remove admin: ".concat(this.state.removeClassAdmin.username,"?"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.admins.length>0?t:e}}]),a}(n.Component),Nt=Ft=Object(O.a)(Ft);h.firestore();var Wt=Object(O.a)((function(e){return o.a.createElement(M.a,null,o.a.createElement(I.a,{align:"left"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},e.info.username)),o.a.createElement(I.a,{align:"right"},e.isOwner?o.a.createElement(A.a,{onClick:function(){e.handleRemoveMember(e.info)}},o.a.createElement(V.a,{color:"error"})):o.a.createElement(o.a.Fragment,null)))}));var Vt=Object(O.a)((function(e){return o.a.createElement(M.a,null,o.a.createElement(I.a,{colSpan:3,align:"center"},o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"No Members!")))})),Gt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassID:e.gymClassID,isOwner:e.isOwner,filteredMembers:e.filteredMembers,members:e.members,showRemoveAlert:!1,classMember:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.members.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredMembers:a})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveMember",value:function(e){this.setState({classMember:e,showRemoveAlert:!0})}},{key:"onRemoveMember",value:function(){var e=this;this.setState({showRemoveAlert:!1}),console.log("Remvoing"),console.log(this.state.classMember),ce(this.state.classMember).then((function(t){e.props.onAlert({type:"success",message:"Removed member!"})})).catch((function(t){e.props.onAlert({type:"error",message:t})}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(k.a,{elevation:2,component:"form"},o.a.createElement(P.a,{fullWidth:!0,variant:"outlined",inputProps:{style:{fontSize:"0.8em"}},onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Members",InputProps:{startAdornment:o.a.createElement(T.a,{position:"start"},o.a.createElement(N.a,{color:"primary"}))}}),o.a.createElement(L.a,null,o.a.createElement(B.a,{stickyHeader:!0,size:"small"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Member Username"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.filteredMembers.length>0?this.state.filteredMembers.map((function(t,a){return o.a.createElement(Wt,{key:a,info:t,handleRemoveMember:e.handleRemoveMember.bind(e),isOwner:e.props.isOwner})})):o.a.createElement(Vt,null))))))),o.a.createElement(J,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.onRemoveMember.bind(this),modalText:"Remove member, ".concat(this.state.classMember.username,"?"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.members.length>0?t:e}}]),a}(n.Component),zt=Gt=Object(O.a)(Gt),Kt=(h.firestore(),["reps","rounds","time","total"]),Ht=Object(x.a)({root:{borderBottom:"none"}})(I.a),Jt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassMD:e.gymClassMD,titleForm:"",scoreTypeForm:Kt[0],wodTextForm:""},n}return Object(l.a)(a,[{key:"onTitleChange",value:function(e){console.log(e.target.value);var t=e.target.value;this.setState({titleForm:t})}},{key:"onScoreTypeSelectChange",value:function(e){console.log(e.target.value);var t=e.target.value;this.setState({scoreTypeForm:t})}},{key:"onWodTextChange",value:function(e){var t=e.target.value;this.setState({wodTextForm:t})}},{key:"createWOD",value:function(){var e=this,t=this.state.gymClassMD.boxID,a=this.state.gymClassMD.owner,n=this.state.gymClassMD.boxTitle,o=this.state.gymClassMD.gymClassID,s=this.state.gymClassMD.title,r=this.state.gymClassMD.isPrivate,i=this.state.titleForm,l=this.state.scoreTypeForm,c=this.state.wodTextForm;if(console.log("Creating Wod"),console.log(t,o,i,l,c),!t||!o||!i||!l||!c||!a)return console.log("Error with input createWod"),void console.log(t,o,i,l,c,a);ae(i,t,o,a,n,s,l,c,r).then((function(t){e.props.onAlert({type:"success",message:"Added workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(L.a,null,o.a.createElement(B.a,null,o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(Ht,{colSpan:2,align:"center"},"Add Workout"))),o.a.createElement(R.a,null,o.a.createElement(M.a,null,o.a.createElement(Ht,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Score Type")),o.a.createElement(Ht,null,o.a.createElement(Mt.a,{native:!0,style:{width:"100%"},onChange:this.onScoreTypeSelectChange.bind(this),inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},Kt.map((function(e,t){return o.a.createElement("option",{key:t,value:e},e.replace(e[0],e[0].toUpperCase()))}))))),o.a.createElement(M.a,null,o.a.createElement(Ht,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Title")),o.a.createElement(Ht,null,o.a.createElement(P.a,{id:"ownerBoxAddWodTitle",type:"text",onChange:this.onTitleChange.bind(this),style:{width:"100%"},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),o.a.createElement(M.a,null,o.a.createElement(Ht,{colSpan:2,align:"center"},o.a.createElement(S.a,{color:"primary",variant:"caption"},"Workout"))),o.a.createElement(M.a,null,o.a.createElement(Ht,{colSpan:2},o.a.createElement(P.a,{id:"wodText",type:"text",style:{width:"100%"},onChange:this.onWodTextChange.bind(this),inputProps:{title:"Enter workout",placeholder:"workout"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0},multiline:!0,rows:12}))),o.a.createElement(M.a,null,o.a.createElement(Ht,{colSpan:2,align:"center"},o.a.createElement(A.a,{variant:"outlined",color:"primary",size:"small",onClick:this.createWOD.bind(this)},"Submit")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Zt=Jt=Object(O.a)(Jt);function Yt(e){return e&&0===Object.keys(e).length&&e.constructor===Object}var _t=h.firestore(),qt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,boxID:e.boxID,gymClassID:e.gymClassID,gymClassMD:{},gymClasses:[],userBoxes:[],hasBoxes:!1,wods:[],currentWodID:"",currentWodMD:{},showRemoveAlert:!1,showEditModal:!1,editWodInfo:{},curRemovewodInfo:{},inviteModalOpen:!1,inviteMemberModalOpen:!1,admins:[],adminUids:[],members:[],memberUids:[],showAdminList:!1,showMemberList:!1,isAdmin:!1,isMember:!1,showAddWod:!1},n}return Object(l.a)(a,[{key:"getGymClassListener",value:function(){var e=this;this.gymClassListener||(this.gymClassListener=_t.collection("gymClasses").doc(this.state.boxID).collection("classes").doc(this.state.gymClassID).onSnapshot((function(t){if(t.exists){var a=t.data();e.setState({gymClassMD:a}),e.getWodListener(a)}})))}},{key:"getUserBoxListener",value:function(){var e=this;this.state.userMD.uid&&!this.userBoxesListener&&(this.userBoxesListener=_t.collection("boxes").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a=[];t.empty||t.forEach((function(e){a.push(e.data())})),e.setState({userBoxes:a,hasBoxes:!!a.length})})))}},{key:"getAdminListener",value:function(){var e,t,a=this;this.state.userMD.uid&&!this.adminListener&&(this.adminListener=(e=this.state.boxID,t=this.state.gymClassID,_.collection("classAdmins").doc(e).collection("classes").doc(t).collection("admins")).onSnapshot((function(e){var t=[],n=[];if(e.empty)a.setState({admins:t,adminUids:n,isAdmin:!1});else{e.docs.forEach((function(e){t.push(e.data()),n.push(e.data().uid)}));var o=n.indexOf(a.state.userMD.uid)>=0;a.setState({admins:t,adminUids:n,isAdmin:o})}}),(function(e){console.log(e)})))}},{key:"getMemberListener",value:function(){var e,t,a=this;this.state.userMD.uid&&!this.memberListener&&(this.memberListener=(e=this.state.boxID,t=this.state.gymClassID,se.collection("classMembers").doc(e).collection("classes").doc(t).collection("members")).onSnapshot((function(e){var t=[],n=[];if(e.empty)a.setState({members:t,memberUids:n,isMember:!1});else{e.docs.forEach((function(e){t.push(e.data()),n.push(e.data().uid)}));var o=n.indexOf(a.state.userMD.uid)>=0;a.setState({members:t,memberUids:n,isMember:o})}}),(function(e){console.log(e)})))}},{key:"getWodListener",value:function(e){var t=this;this.wodListener||(this.wodListener=function(e,t){return ee.collection("wods").doc(e).collection("classes").doc(t.gymClassID).collection("wods").where("isPrivate","==",t.isPrivate).where("owner","==",t.owner)}(this.props.boxID,e).onSnapshot((function(e){if(e.empty)t.setState({wods:[]});else{var a=[];e.forEach((function(e){a.push(e.data())})),t.setState({wods:a})}}),(function(e){console.log(e),t.wodListener(),t.wodListener=void 0})))}},{key:"checkListeners",value:function(){this.userBoxesListener||this.getUserBoxListener(),this.adminListener||this.getAdminListener(),this.memberListener||this.getMemberListener()}},{key:"componentDidMount",value:function(){this.checkListeners(),this.getGymClassListener()}},{key:"componentDidUpdate",value:function(){this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.adminListener&&this.adminListener(),this.memberListener&&this.memberListener(),this.userBoxesListener&&this.userBoxesListener(),this.wodListener&&this.wodListener(),this.gymClassListener&&this.gymClassListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveWod",value:function(e){this.setState({showRemoveAlert:!0,curRemovewodInfo:e})}},{key:"deleteWod",value:function(){var e=this;this.setState({showRemoveAlert:!1}),oe(this.state.curRemovewodInfo).then((function(t){e.props.onAlert({type:"success",message:"Deleted workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.wods.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredWods:a})}},{key:"handleEdit",value:function(e){this.userBoxesListener||this.getUserBoxListener(),this.setState({editWodInfo:e,showEditModal:!0})}},{key:"handleEditModalClose",value:function(){this.setState({showEditModal:!1})}},{key:"isOwner",value:function(){return this.state.gymClassMD.uid===this.state.userMD.uid}},{key:"openAdminInvite",value:function(){this.setState({inviteModalOpen:!0})}},{key:"openMemberInvite",value:function(){this.setState({inviteMemberModalOpen:!0})}},{key:"onInviteModalClose",value:function(){this.setState({inviteModalOpen:!1})}},{key:"onInviteMemberModalClose",value:function(){this.setState({inviteMemberModalOpen:!1})}},{key:"openViewAdmins",value:function(){this.setState({showAdminList:!0})}},{key:"openViewMembers",value:function(){this.setState({showMemberList:!0})}},{key:"closeDetailView",value:function(){this.setState({showAdminList:!1,showMemberList:!1,showAddWod:!1})}},{key:"isAdmin",value:function(){return(this.state.isAdmin||this.isOwner())&&this.state.userMD}},{key:"isMember",value:function(){return(this.state.isMember||this.isAdmin())&&this.state.userMD}},{key:"isOnlyMember",value:function(){return this.state.isMember&&this.state.userMD&&!this.isAdmin()}},{key:"toggleShowAddWod",value:function(){this.setState({showAddWod:!0})}},{key:"render",value:function(){var e=this.isOnlyMember()?12:6;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(o.a.Fragment,null,Yt(this.state.userMD)||Yt(this.state.gymClassMD)?o.a.createElement(o.a.Fragment,null,"Loading"):this.state.gymClassMD.isPrivate&&!this.isMember()?o.a.createElement(g.a,{item:!0,xs:12,container:!0},o.a.createElement(g.a,{item:!0,xs:12,align:"left"},o.a.createElement(ke,null)),o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,{variant:"h5"},"This is a Private Class")))):this.state.showAdminList&&this.isAdmin()?o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(Nt,{gymClassID:this.state.gymClassID,filteredAdmins:this.state.admins,admins:this.state.admins,isOwner:this.isAdmin(),onAlert:this.props.onAlert}))):this.state.showMemberList&&this.isMember()?o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(zt,{gymClassID:this.state.gymClassID,filteredMembers:this.state.members,members:this.state.members,isOwner:this.isAdmin(),onAlert:this.props.onAlert}))):this.state.showAddWod?o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(j.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},o.a.createElement(De.a,null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(Zt,{gymClassMD:this.state.gymClassMD,onAlert:this.props.onAlert}))):o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ke,null),o.a.createElement(g.a,{item:!0,align:"center",xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,{align:"center",variant:"h3"},this.state.gymClassMD.title),o.a.createElement(S.a,{align:"center",variant:"h6"},this.state.gymClassMD.boxTitle))),o.a.createElement(g.a,{item:!0,container:!0,spacing:1,xs:12,style:{marginTop:"16px"}},this.isAdmin()&&this.state.gymClassMD.isPrivate?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{color:"primary",variant:"outlined",style:{width:"100%"},onClick:this.openAdminInvite.bind(this)},"Invite Admin")),o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{color:"primary",variant:"outlined",style:{width:"100%"},onClick:this.openViewAdmins.bind(this)},"View Admins")),o.a.createElement(Pt,{userMD:this.state.userMD,gymClassMD:this.state.gymClassMD,onModalClose:this.onInviteModalClose.bind(this),modalOpen:this.state.inviteModalOpen,onAlert:this.props.onAlert})):o.a.createElement(o.a.Fragment,null),this.isMember()&&this.state.gymClassMD.isPrivate?o.a.createElement(o.a.Fragment,null,this.isOnlyMember()?o.a.createElement(o.a.Fragment,null):o.a.createElement(g.a,{item:!0,xs:6},o.a.createElement(A.a,{color:"secondary",variant:"outlined",style:{width:"100%"},onClick:this.openMemberInvite.bind(this)},"Invite Member")),o.a.createElement(g.a,{item:!0,xs:e},o.a.createElement(A.a,{color:"secondary",variant:"outlined",style:{width:"100%"},onClick:this.openViewMembers.bind(this)},"View Members")),o.a.createElement(Bt,{userMD:this.state.userMD,gymClassMD:this.state.gymClassMD,onModalClose:this.onInviteMemberModalClose.bind(this),modalOpen:this.state.inviteMemberModalOpen,onAlert:this.props.onAlert})):o.a.createElement(o.a.Fragment,null),this.isAdmin()&&this.state.gymClassMD?o.a.createElement(A.a,{color:"primary",variant:"outlined",fullWidth:!0,onClick:this.toggleShowAddWod.bind(this)},"Add Workout"):o.a.createElement(o.a.Fragment,null)),o.a.createElement(k.a,{elevation:6,style:{padding:"8px"}},o.a.createElement(Ot,{rows:this.state.wods,filteredRows:this.state.wods,headers:(this.isOwner(),[{id:"date",sortable:!0,label:"Date"},{id:"title",sortable:!0,label:"Title"},{id:"title2",sortable:!0,label:""},{id:"btns",sortable:!1,label:""}]),handleRemove:this.handleRemoveWod.bind(this),handleEdit:this.handleEdit.bind(this),showOwnerBtns:this.isAdmin()})),o.a.createElement(J,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteWod.bind(this),modalText:"Remove ".concat(this.state.curRemovewodInfo.title,"?"),actionText:"Delete",cancelText:"Cancel"}),o.a.createElement(ht,{open:this.state.showEditModal,onClose:this.handleEditModalClose.bind(this),userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,wodInfo:this.state.editWodInfo,onAlert:this.props.onAlert}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.userMD?t:e}}]),a}(n.Component),Qt=qt=Object(O.a)(qt),Xt=a(69),$t=a(70),ea=a(62),ta=a(113),aa=a.n(ta),na=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:e.stats},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.createChart()}},{key:"createChart",value:function(){var e=this;this.ctx=document.getElementById("lineChart");var t=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);t.addColorStop(0,"#01d3fe"),t.addColorStop(1,"#0890fd"),this.lineChart&&this.lineChart.destroy(),this.lineChart=new aa.a(this.ctx,{type:"line",data:{label:"Scores",datasets:[{label:"Score",barPercentage:.5,barThickness:6,maxBarThickness:8,minBarLength:2,backgroundColor:t,data:this.state.data}]},options:{scales:{yAxes:[{ticks:{callback:function(t,a,n){return"time"===e.state.scoreType?bt(t):"reps"===e.state.scoreType?t:void 0}}}]},tooltips:{callbacks:{title:function(e,t){},label:function(t,a){var n=a.datasets[t.datasetIndex].label||"";return n&&(n+=": "),"time"===e.state.scoreType?n+=bt(t.yLabel):"reps"===e.state.scoreType&&(n+=t.yLabel),n}}},maintainAspectRatio:!1},plugins:[{beforeInit:function(e){e.data.datasets[0].data}}]})}},{key:"componentDidUpdate",value:function(){this.createChart()}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement("div",{style:{width:"92vw",padding:"8px"}},o.a.createElement("canvas",{id:"lineChart"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),oa=na=Object(O.a)(na),sa=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.createChart(this.binData(this.state.values))}},{key:"componentDidUpdate",value:function(){console.log(this.state),this.createChart(this.binData(this.state.values))}},{key:"createChart",value:function(e){var t=Object(vt.a)(e,2),a=t[0],n=t[1];this.ctx=document.getElementById("barChart");var o=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);o.addColorStop(0,"#01d3fe"),o.addColorStop(1,"#0890fd"),this.barChart&&this.barChart.destroy(),this.barChart=new aa.a(this.ctx,{type:"bar",data:{labels:a,datasets:[{label:"Scores (Standard Deviation)",minBarLength:1,backgroundColor:o,data:n}]},options:{maintainAspectRatio:!1}}),this.barChart.update()}},{key:"format",value:function(e){return"time"===this.state.scoreType?e<=0?0:bt(e):"reps"===this.state.scoreType?parseFloat(e):void 0}},{key:"createLabels",value:function(e,t){for(var a=[],n=0;n<3;n++){var o="".concat(this.format(e-t*(n+1))," - ").concat(this.format(e-t*n)),s="".concat(this.format(e+t*n)," - ").concat(this.format(e+t*(n+1)));a.unshift(o),a.push(s)}return a}},{key:"binData",value:function(e){var t,a=Object(ea.standardDeviation)(e),n=Object(ea.mean)(e),o=this.createLabels(n,a),s=[0,0,0,0,0,0],r=Object(Ue.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value-n,l=Math.floor(i/a);Math.abs(l)<=1?i>0?s[3]++:s[2]++:Math.abs(l)<=2?i>0?s[4]++:s[1]++:i>0?s[5]++:s[0]++}}catch(c){r.e(c)}finally{r.f()}return[o,s]}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement("div",{style:{width:"92vw",padding:"8px"}},o.a.createElement("canvas",{id:"barChart"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return console.log(e),console.log(t),e}}]),a}(n.Component)),ra=sa=Object(O.a)(sa);function ia(e){return console.log(e),{min:Math.min.apply(Math,Object($t.a)(e)),max:Math.max.apply(Math,Object($t.a)(e)),mean:Object(ea.mean)(e),median:Object(ea.median)(e),sd:Object(ea.standardDeviation)(e)}}var la=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,graphData:[],rawScores:[],scoreType:"",stats:{}},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,container:!0,align:"center",spacing:1,xs:12},o.a.createElement(g.a,{item:!0,xs:4},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,null,"Low: ","time"===this.state.scoreType?bt(this.state.stats.min):this.state.stats.min))),o.a.createElement(g.a,{item:!0,xs:4},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,null,"High: ","time"===this.state.scoreType?bt(this.state.stats.max):this.state.stats.max))),o.a.createElement(g.a,{item:!0,xs:4},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,null,"Avg: ","time"===this.state.scoreType?bt(this.state.stats.mean):this.state.stats.mean)))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(oa,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ra,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=function(e){for(var t=[],a="",n=e.map((function(e){return a=e.scoreType,"time"===e.scoreType?yt(e.score):parseFloat(e.score)})),o=0;o<n.length;o++)t.push({x:o,y:n[o],c:0});return[t,n,a,ia(n)]}(e.scores),n=Object(vt.a)(a,4),o=n[0],s=n[1],r=n[2],i=n[3];return Object(Y.a)(Object(Y.a)({},e),{},{graphData:o,rawScores:s,scoreType:r,stats:i})}}]),a}(n.Component),ca=la=Object(O.a)(la),ua=a(326),ma=a(327),ha=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(L.a,{component:k.a},o.a.createElement(B.a,{"aria-label":"score table"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Username"),o.a.createElement(I.a,null,"Score"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.scores.map((function(t,a){var n=e.state.uid==t.uid;return o.a.createElement(fa,{key:a,info:t,onRemove:e.props.onRemove,isUserScore:n})}))))):o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ua.a,{variant:"outlined",color:"primary"},o.a.createElement(ma.a,null,o.a.createElement(S.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),da=ha=Object(O.a)(ha);var fa=Object(O.a)((function(e){var t=e.info.score,a=e.info.username;return e.info.wodID,e.info.uid,e.info.scoreID,e.isUserScore,o.a.createElement(M.a,{selected:e.isUserScore},o.a.createElement(I.a,null,a),o.a.createElement(I.a,null,t),e.isUserScore?o.a.createElement(I.a,{align:"right"},o.a.createElement(A.a,{size:"small",onClick:function(){return e.onRemove(e.info)}},o.a.createElement(V.a,{color:"error"}))):o.a.createElement(I.a,null))})),pa=a(25),ga=a.n(pa),va=a(358),ya=a(329),ba=a(330),Ea=Object(x.a)({root:{borderBottom:"none"}})(I.a),xa=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,wodMD:e.wodMD},n}return Object(l.a)(a,[{key:"objListToArray",value:function(e){return Array.from(Object.entries(e),(function(e){return new Map(Object.entries(e[1]))}))}},{key:"isNumInSane",value:function(e){return-1===e.search(/\D/)}},{key:"handleAddScore",value:function(){if(this.state.userMD){var e="";if("time"===this.state.wodMD.scoreType){var t=document.getElementById("scoreViewUserScoreMins").value,a=document.getElementById("scoreViewUserScoreSecs").value;if(!this.isNumInSane(t)||!this.isNumInSane(a))return void alert("Time must only contain numbers, entered: ".concat(t,":").concat(a));if(parseInt(a)>59)return void alert("Seconds must be 59 or below, entered: ".concat(a));if(parseInt(a)<10&&1===a.length&&(a="0".concat(a)),isNaN(parseInt(a))||isNaN(parseInt(t)))return void alert("Missing field, entered: ".concat(t,":").concat(a));if(t.length>2)return void alert("Minutes must be 99 or below, entered: ".concat(t));0===t.length&&(t="0"),0===a.length&&(a="0"),e="".concat(t,":").concat(a)}else{if((e=document.getElementById("scoreViewUserScore").value).length>3)return void alert("Score must be 3 digits or less, entered: ".concat(e));if(!e)return void alert("Must enter score.");if(!this.isNumInSane(e))return void alert("Score must be digits only, entered: ".concat(e))}var n=this.state.userMD.username,o=this.state.userMD.uid,s=this.state.wodMD.wodID,r=this.state.wodMD.owner,i=this.state.wodMD.gymClassID,l=this.state.wodMD.boxID,c=this.state.wodMD.title,u=this.state.wodMD.scoreType;c&&l&&i&&s&&r&&o&&n&&e&&u||(console.log("Score info not found: "),console.log(c,l,i,s,r,o,n,e,u)),He(c,l,i,s,r,o,n,e,u).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}}},{key:"render",value:function(){var e,t,a;return o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},o.a.createElement(va.a,null,o.a.createElement(ya.a,{style:{background:this.props.theme.palette.primary.mainGrad},expandIcon:o.a.createElement(ga.a,null),"aria-label":"Expand","aria-controls":"additional-actions2-content",id:"additional-actions2-header"},o.a.createElement(S.a,null,"Add Score")),o.a.createElement(ba.a,null,o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,null,this.state.wodMD.scoreType.replace(this.state.wodMD.scoreType[0],this.state.wodMD.scoreType[0].toUpperCase()))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(L.a,null,o.a.createElement(B.a,null,o.a.createElement(R.a,null,o.a.createElement(M.a,null,"time"===this.state.wodMD.scoreType?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ea,{align:"center"},o.a.createElement(P.a,(e={id:"scoreViewUserScoreMins",type:"number",style:{margin:8},pattern:"[0-9]{3}",inputProps:{title:"Numbers only, max length 3",placeholder:"Minutes"}},Object(Z.a)(e,"style",{width:"100%"}),Object(Z.a)(e,"margin","normal"),Object(Z.a)(e,"color","primary"),Object(Z.a)(e,"InputLabelProps",{shrink:!0}),e))),o.a.createElement(Ea,{align:"center"},o.a.createElement(P.a,(t={id:"scoreViewUserScoreSecs",type:"number",style:{margin:8},pattern:"[0-9]{2}",inputProps:{title:"Numbers only, max length 2",placeholder:"Seconds"}},Object(Z.a)(t,"style",{width:"100%"}),Object(Z.a)(t,"margin","normal"),Object(Z.a)(t,"color","primary"),Object(Z.a)(t,"InputLabelProps",{shrink:!0}),t)))):o.a.createElement(Ea,{align:"center",colSpan:2},o.a.createElement(P.a,(a={id:"scoreViewUserScore",type:"number",style:{margin:8},pattern:"[0-9]{4}",inputProps:{title:"Numbers only, max length 4",placeholder:"Score"},margin:"normal"},Object(Z.a)(a,"style",{width:"100%"}),Object(Z.a)(a,"color","primary"),Object(Z.a)(a,"InputLabelProps",{shrink:!0}),a)))),o.a.createElement(M.a,null,o.a.createElement(Ea,{colSpan:3,align:"center"},o.a.createElement(A.a,{color:"primary",style:{width:"100%"},variant:"outlined",onClick:this.handleAddScore.bind(this)},"Add")))))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),wa=xa=Object(O.a)(xa);h.database();function Da(e){var t=e.wodText.split("\n");return o.a.createElement(g.a,{item:!0,xs:12},t.map((function(e,t){return o.a.createElement(g.a,{item:!0,xs:12,key:t},o.a.createElement(S.a,null,e||o.a.createElement("br",null)))})))}Object(O.a)(Da);var Ca=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,boxID:e.boxID,gymClassID:e.gymClassID,wodID:e.wodID,wodMD:{},scores:[],userScore:{},curRemoveScore:{},showRemoveAlert:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e,t,a,n=this;h.firestore();this.wodListener=te(this.state.boxID,this.state.gymClassID,this.state.wodID).onSnapshot((function(e){n.setState({wodMD:e.data()})}),(function(e){console.log(e)})),console.log("PreTest"),this.scoreListener=(e=this.state.boxID,t=this.state.gymClassID,a=this.state.wodID,Ke.collection("scores").doc(e).collection("classes").doc(t).collection("wods").doc(a).collection("scores")).onSnapshot((function(e){if(console.log(e),console.log("Test"),e.empty)n.setState({scores:[],userScore:{}});else{var t=[],a={},o="";e.forEach((function(e){var s=e.data();t.push(s),o=s.scoreType,s.uid===n.state.uid&&(a=s)}));var s=o&&"time"===o?1:0;t.sort((function(e,t){return s?parseFloat(e.score)<parseFloat(t.score)?-1:1:parseFloat(e.score)>parseFloat(t.score)?1:-1})),n.setState({scores:t,userScore:a})}}),(function(e){console.log(e)}))}},{key:"getWodListener",value:function(){var e=this;h.firestore();this.wodListener=te(this.state.wodMD.boxID,this.state.gymClassID,this.state.wodID).onSnapshot((function(t){e.setState({wodMD:t.data()})}),(function(e){console.log(e)}))}},{key:"componentWillUnmount",value:function(){void 0!==this.scoreListener&&this.scoreListener(),void 0!==this.wodListener&&this.wodListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveScore",value:function(e){this.setState({curRemoveScore:e,showRemoveAlert:!0})}},{key:"removeScore",value:function(){var e=this,t=this.state.curRemoveScore;Yt(t)?this.props.onAlert({type:"error",message:"Invalid score"}):(this.setState({showRemoveAlert:!1}),Je(t.boxID,t.gymClassID,t.wodID,t.uid,t.scoreID).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})})))}},{key:"render",value:function(){var e=this.state.wodMD&&this.state.wodMD.date?Xt.DateTime.fromMillis(this.state.wodMD.date):{monthLong:"",day:"",year:""};return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ke,null),Object.keys(this.state.wodMD).length>0?o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,align:"center",xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,null,this.state.wodMD.boxTitle),o.a.createElement(S.a,null,this.state.wodMD.gymClassTitle),o.a.createElement(S.a,null,this.state.wodMD.title),o.a.createElement(S.a,{variant:"subtitle1",color:"primary"},"For ",this.state.wodMD.scoreType),o.a.createElement(S.a,{variant:"caption",color:"secondary"},e.monthLong," ",e.day,", ",e.year))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:6,style:{margin:"8px 0px 8px 0px",padding:"8px"}},o.a.createElement(g.a,{item:!0,xs:12,align:"center"},o.a.createElement(S.a,{variant:"subtitle2",color:"primary"},"Workout")),o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(Da,{wodText:this.state.wodMD.wodText})))),Object.keys(this.state.userMD).length>0?o.a.createElement(wa,{userMD:this.state.userMD,wodMD:this.state.wodMD}):o.a.createElement(o.a.Fragment,null),o.a.createElement(g.a,{item:!0,xs:12,margin:{marginTop:"16px"}},this.state.scores&&this.state.scores.length>0?o.a.createElement(ca,{scores:this.state.scores}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(da,{scores:this.state.scores,uid:this.state.userMD.uid,onRemove:this.handleRemoveScore.bind(this)}))),o.a.createElement(J,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.removeScore.bind(this),modalText:"Remove score: ".concat(this.state.curRemoveScore.username," (").concat(this.state.curRemoveScore.score,")?"),actionText:"Remove",cancelText:"Cancel"})):o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,null,"Wod not found!"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),ka=Ca=Object(O.a)(Ca),Oa=a(328),Ma=a(347),Ia=(a(156),a(331)),Sa=a(346),ja=a(332),Aa=(a(259),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,currentBoxID:"",showRemoveAlert:!1,curRemoveBoxID:"",curRemoveBoxTitle:""},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"handleRemoveBox",value:function(e,t){this.setState({showRemoveAlert:!0,curRemoveBoxID:e,curRemoveBoxTitle:t})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"deleteBox",value:function(){var e=this;this.handleModalClose(),console.log("removing box: ",this.state.curRemoveBoxID),ze(this.state.curRemoveBoxID).then((function(t){e.props.onAlert({type:"success",message:"Removed gym!"})})).catch((function(t){e.props.onAlert({type:"error",message:t})}))}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},this.state.userBoxes.length>0?o.a.createElement(Be,{userMD:this.state.userMD,allBoxes:this.state.userBoxes,filteredBoxes:this.state.userBoxes,handleRemoveBox:this.handleRemoveBox.bind(this),isOwner:!0,onAlert:this.props.onAlert}):o.a.createElement(g.a,{item:!0,zeroMinWidth:!0,xs:12},o.a.createElement(k.a,{elevation:4,style:{padding:"1vw"}},o.a.createElement(S.a,{noWrap:!0,align:"left"},"No gyms Found!")))),o.a.createElement(J,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteBox.bind(this),modalText:"Remove ".concat(this.state.curRemoveBoxTitle," (").concat(this.state.curRemoveBoxID,")"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return console.log(e),e}}]),a}(n.Component)),Pa=Aa=Object(O.a)(Aa),Ta=a(350),La=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(I.a)),Ba=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,title:"",box:e.userBoxes[0],isPrivate:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.createGymClass()}},{key:"createGymClass",value:function(){var e=this,t=this.state.title,a=this.state.box,n=this.state.isPrivate;if(!t||!a||null===n)return console.log("Error adding class: "),console.log(t,this.props.userMD.uid,n),void console.log(a);he(t,this.props.userMD.uid,a.boxID,a.title,n,a.uid).then((function(t){e.props.onAlert({type:"success",message:"Added class!"})})).catch((function(t){e.props.onAlert({type:"error",message:t})}))}},{key:"handleCheckboxChange",value:function(e){var t=e.target.checked;this.setState({isPrivate:t})}},{key:"onTitleChange",value:function(e){console.log(e.target.value),this.setState({title:e.target.value})}},{key:"onSelectChange",value:function(e){console.log(e.target.value),this.setState({box:JSON.parse(e.target.value)})}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(B.a,null,o.a.createElement(R.a,null,o.a.createElement(M.a,null,o.a.createElement(La,null,"Gym"),o.a.createElement(La,null,o.a.createElement(Mt.a,{native:!0,style:{width:"100%"},onChange:this.onSelectChange.bind(this),inputProps:{name:"Box",id:"addGymClassBox"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),o.a.createElement(M.a,null,o.a.createElement(La,null,"Title"),o.a.createElement(La,null,o.a.createElement(P.a,{id:"addGymClassTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",onChange:this.onTitleChange.bind(this),inputProps:{title:"Letters only, max length 35",placeholder:"Name of class"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),o.a.createElement(M.a,null,o.a.createElement(La,null,"Private"),o.a.createElement(La,null,o.a.createElement(Ta.a,{checked:this.state.isPrivate,onChange:this.handleCheckboxChange.bind(this)}))),o.a.createElement(M.a,null,o.a.createElement(La,{align:"center",colSpan:2},o.a.createElement(A.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){e.createGymClass()}},"Submit"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object(Y.a)(Object(Y.a)({},e),{},{box:e.userBoxes[0]})}}]),a}(n.Component),Ua=Ba=Object(O.a)(Ba),Ra=(h.firestore(),["reps","rounds","time","total"]),Fa=Object(x.a)({root:{borderBottom:"none"}})(I.a),Na=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,gymClasses:[],box:e.userBoxes[0],gymClass:{},titleForm:"",scoreTypeForm:Ra[0],wodTextForm:""},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){!this.gymClassListener&&this.state.userBoxes&&this.state.userBoxes.length>0&&this.setGymClassListner(this.state.userBoxes[0].boxID)}},{key:"setGymClassListner",value:function(e){var t=this;this.gymClassListener=me(e).onSnapshot((function(e){if(e.empty)t.setState({gymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data())}));var n=a[0];t.setState({gymClasses:a,gymClass:n})}}),(function(e){console.log(e)}))}},{key:"componentWillUnmount",value:function(){this.gymClassListener&&this.gymClassListener()}},{key:"onBoxSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.gymClassListener&&this.gymClassListener(),this.setGymClassListner(t.boxID),this.setState({box:t})}},{key:"onClassSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.setState({gymClass:t})}},{key:"onTitleChange",value:function(e){var t=e.target.value;this.setState({titleForm:t})}},{key:"onScoreTypeSelectChange",value:function(e){var t=e.target.value;this.setState({scoreTypeForm:t})}},{key:"onWodTextChange",value:function(e){var t=e.target.value;this.setState({wodTextForm:t})}},{key:"createWOD",value:function(){var e=this;if(this.state.box&&this.state.gymClass){var t=this.state.box.boxID,a=this.state.box.uid,n=this.state.box.title,o=this.state.gymClass.gymClassID,s=this.state.gymClass.isPrivate,r=this.state.gymClass.title,i=this.state.titleForm,l=this.state.scoreTypeForm,c=this.state.wodTextForm;if(!t||!o||!i||!l||!c||!a||!r||void 0===s)return console.log("Error with input createWod"),void console.log(t,o,i,l,c,a,r,s);ae(i,t,o,a,n,r,l,c,s).then((function(t){e.props.onAlert({type:"success",message:"Added workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(L.a,null,o.a.createElement(B.a,null,o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(Fa,null),o.a.createElement(Fa,null))),o.a.createElement(R.a,null,o.a.createElement(M.a,null,o.a.createElement(Fa,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Box")),o.a.createElement(Fa,null,o.a.createElement(Mt.a,{native:!0,style:{width:"100%"},onChange:this.onBoxSelectChange.bind(this),inputProps:{name:"Box",id:"ownerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),o.a.createElement(M.a,null,o.a.createElement(Fa,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Class")),o.a.createElement(Fa,null,o.a.createElement(Mt.a,{native:!0,style:{width:"100%"},onChange:this.onClassSelectChange.bind(this),inputProps:{name:"gymClass",id:"AddWodGymClassID"}},this.state.gymClasses.length>0?this.state.gymClasses.map((function(e,t){return o.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):o.a.createElement("option",{"aria-label":"None",value:""},"No Classes!")))),o.a.createElement(M.a,null,o.a.createElement(Fa,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Score Type")),o.a.createElement(Fa,null,o.a.createElement(Mt.a,{native:!0,style:{width:"100%"},onChange:this.onScoreTypeSelectChange.bind(this),inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},Ra.map((function(e,t){return o.a.createElement("option",{key:t,value:e},e.replace(e[0],e[0].toUpperCase()))}))))),o.a.createElement(M.a,null,o.a.createElement(Fa,null,o.a.createElement(S.a,{color:"primary",variant:"caption"},"Title")),o.a.createElement(Fa,null,o.a.createElement(P.a,{id:"ownerBoxAddWodTitle",type:"text",onChange:this.onTitleChange.bind(this),style:{width:"100%"},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),o.a.createElement(M.a,null,o.a.createElement(Fa,{colSpan:2,align:"center"},o.a.createElement(S.a,{color:"primary",variant:"caption"},"Workout"))),o.a.createElement(M.a,null,o.a.createElement(Fa,{colSpan:2},o.a.createElement(P.a,{id:"wodText",type:"text",style:{width:"100%"},onChange:this.onWodTextChange.bind(this),inputProps:{title:"Enter workout",placeholder:"workout"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0},multiline:!0,rows:12}))),o.a.createElement(M.a,null,o.a.createElement(Fa,{colSpan:2,align:"center"},o.a.createElement(A.a,{variant:"outlined",color:"primary",size:"small",onClick:this.createWOD.bind(this)},"Submit")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object(Y.a)(Object(Y.a)({},e),{},{box:e.userBoxes[0]})}}]),a}(n.Component),Wa=Na=Object(O.a)(Na),Va=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(I.a)),Ga=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){if(13==(e.keyCode||e.which)){var t=document.getElementById("ownerBoxAddBoxTitle").value;this.createBox(t)}}},{key:"createBox",value:function(e){var t=this;e&&Fe(e,this.props.userMD.uid).then((function(e){t.props.onAlert({type:"success",message:"Added gym!"})})).catch((function(e){t.props.onAlert({type:"error",message:e})}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(B.a,null,o.a.createElement(R.a,null,o.a.createElement(M.a,null,o.a.createElement(Va,null,"Title"),o.a.createElement(Va,null,o.a.createElement(P.a,{id:"ownerBoxAddBoxTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Name of gym"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),o.a.createElement(M.a,null,o.a.createElement(Va,{align:"center",colSpan:2},o.a.createElement(A.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){var t=document.getElementById("ownerBoxAddBoxTitle");e.createBox(t.value)}},"Submit"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),za=Ga=Object(O.a)(Ga),Ka=h.firestore();var Ha=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:[],hasBoxes:!1,addBoxProgress:!0,index:0,tabs:{0:"show",1:"hide",2:"hide",3:"hide"}},console.log(e),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.listenForBoxes()}},{key:"componentDidUpdate",value:function(){"owner"===this.state.userMD.accountType&&this.listenForBoxes()}},{key:"componentWillUnmount",value:function(){this.boxListener&&this.boxListener()}},{key:"listenForBoxes",value:function(){var e=this;this.state.user&&!this.boxListener&&(this.boxListener=Ka.collection("boxes").where("uid","==",this.state.user.uid).onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(e.data())})),console.log("Setting new state for userBoxes"),e.setState({hasBoxes:!0,userBoxes:a})}),(function(t){console.log(t),e.setState({hasBoxes:!1,userBoxes:[]})})))}},{key:"handleChange",value:function(e,t){console.log(t),this.state.tabs[this.state.index]="hide",this.state.tabs[t]="show",this.setState({index:t,tabs:this.state.tabs})}},{key:"handleChangeIndex",value:function(e){this.setState({index:e})}},{key:"render",value:function(){return console.log(this.state),o.a.createElement(g.a,{item:!0,xs:12,id:"ownerBox"},o.a.createElement(Ia.a,{position:"static"},o.a.createElement(Sa.a,{value:this.state.index,variant:"fullWidth",selectionFollowsFocus:!0,onChange:this.handleChange.bind(this),"aria-label":"simple tabs example"},o.a.createElement(ja.a,{label:"View Gyms"}),o.a.createElement(ja.a,{label:"Add Workout"}),o.a.createElement(ja.a,{label:"Add Class"}),o.a.createElement(ja.a,{label:"Add Gym"}))),o.a.createElement(g.a,{item:!0,xs:12,style:{minHeight:"50vh",maxHeight:"150vh",overflowY:"scroll"}},this.state.hasBoxes?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{item:!0,xs:12,className:"".concat(this.state.tabs[0]," slide-left")},o.a.createElement(Pa,{user:this.state.user,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert})),o.a.createElement(g.a,{item:!0,xs:12,className:"slide-left ".concat(this.state.tabs[1])},o.a.createElement(Wa,{isOwnerView:!0,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert})),o.a.createElement(g.a,{item:!0,xs:12,className:"slide-right ".concat(this.state.tabs[2])},o.a.createElement(Ua,{userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert}))):o.a.createElement(o.a.Fragment,null),o.a.createElement(g.a,{item:!0,xs:12,className:"slide-right ".concat(this.state.tabs[3])},o.a.createElement(za,{userMD:this.state.userMD,onAlert:this.props.onAlert}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ja=Object(O.a)(Ha),Za=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userFollows:[]},n}return Object(l.a)(a,[{key:"extractData",value:function(e){var t=[];return e.forEach((function(e){t.push(e.data())})),t}},{key:"componentDidMount",value:function(){var e=this;this.getUserFollowers=je(this.state.user.uid).onSnapshot((function(t){var a=e.extractData(t);e.setState({userFollows:a})}))}},{key:"componentWillUnmount",value:function(){this.getUserFollowers&&this.getUserFollowers()}},{key:"handleFollow",value:function(e){console.log(e),""!==e.boxID&&Ae(this.state.userMD.uid,this.state.userMD.username,e.boxID,e.title,e.owner).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){var t=this;Se(this.state.userMD.uid,e).then((function(a){if(a){var n=t.state.userFollowing;n[e]=void 0,t.setState({userFollowing:n}),console.log("Succefully unfollowed.")}})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,null,"Following")),o.a.createElement(g.a,{item:!0,xs:12},this.state.userFollows.length>0?o.a.createElement(L.a,null,o.a.createElement(B.a,null,o.a.createElement(R.a,null,this.state.userFollows.map((function(t,a){return o.a.createElement(M.a,{key:a},o.a.createElement(I.a,null,""===t.boxID?o.a.createElement(A.a,null,t.title," ",o.a.createElement(S.a,{variant:"caption",component:"span"},"\xa0(deleted)")):o.a.createElement(A.a,{to:"box/".concat(t.boxID),component:f.b},t.title)),o.a.createElement(I.a,{align:"right"},o.a.createElement(j.a,{onClick:function(){e.handleUnfollow(t.boxID)}},o.a.createElement(z.a,{color:"primary"}))))}))))):o.a.createElement(o.a.Fragment,null,"Not following anyone!"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ya=Za=Object(O.a)(Za),_a=a(333),qa=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid,showRemoveAlert:!1,removeScoreID:""},n}return Object(l.a)(a,[{key:"handleViewWod",value:function(e){console.log("Go to wodID: ".concat(e))}},{key:"handleViewBox",value:function(e){console.log("Go to boxID: ".concat(e))}},{key:"showRemoveAlert",value:function(e){this.setState({showRemoveAlert:!0,removeScoreID:e})}},{key:"onRemove",value:function(){var e=this;this.hideRemoveAlert(),Je(this.state.removeScoreID).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"hideRemoveAlert",value:function(){this.setState({showRemoveAlert:!1})}},{key:"onView",value:function(e){this.props.history.push(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.scores.length>0?o.a.createElement(L.a,{component:k.a},o.a.createElement(B.a,{"aria-label":"score table"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(I.a,null,"Title"),o.a.createElement(I.a,null,"Score"),o.a.createElement(I.a,null))),o.a.createElement(R.a,null,this.state.scores.map((function(t,a){return o.a.createElement(Xa,{key:a,info:t,onViewBox:e.handleViewBox.bind(e),onViewWod:e.handleViewWod.bind(e),onRemove:e.showRemoveAlert.bind(e),onView:e.onView.bind(e)})}))))):o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(ua.a,{variant:"outlined",color:"primary"},o.a.createElement(ma.a,null,o.a.createElement(S.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))),o.a.createElement(J,{open:this.state.showRemoveAlert,actionText:"Remove",cancelText:"Cancel",modalText:"Remove score?",onAction:this.onRemove.bind(this),onClose:this.hideRemoveAlert.bind(this)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),Qa=qa=Object(p.g)(Object(O.a)(qa));function Xa(e){var t=e.info.score,a=e.info.title,n=e.info.scoreID,s=e.info.wodID,r=e.info.gymClassID,i=e.info.boxID;return o.a.createElement(M.a,{onClick:function(t){var a=t.target.tagName;["path","svg"].indexOf(a)>-1||e.onView("wod/".concat(i,"/").concat(r,"/").concat(s))}},o.a.createElement(I.a,null,a),o.a.createElement(I.a,null,t),o.a.createElement(I.a,{align:"right"},o.a.createElement(A.a,{size:"small",onClick:function(){return e.onRemove(n)}},o.a.createElement(_a.a,{color:"error"}))))}var $a=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,scores:e.scores},n}return Object(l.a)(a,[{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:6},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,null,"Scores")),o.a.createElement(g.a,{item:!0,xs:12},this.state.user?o.a.createElement(Qa,{uid:this.state.user.uid,scores:this.state.scores,onAlert:this.props.onAlert}):o.a.createElement(o.a.Fragment,null)))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),en=$a=Object(O.a)($a),tn=a(334),an=a(335);h.firestore();var nn=Object(O.a)((function(e){var t=e.info.senderUsername,a=(e.info.adminInviteID,e.info.gymClassTitle),n=e.info.boxTitle;return o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:8},o.a.createElement(S.a,{variant:"caption"},t," wants you to be an Admin of ",a," at ",n)),o.a.createElement(g.a,{item:!0,xs:2},o.a.createElement(j.a,{size:"small",onClick:function(){e.acceptInvite(e.info)},color:"secondary"},o.a.createElement(tn.a,null))),o.a.createElement(g.a,{item:!0,xs:2},o.a.createElement(j.a,{size:"small",onClick:function(){e.removeNotification(e.info)}},o.a.createElement(an.a,{color:"error"}))))})),on=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,notifications:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.notificationsListener&&this.notificationsListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD&&!this.notificationsListener&&(this.notificationsListener=(e=this.state.userMD.uid,_.collection("userAdminNotifications").doc(e).collection("notifications")).onSnapshot((function(e){var a=[];e.empty||(e.docs.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({notifications:a})}),(function(e){console.log(e)})))}},{key:"onRemoveNotification",value:function(e){(function(e){return new Promise((function(t,a){Promise.all([_.collection("adminNotifications").doc(e.boxID).collection("classes").doc(e.gymClassID).collection("adminNotifications").doc(e.uid).delete(),_.collection("userAdminNotifications").doc(e.uid).collection("notifications").doc(e.notifyID).delete()]).then((function(){t("Removed notification.")})).catch((function(e){console.log(e),a(e)}))}))})(e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"acceptInvite",value:function(e){var t=this;console.log(e);var a=e.boxID,n=e.gymClassID,o=e.gymClassTitle,s=e.boxTitle,r=e.owner;X(this.state.userMD.uid,a,n,r,this.state.userMD.username,s,o).then((function(a){console.log(a),t.onRemoveNotification(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12},this.state.notifications.length>0?o.a.createElement(k.a,{style:{margin:"16px 0px 0px 0px "}},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,{variant:"subtitle2"},"Admin Notifications")),o.a.createElement(g.a,{item:!0,xs:12},this.state.notifications.map((function(t,a){return o.a.createElement(nn,{key:a,info:t,removeNotification:e.onRemoveNotification.bind(e),acceptInvite:e.acceptInvite.bind(e)})})))):o.a.createElement(o.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),sn=on=Object(O.a)(on);h.firestore();var rn=Object(O.a)((function(e){var t=e.info.senderUsername,a=(e.info.memberInviteID,e.info.gymClassTitle),n=e.info.boxTitle;return o.a.createElement(g.a,{container:!0,item:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:8},o.a.createElement(S.a,{variant:"caption"},t," wants you to be a Member of ",a," at ",n)),o.a.createElement(g.a,{item:!0,xs:2},o.a.createElement(j.a,{size:"small",onClick:function(){e.acceptInvite(e.info)},color:"secondary"},o.a.createElement(tn.a,null))),o.a.createElement(g.a,{item:!0,xs:2},o.a.createElement(j.a,{size:"small",onClick:function(){e.removeNotification(e.info)}},o.a.createElement(an.a,{color:"error"}))))})),ln=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,notifications:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.notificationsListener&&this.notificationsListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.notificationsListener&&(this.notificationsListener=(e=this.state.userMD.uid,se.collection("userMemberNotifications").doc(e).collection("notifications")).onSnapshot((function(e){var a=[];e.empty||(e.docs.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({notifications:a})}),(function(e){console.log(e)})))}},{key:"onRemoveNotification",value:function(e){(function(e){return new Promise((function(t,a){t("No notifications found."),Promise.all([se.collection("memberNotifications").doc(e.boxID).collection("classes").doc(e.gymClassID).collection("memberNotifications").doc(e.uid).delete(),se.collection("userMemberNotifications").doc(e.uid).collection("notifications").doc(e.notifyID).delete()]).then((function(){t("Removed notification.")})).catch((function(e){a(e)}))}))})(e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"acceptInvite",value:function(e){var t=this,a=e.gymClassID,n=e.gymClassTitle,o=e.boxTitle,s=e.boxID,r=e.owner;le(this.state.userMD.uid,s,a,r,this.state.userMD.username,o,n).then((function(a){console.log(a),t.onRemoveNotification(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},this.state.notifications.length>0?o.a.createElement(k.a,{elevation:6},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,{variant:"subtitle2"},"Member Notifications")),o.a.createElement(g.a,{item:!0,xs:12},this.state.notifications.map((function(t,a){return o.a.createElement(rn,{key:a,info:t,removeNotification:e.onRemoveNotification.bind(e),acceptInvite:e.acceptInvite.bind(e)})})))):o.a.createElement(o.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),cn=ln=Object(O.a)(ln),un=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(I.a));var mn=Object(O.a)((function(e){var t=e.info.gymClassTitle,a=e.info.boxTitle,n=e.info.boxID,s="class/".concat(n,"/").concat(e.info.gymClassID);return o.a.createElement(M.a,{onClick:function(t){return e.onView(s)}},o.a.createElement(un,null,o.a.createElement(S.a,{color:"primary"},a)),o.a.createElement(un,null,o.a.createElement(S.a,{color:"primary"},t)))})),hn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,classes:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.userClassAdminsListener&&(this.userClassAdminsListener=(e=this.state.userMD.uid,_.collection("userClassAdmins").doc(e).collection("classes")).onSnapshot((function(e){console.log(e);var a=[];e.empty||(e.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({classes:a})}),(function(e){console.log(e)})))}},{key:"componentWillUnmount",value:function(){this.userClassAdminsListener&&this.userClassAdminsListener()}},{key:"onView",value:function(e){this.props.history.push(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.classes.length>0?o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px"}},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,{variant:"subtitle1"},"Admin Roles"),o.a.createElement(B.a,{size:"small"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(un,{align:"center"},"Gym"),o.a.createElement(un,{align:"center"},"Class"))),o.a.createElement(R.a,null,this.state.classes.map((function(t,a){return o.a.createElement(mn,{key:a,info:t,onView:e.onView.bind(e)})})))))):o.a.createElement(o.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),dn=hn=Object(p.g)(Object(O.a)(hn)),fn=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(I.a));var pn=Object(O.a)((function(e){var t=e.info.gymClassTitle,a=e.info.boxTitle,n=e.info.boxID,s="class/".concat(n,"/").concat(e.info.gymClassID);return o.a.createElement(M.a,{onClick:function(t){return e.onView(s)}},o.a.createElement(fn,null,o.a.createElement(S.a,{color:"primary"},a)),o.a.createElement(fn,null,o.a.createElement(S.a,{color:"primary"},t)))})),gn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,classes:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.userClassMembersListener&&this.userClassMembersListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD&&!this.userClassMembersListener&&(console.log("Looking for members for ".concat(this.state.userMD.uid)),this.userClassMembersListener=(e=this.state.userMD.uid,se.collection("userClassMembers").doc(e).collection("classes").where("uid","==",e)).onSnapshot((function(e){console.log(e);var a=[];e.empty||(e.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({classes:a})}),(function(e){console.log(e)})))}},{key:"onView",value:function(e){this.props.history.push(e)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,this.state.classes.length>0?o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px"}},o.a.createElement(k.a,{elevation:6},o.a.createElement(S.a,{variant:"subtitle1"},"Membership"),o.a.createElement(B.a,{size:"small"},o.a.createElement(U.a,null,o.a.createElement(M.a,null,o.a.createElement(fn,{align:"center"},"Gym"),o.a.createElement(fn,{align:"center"},"Class"))),o.a.createElement(R.a,null,this.state.classes.map((function(t,a){return o.a.createElement(pn,{key:a,info:t,onView:e.onView.bind(e)})})))))):o.a.createElement(o.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),vn=gn=Object(p.g)(Object(O.a)(gn));var yn=Object(x.a)((function(e){return{root:{borderRadius:"4px",height:"5px"}}}))(k.a),bn=Object(x.a)((function(e){return{root:{background:"transparent",display:"block",borderRadius:"4px",padding:"0px 0px 0px 2px",margin:"1px auto",width:"12%",height:"6px"}}}))(we.a),En=Object(x.a)((function(e){return{root:{display:"flex"}}}))(g.a),xn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, #ff0b0b, transparent)"}}}))(yn),wn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, grey, transparent)"}}}))(yn),Dn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, #00fb42, #00fb42, ".concat(e.palette.primary.main,")")}}}))(yn),Cn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent,  white, ".concat(e.palette.primary.main,")")}}}))(yn),kn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent,  ".concat(e.palette.primary.main,", #6700c5)")}}}))(yn),On=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, white, #1118f3, #1118f3, white)"}}}))(yn),Mn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, white, #ffeb00, #ffeb00, white)"}}}))(yn);function In(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"grey",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{color:e,valid:t,isToday:a,count:1}}var Sn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(i.a)(this,a),n=t.call(this,e);var o=Xt.DateTime.now();return n.calendar=n.createCalendar(o),console.log(o),n.state={userMD:e.userMD,scores:e.scores,today:o},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){}},{key:"getFirstOfMonth",value:function(e){return Xt.DateTime.local(e.year,e.month,1,0,0,0,0)}},{key:"getEndOfMonth",value:function(e){return Xt.DateTime.local(e.year,e.month,e.daysInMonth,0,0,0,0)}},{key:"getFirstAndLast",value:function(e){return[this.getFirstOfMonth(e),this.getEndOfMonth(e)]}},{key:"createCalendar",value:function(e){for(var t,a,n=this.getFirstAndLast(e),o=Object(vt.a)(n,2),s=o[0],r=o[1],i=[],l=[],c=[],u=0;u<7;u++)l.push(In("white",!0,!1));t=[].concat(l),a=[].concat(l);for(var m=0;m<s.weekday;m++)i.push(In());for(var h=s.weekday;h<7;h++)i[h]=In("white",!0,!1);for(var d=0;d<=r.weekday;d++)c.push(In("white",!0,!1));for(var f=r.weekday+1;f<7;f++)c[f]=In();for(var p=[[].concat(i),[].concat(l),Object($t.a)(t),Object($t.a)(a),[].concat(c)],g=this.getOffsetDayOfMonthFromDate(s),v=this.getOffsetDayOfMonthFromDate(e),y=7*g[0]+g[1],b=7*v[0]+v[1],E=y;E<b;E++){var x=E%7;p[parseInt(E/7)][x]=In("red",!0,!1)}var w=b%7;return p[parseInt(b/7)][w]=In("white",!0,!0),p}},{key:"getOffsetDayOfMonthFromDate",value:function(e){var t=this.getFirstOfMonth(e).weekday+e.day-1;return[parseInt(t/7),t%7]}},{key:"fillCalendar",value:function(){var e,t=[],a=Object(Ue.a)(this.calendar);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(Object($t.a)(n))}}catch(d){a.e(d)}finally{a.f()}var o,s=Object(Ue.a)(this.state.scores);try{for(s.s();!(o=s.n()).done;){var r=o.value,i=Xt.DateTime.fromMillis(r.date),l=this.getOffsetDayOfMonthFromDate(i),c=Object(vt.a)(l,2),u=c[0],m=c[1],h=i.day===this.state.today.day&&i.month===this.state.today.month&&i.year===this.state.today.year;"green"!==t[u][m].color?t[u][m]=In("green",!0,h):t[u][m].count+=1}}catch(d){s.e(d)}finally{s.f()}return t}},{key:"render",value:function(){return o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(S.a,{gutterBottom:!0,variant:"subtitle2"},this.state.today.monthLong)),o.a.createElement(g.a,{item:!0,xs:3}),o.a.createElement(g.a,{item:!0,container:!0,xs:6},this.fillCalendar().map((function(e,t){return o.a.createElement(En,{className:"appearSlow",item:!0,xs:12,key:t},e.map((function(e,t){var a=e.isToday?"whiteBorder":"";if("green"===e.color){var n=null;return 1==e.count&&(n=kn),2==e.count&&(n=On),3==e.count&&(n=Dn),e.count>3&&(n=Mn),o.a.createElement(bn,{key:t,className:"appearFast"},o.a.createElement(n,{className:a}))}return"white"===e.color?o.a.createElement(bn,{key:t},o.a.createElement(Cn,{className:a})):"red"===e.color?o.a.createElement(bn,{key:t},o.a.createElement(xn,{className:a})):o.a.createElement(bn,{key:t},o.a.createElement(wn,{className:a}))})))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),jn=Sn=Object(O.a)(Sn),An=(h.firestore(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,emailAlertOpen:!1,scores:[]},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.cancelablePromise&&(console.log("email cancelled"),this.cancelablePromise.cancel()),this.listener&&this.listener()}},{key:"componentDidMount",value:function(){this.listenForUserScores()}},{key:"listenForUserScores",value:function(){var e,t,a,n=this;this.listener||(this.listener=(e=this.state.user.uid,t="uid",a=this.state.user.uid,Ke.collection("userScores").doc(e).collection("scores").orderBy("date","asc").where(t,"==",a)).onSnapshot((function(e){if(e.empty)n.setState({scores:[]});else{var t=[];e.forEach((function(e){t.push(e.data())})),t.sort((function(e,t){return e.date>t.date?1:-1})),n.setState({scores:t})}}),(function(e){console.log(e)})))}},{key:"render",value:function(){var e=this;return o.a.createElement(g.a,{item:!0,container:!0,align:"center"},o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(Oa.a,{in:this.state.emailAlertOpen},o.a.createElement(Ma.a,{onClose:function(){e.setState({emailAlertOpen:!1})}},"Email sent!"))),o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(k.a,{elevation:4},o.a.createElement(S.a,{gutterBottom:!0,variant:"h5"},this.state.userMD.username))),o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(k.a,{elevation:4},o.a.createElement(jn,{userMD:this.state.userMD,scores:this.state.scores}))),o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(k.a,{elevation:4})),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(g.a,{item:!0,container:!0,xs:12},o.a.createElement(sn,{userMD:this.state.userMD}),o.a.createElement(cn,{userMD:this.state.userMD}),o.a.createElement(dn,{userMD:this.state.userMD}),o.a.createElement(vn,{userMD:this.state.userMD}),o.a.createElement(g.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},o.a.createElement(k.a,{elevation:4},o.a.createElement(Ya,{user:this.state.user,userMD:this.state.userMD})))),o.a.createElement(k.a,{elevation:2,style:{margin:"16px 0px 0px 0px"}},"owner"===this.state.userMD.accountType?o.a.createElement(Ja,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert}):o.a.createElement(en,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert,scores:this.state.scores}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),Pn=Object(O.a)(An),Tn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(l.a)(a,[{key:"handleLogIn",value:function(e){this.setState({user:e})}},{key:"render",value:function(){return console.log("user",this.state.user),o.a.createElement(g.a,{item:!0,xs:12,id:"profilepage"},this.state.user?o.a.createElement(Pn,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert}):o.a.createElement(p.a,{to:"/login"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ln=Tn=Object(p.g)(Object(O.a)(Tn)),Bn=a(356),Un=a(325),Rn=a(337),Fn=a(338),Nn=a(339),Wn=a(355),Vn=a(336),Gn=Object(x.a)((function(e){return{root:{"&:hover":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(Bn.a),zn=Object(x.a)((function(e){return{root:{color:e.palette.text.primary}}}))(S.a),Kn=Object(x.a)((function(e){return{root:{border:"1px solid",borderColor:e.palette.text.primary}}}))(k.a);var Hn=Object(O.a)((function(e){return o.a.createElement(Ma.a,{severity:e.alertInfo.type,onClose:e.onCloseAlert},e.alertInfo.message)})),Jn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).menuRef=Object(n.createRef)(),o.state={user:e.user,userMD:e.userMD,open:!1,alertOpen:e.alertOpen,alertInfo:e.alertInfo},o}return Object(l.a)(a,[{key:"handleToggle",value:function(){this.setState({open:!this.state.open})}},{key:"handleClose",value:function(e){console.log("Should close"),this.setState({open:!1})}},{key:"handleListKeyDown",value:function(e){"Tab"===e.key&&(e.preventDefault(),this.setState({open:!1}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return o.a.createElement(Ia.a,{position:"sticky",ref:this.menuRef,style:{background:this.props.theme.palette.background.toolbar}},o.a.createElement(Un.a,{disableGutters:!1},o.a.createElement(zn,{variant:"h3"},"WodTrackrr"),o.a.createElement("section",{style:{marginLeft:"auto",marginRight:-12}},o.a.createElement(j.a,{color:"primary",onClick:this.handleToggle.bind(this)},o.a.createElement(Vn.a,null)),o.a.createElement(Rn.a,{open:this.state.open,anchorEl:this.menuRef.current,placement:"bottom-end",transition:!0,disablePortal:!0,className:t.popper},(function(t){var a=t.TransitionProps,n=t.placement;return o.a.createElement(Fn.a,Object.assign({},a,{style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),o.a.createElement(Kn,null,o.a.createElement(Nn.a,{onClickAway:e.handleClose.bind(e)},o.a.createElement(Wn.a,{id:"menu-list-grow",onKeyDown:e.handleListKeyDown.bind(e)},o.a.createElement(Gn,{onClick:e.props.changeTheme},"Change Theme"),o.a.createElement(Gn,{onClick:e.handleClose.bind(e),component:f.b,to:"/settings/"},"Settings"),e.state.user?o.a.createElement(Gn,{onClick:function(t){e.handleClose.bind(e)(t),e.props.handleLogout()}},"Logout"):o.a.createElement(Gn,{component:f.b,to:"/login",onClick:e.handleClose.bind(e)},"Login")))))})))),o.a.createElement(Oa.a,{in:this.props.alertOpen},this.state.alertInfo?o.a.createElement(Hn,{alertInfo:this.state.alertInfo,onCloseAlert:this.props.onCloseAlert}):o.a.createElement(o.a.Fragment,null)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Zn=Object(x.a)((function(e){return{popper:{zIndex:100}}}),{withTheme:!0})(Jn),Yn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=document.getElementById("email"),n=document.getElementById("password");document.getElementById("passwordConfirm");console.log(a.value,n),h.auth().signInWithEmailAndPassword(a.value,n.value).then((function(e){t.props.onLogin(e.user),t.props.history.push("/boxSearch")})).catch((function(e){t.props.onAlert({type:"warning",message:e.message})}))}},{key:"render",value:function(){return o.a.createElement(g.a,{container:!0,id:"login",align:"center",justify:"center"},o.a.createElement("br",null),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:2},o.a.createElement(S.a,{variant:"h4"},"Login"),o.a.createElement("br",null),o.a.createElement(P.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(P.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),o.a.createElement("br",null),o.a.createElement("br",null))),o.a.createElement(g.a,{item:!0,xs:12},o.a.createElement(k.a,{elevation:2},o.a.createElement(A.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Login"),o.a.createElement(f.b,{to:"/register",className:"no-line",style:{paddingLeft:"10px"}},o.a.createElement(A.a,{variant:"outlined",color:"secondary"},"Register")))))}}]),a}(n.Component),_n=Yn=Object(p.g)(Yn),qn={overrides:{MuiContainer:{root:{"background-color":"#212121"}},MuiSelect:{icon:{color:"white"}},MuiInputBase:{root:{}},PrivateTabIndicator:{colorSecondary:{backgroundColor:"white"}},MuiInput:{underline:{"&:before":{borderBottomColor:"white"}}},MuiBottomNavigation:{root:{zIndex:100}}},palette:{common:{black:"#000",white:"#fff"},appBackground:{main:"black"},background:{paper:"#212121",toolbar:"#333333",tableHeader:"#2e3134",default:"rgba(48, 48, 48, 1)"},primary:{main1:"#0072fff7",main:"#4ec5ff",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#14eac3",main:"#14eac3",dark:"#14eac3",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},text:{primary:"#ffffff",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},Qn=qn=qn,Xn={overrides:{MuiContainer:{root:{"background-color":"#ffffff"}},MuiSelect:{icon:{color:"black"}},PrivateTabIndicator:{colorSecondary:{backgroundColor:"white"}},MuiBottomNavigation:{root:{zIndex:100}}},palette:{common:{black:"#000",white:"#fff"},background:{paper:"#ffffff",toolbar:"#fffffff5",tableHeader:"#f1f1f1",default:"#f1f1f1"},primary:{main1:"#0072fff7",main:"#4ec5ff",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#14eac3",main:"#14eac3",dark:"#14eac3",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},follow:{main:"#09e073"},unfollow:{main:"#e07609"},text:{primary:"#000000",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},$n=Xn=Xn,eo=Object(b.a)(Qn);eo=Object(E.a)(eo);var to=Object(b.a)($n);to=Object(E.a)(to);var ao=Object(x.a)((function(e){return{root:{backgroundColor:e.palette.background.paper,minHeight:"calc(100vh - 128px)",maxHeight:"calc(100vh - 128px)",overflowY:"scroll"}}}))(g.a),no=Object(x.a)((function(e){return{root:{minHeight:"64px",maxHeight:"64px"}}}))(v.a),oo=Object(x.a)((function(e){return{root:{minHeight:"64px",maxHeight:"64px"}}}))(Zn),so=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={btmnav:0,user:h.auth().currentUser,userMD:!1,theme:eo,darkTheme:!0,alertOpen:!1,alertInfo:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.firebaseAuthListener=h.auth().onAuthStateChanged((function(t){var a=h.firestore();if(t){var n=a.collection("users").doc(t.uid);e.userMDListener=n.onSnapshot((function(a){a.exists?e.setState({user:t,userMD:a.data()}):e.setState({user:t,userMD:!1})}),(function(e){console.log(e)}))}else e.setState({user:null,userMD:!1})}))}},{key:"handleLogin",value:function(e){this.setState({user:e})}},{key:"handleLogout",value:function(){var e=this;h.auth().signOut().then((function(){e.setState({user:null})}),(function(e){console.error("Sign Out Error",e)}))}},{key:"componentWillUnmount",value:function(){void 0!==this.firebaseAuthListener&&this.firebaseAuthListener&&this.firebaseAuthListener(),null!==this.userMDListener&&this.userMDListener&&this.userMDListener()}},{key:"changeTheme",value:function(){var e=this.state.darkTheme?to:eo;this.setState({theme:e,darkTheme:!this.state.darkTheme})}},{key:"onAlert",value:function(e){console.log(e),this.setState({alertInfo:e,alertOpen:!0})}},{key:"onCloseAlert",value:function(){this.setState({alertOpen:!1,alertInfo:!1})}},{key:"render",value:function(){var e=this;return o.a.createElement(d.Provider,null,o.a.createElement(f.a,null,o.a.createElement(w.a,{theme:this.state.theme},o.a.createElement(oo,{className:"header",user:this.state.user,userMD:this.state.userMD,changeTheme:this.changeTheme.bind(this),handleLogout:this.handleLogout.bind(this),alertOpen:this.state.alertOpen,alertInfo:this.state.alertInfo,onCloseAlert:this.onCloseAlert.bind(this)}),o.a.createElement(ao,{container:!0,id:"testCont"},o.a.createElement(g.a,{item:!0,container:!0,xs:12,style:{minHeight:"100%",paddingTop:"8px"}},o.a.createElement(p.d,null,o.a.createElement(p.b,{exact:!0,path:"/boxSearch"},o.a.createElement(_e,{user:this.state.user,userMD:this.state.userMD,onAlert:this.onAlert.bind(this)})),o.a.createElement(p.b,{exact:!0,path:"/profile"},o.a.createElement(Ln,{user:this.state.user,userMD:this.state.userMD,onAlert:this.onAlert.bind(this)})),o.a.createElement(p.b,{path:"/box/:boxID",render:function(t){return o.a.createElement(Ie,{userMD:e.state.userMD,boxID:t.match.params.boxID,onAlert:e.onAlert.bind(e)})}}),o.a.createElement(p.b,{path:"/class/:boxID/:gymClassID",render:function(t){return o.a.createElement(Qt,{userMD:e.state.userMD,gymClassID:t.match.params.gymClassID,boxID:t.match.params.boxID,onAlert:e.onAlert.bind(e)})}}),o.a.createElement(p.b,{path:"/wod/:boxID/:gymClassID/:wodID",render:function(t){return o.a.createElement(ka,{userMD:e.state.userMD,gymClassID:t.match.params.gymClassID,wodID:t.match.params.wodID,boxID:t.match.params.boxID,isReadOnly:!0,onAlert:e.onAlert.bind(e)})}}),o.a.createElement(p.b,{exact:!0,path:"/register",render:function(t){return o.a.createElement(ct,{onAlert:e.onAlert.bind(e)})}}),o.a.createElement(p.b,{exact:!0,path:"/settings",render:function(t){return o.a.createElement(it,{user:e.state.user,userMD:e.state.userMD,onAlert:e.onAlert.bind(e)})}}),o.a.createElement(p.b,{exact:!0,path:"/login"},o.a.createElement(_n,{onLogin:this.handleLogin.bind(this),onAlert:this.onAlert.bind(this)}))),o.a.createElement("div",{style:{margin:"5vh"}}))),o.a.createElement(no,{value:this.state.btmnav,onChange:function(t,a){e.setState({btmnav:a})},style:{background:this.state.theme.palette.primary.mainGrad},showLabels:!0},o.a.createElement(y.a,{label:"Search",component:f.b,to:"/boxSearch",icon:o.a.createElement(C.a,null)}),o.a.createElement(y.a,{label:"Profile",component:f.b,to:"/profile",icon:o.a.createElement(C.a,null)})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t}}]),a}(o.a.Component);so.contextType=d,r.a.render(o.a.createElement(so,null),document.getElementById("root"))}},[[170,1,2]]]);
//# sourceMappingURL=main.0f012e59.chunk.js.map