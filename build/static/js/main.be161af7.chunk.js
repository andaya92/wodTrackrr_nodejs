(this.webpackJsonpreactapp=this.webpackJsonpreactapp||[]).push([[0],{170:function(e,t,a){e.exports=a(277)},18:function(e,t,a){},277:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),s=a.n(o),i=a(5),l=a(6),c=a(8),u=a(7),m=a(130),h=(a(15),m),d=r.a.createContext(m.initializeApp({apiKey:"AIzaSyCGE8_j8cfIBmIzcvP6CVgG2yC6EE1Ep1U",authDomain:"wodtrackrr.firebaseapp.com",databaseURL:"https://wodtrackrr.firebaseio.com",projectId:"wodtrackrr",storageBucket:"wodtrackrr.appspot.com",messagingSenderId:"743601990099",appId:"1:743601990099:web:5937e9151eaad13e93a726",measurementId:"G-39CF0BRPMH"})),p=(a(23),a(17)),f=a(19),v=a(311),g=a(341),y=a(342),b=a(155),E=a(353),x=a(4),w=a(340),C=a(133),D=a.n(C),k=(a(18),a(33),a(158)),O=a(352),M=(a(97),a(279)),S=a(68),I=a(27),j=a(42),A=a(69),T=a(60),L=a(104),P=a.n(L),B=a(65);function U(e){var t=e.split(":"),a=Object(j.a)(t,2),n=a[0],r=a[1];return 60*parseInt(n)+parseInt(r)}function F(e){var t=Math.floor(e/60),a=Math.floor(e-60*t);return a<10&&(a="0".concat(a)),"".concat(t,":").concat(a)}h.database();var R=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:e.stats},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.createChart()}},{key:"createChart",value:function(){var e=this;this.ctx=document.getElementById("lineChart");var t=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);t.addColorStop(0,"#01d3fe"),t.addColorStop(1,"#0890fd"),this.lineChart&&this.lineChart.destroy(),this.lineChart=new P.a(this.ctx,{type:"line",data:{label:"Scores",datasets:[{label:"Score",barPercentage:.5,barThickness:6,maxBarThickness:8,minBarLength:2,backgroundColor:t,data:this.state.data}]},options:{scales:{yAxes:[{ticks:{callback:function(t,a,n){return"time"===e.state.scoreType?F(t):"reps"===e.state.scoreType?t:void 0}}}]},tooltips:{callbacks:{title:function(e,t){},label:function(t,a){var n=a.datasets[t.datasetIndex].label||"";return n&&(n+=": "),"time"===e.state.scoreType?n+=F(t.yLabel):"reps"===e.state.scoreType&&(n+=t.yLabel),n}}},maintainAspectRatio:!1},plugins:[{beforeInit:function(e){e.data.datasets[0].data}}]})}},{key:"componentDidUpdate",value:function(){this.createChart()}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement("div",{style:{width:"92vw",padding:"8px"}},r.a.createElement("canvas",{id:"lineChart"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),W=R=Object(O.a)(R),N=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scoreType:e.scoreType,data:e.data,values:e.values,stats:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.createChart(this.binData(this.state.values))}},{key:"componentDidUpdate",value:function(){console.log(this.state),this.createChart(this.binData(this.state.values))}},{key:"createChart",value:function(e){var t=Object(j.a)(e,2),a=t[0],n=t[1];this.ctx=document.getElementById("barChart");var r=this.ctx.getContext("2d").createLinearGradient(200,0,200,400);r.addColorStop(0,"#01d3fe"),r.addColorStop(1,"#0890fd"),this.barChart&&this.barChart.destroy(),this.barChart=new P.a(this.ctx,{type:"bar",data:{labels:a,datasets:[{label:"Scores (Standard Deviation)",minBarLength:1,backgroundColor:r,data:n}]},options:{maintainAspectRatio:!1}}),this.barChart.update()}},{key:"format",value:function(e){return"time"===this.state.scoreType?e<=0?0:F(e):"reps"===this.state.scoreType?parseFloat(e):void 0}},{key:"createLabels",value:function(e,t){for(var a=[],n=0;n<3;n++){var r="".concat(this.format(e-t*(n+1))," - ").concat(this.format(e-t*n)),o="".concat(this.format(e+t*n)," - ").concat(this.format(e+t*(n+1)));a.unshift(r),a.push(o)}return a}},{key:"binData",value:function(e){var t,a=Object(T.standardDeviation)(e),n=Object(T.mean)(e),r=this.createLabels(n,a),o=[0,0,0,0,0,0],s=Object(B.a)(e);try{for(s.s();!(t=s.n()).done;){var i=t.value-n,l=Math.floor(i/a);Math.abs(l)<=1?i>0?o[3]++:o[2]++:Math.abs(l)<=2?i>0?o[4]++:o[1]++:i>0?o[5]++:o[0]++}}catch(c){s.e(c)}finally{s.f()}return[r,o]}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement("div",{style:{width:"92vw",padding:"8px"}},r.a.createElement("canvas",{id:"barChart"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return console.log(e),console.log(t),e}}]),a}(n.Component)),V=N=Object(O.a)(N);function G(e){return console.log(e),{min:Math.min.apply(Math,Object(A.a)(e)),max:Math.max.apply(Math,Object(A.a)(e)),mean:Object(T.mean)(e),median:Object(T.median)(e),sd:Object(T.standardDeviation)(e)}}var z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,graphData:[],rawScores:[],scoreType:"",stats:{}},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,container:!0,align:"center",spacing:1,xs:12},r.a.createElement(v.a,{item:!0,xs:4},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,"Low: ","time"===this.state.scoreType?F(this.state.stats.min):this.state.stats.min))),r.a.createElement(v.a,{item:!0,xs:4},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,"High: ","time"===this.state.scoreType?F(this.state.stats.max):this.state.stats.max))),r.a.createElement(v.a,{item:!0,xs:4},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,"Avg: ","time"===this.state.scoreType?F(this.state.stats.mean):this.state.stats.mean)))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(W,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(V,{data:this.state.graphData,values:this.state.rawScores,scoreType:this.state.scoreType,stats:this.state.stats})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=function(e){for(var t=[],a="",n=e.map((function(e){return a=e.scoreType,"time"===e.scoreType?U(e.score):parseFloat(e.score)})),r=0;r<n.length;r++)t.push({x:r,y:n[r],c:0});return[t,n,a,G(n)]}(e.scores),n=Object(j.a)(a,4),r=n[0],o=n[1],s=n[2],i=n[3];return Object(I.a)(Object(I.a)({},e),{},{graphData:r,rawScores:o,scoreType:s,stats:i})}}]),a}(n.Component),K=z=Object(O.a)(z),H=a(314),J=a(315),Z=a(316),Y=a(317),_=a(318),q=a(319),Q=a(320),X=a(321),$=a(322),ee=a(39),te=a.n(ee),ae=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.scores.length>0?r.a.createElement(H.a,{component:k.a},r.a.createElement(J.a,{"aria-label":"score table"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Username"),r.a.createElement(_.a,null,"Score"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.scores.map((function(t,a){var n=e.state.uid==t.uid;return r.a.createElement(re,{key:a,info:t,onRemove:e.props.onRemove,isUserScore:n})}))))):r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Q.a,{variant:"outlined",color:"primary"},r.a.createElement(X.a,null,r.a.createElement(M.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),ne=ae=Object(O.a)(ae);var re=Object(O.a)((function(e){var t=e.info.score,a=e.info.username,n=(e.info.wodID,e.info.uid,e.info.scoreID);return e.isUserScore,r.a.createElement(Y.a,{selected:e.isUserScore},r.a.createElement(_.a,null,a),r.a.createElement(_.a,null,t),e.isUserScore?r.a.createElement(_.a,{align:"right"},r.a.createElement($.a,{size:"small",onClick:function(){return e.onRemove(n)}},r.a.createElement(te.a,{color:"error"}))):r.a.createElement(_.a,null))})),oe=a(16),se=a(25),ie=a.n(se),le=a(354),ce=a(324),ue=a(325),me=a(348),he=h.firestore();function de(e){return new Promise((function(t,a){he.collection("scores").doc(e).delete().then((function(){t("Successfully removed score: ".concat(e))})).catch((function(t){a("Failed to remove score: ".concat(e))}))}))}var pe=Object(x.a)({root:{borderBottom:"none"}})(_.a),fe=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,wodMD:e.wodMD},n}return Object(l.a)(a,[{key:"objListToArray",value:function(e){return Array.from(Object.entries(e),(function(e){return new Map(Object.entries(e[1]))}))}},{key:"isNumInSane",value:function(e){return-1===e.search(/\D/)}},{key:"handleAddScore",value:function(){if(this.state.userMD){var e="";if("time"===this.state.wodMD.scoreType){var t=document.getElementById("scoreViewUserScoreMins").value,a=document.getElementById("scoreViewUserScoreSecs").value;if(!this.isNumInSane(t)||!this.isNumInSane(a))return void alert("Time must only contain numbers, entered: ".concat(t,":").concat(a));if(parseInt(a)>59)return void alert("Seconds must be 59 or below, entered: ".concat(a));if(parseInt(a)<10&&1===a.length&&(a="0".concat(a)),isNaN(parseInt(a))||isNaN(parseInt(t)))return void alert("Missing field, entered: ".concat(t,":").concat(a));if(t.length>2)return void alert("Minutes must be 99 or below, entered: ".concat(t));0===t.length&&(t="0"),0===a.length&&(a="0"),e="".concat(t,":").concat(a)}else{if((e=document.getElementById("scoreViewUserScore").value).length>3)return void alert("Score must be 3 digits or less, entered: ".concat(e));if(!e)return void alert("Must enter score.");if(!this.isNumInSane(e))return void alert("Score must be digits only, entered: ".concat(e))}var n=this.state.userMD.username,r=this.state.userMD.uid,o=this.state.wodMD.wodID,s=this.state.wodMD.gymClassID,i=this.state.wodMD.boxID;(function(e,t,a,n,r,o,s,i){return new Promise((function(l,c){var u={uid:a,wodID:r,gymClassID:o,boxID:s,username:t,title:e,score:n,scoreType:i};he.collection("scores").where("uid","==",a).where("wodID","==",r).get().then((function(e){var t="";if(console.log(e),e.empty){var a=he.collection("scores").doc();a.set(Object(I.a)(Object(I.a)({},u),{},{date:Date.now(),scoreID:a.id})).then((function(){l("Added new score.")})).catch((function(e){c(e)}))}else e.forEach((function(e){t=e.data().scoreID})),he.collection("scores").doc(t).update(Object(I.a)(Object(I.a)({},u),{},{scoreID:t})).then((function(){l("Updated score.")})).catch((function(e){c(e)}))}),(function(e){c(e)}))}))})(this.state.wodMD.title,n,r,e,o,s,i,this.state.wodMD.scoreType).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}}},{key:"render",value:function(){var e,t,a;return r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},r.a.createElement(le.a,null,r.a.createElement(ce.a,{style:{background:this.props.theme.palette.primary.mainGrad},expandIcon:r.a.createElement(ie.a,null),"aria-label":"Expand","aria-controls":"additional-actions2-content",id:"additional-actions2-header"},r.a.createElement(M.a,null,"Add Score")),r.a.createElement(ue.a,null,r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,null,this.state.wodMD.scoreType.replace(this.state.wodMD.scoreType[0],this.state.wodMD.scoreType[0].toUpperCase()))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(H.a,null,r.a.createElement(J.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null,"time"===this.state.wodMD.scoreType?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe,{align:"center"},r.a.createElement(me.a,(e={id:"scoreViewUserScoreMins",type:"number",style:{margin:8},pattern:"[0-9]{3}",inputProps:{title:"Numbers only, max length 3",placeholder:"Minutes"}},Object(oe.a)(e,"style",{width:"100%"}),Object(oe.a)(e,"margin","normal"),Object(oe.a)(e,"color","primary"),Object(oe.a)(e,"InputLabelProps",{shrink:!0}),e))),r.a.createElement(pe,{align:"center"},r.a.createElement(me.a,(t={id:"scoreViewUserScoreSecs",type:"number",style:{margin:8},pattern:"[0-9]{2}",inputProps:{title:"Numbers only, max length 2",placeholder:"Seconds"}},Object(oe.a)(t,"style",{width:"100%"}),Object(oe.a)(t,"margin","normal"),Object(oe.a)(t,"color","primary"),Object(oe.a)(t,"InputLabelProps",{shrink:!0}),t)))):r.a.createElement(pe,{align:"center",colSpan:2},r.a.createElement(me.a,(a={id:"scoreViewUserScore",type:"number",style:{margin:8},pattern:"[0-9]{4}",inputProps:{title:"Numbers only, max length 4",placeholder:"Score"},margin:"normal"},Object(oe.a)(a,"style",{width:"100%"}),Object(oe.a)(a,"color","primary"),Object(oe.a)(a,"InputLabelProps",{shrink:!0}),a)))),r.a.createElement(Y.a,null,r.a.createElement(pe,{colSpan:3,align:"center"},r.a.createElement($.a,{color:"primary",style:{width:"100%"},variant:"outlined",onClick:this.handleAddScore.bind(this)},"Add")))))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),ve=fe=Object(O.a)(fe),ge=a(349),ye=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={open:e.open},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(ge.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},r.a.createElement(v.a,{item:!0,align:"center",xs:12},r.a.createElement(k.a,{style:{height:"25vh",display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,{style:{marginTop:"32px"}},this.props.modalText)),r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{variant:"outlined",onClick:function(){e.props.onClose()}},this.props.cancelText)),r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{color:"primary",variant:"outlined",onClick:function(){e.props.onAction()}},this.props.actionText)))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),be=ye=Object(O.a)(ye);var Ee=h.firestore();function xe(e){var t=Ee.collection("wods").doc(e.gymClassID).collection("wods").doc();return t.set(Object(I.a)(Object(I.a)({},e),{},{date:Date.now(),wodID:t.id}))}function we(e){var t=["wods/".concat(e.gymClassID,"/wods"),"scores"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,r,o){var s=Ee.batch();Ee.collection(t).where(a,"==",n).get().then((function(i){var l=0;0==i.size&&r(1),i.forEach((function(e){s.delete(e.ref),l++})),s.commit().then((function(){l>=500&&e(t,a,n,r,o)})).catch((function(e){return o(0)}))})),r(1)}(t,"wodID",e.wodID,a,n)}))}));return Promise.all(t)}h.database();function Ce(e){var t=e.wodText.split("\n");return r.a.createElement(v.a,{item:!0,xs:12},t.map((function(e,t){return r.a.createElement(v.a,{item:!0,xs:12,key:t},r.a.createElement(M.a,null,e||r.a.createElement("br",null)))})))}Object(O.a)(Ce);var De=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,gymClassID:e.gymClassID,wodID:e.wodID,wodMD:{},scores:[],userScore:{},curRemoveScoreID:"",showRemoveAlert:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(this.state.userMD),console.log(this.state.gymClassID,this.state.wodID);var t,a,n=h.firestore();this.wodListener=(t=this.state.gymClassID,a=this.state.wodID,Ee.collection("wods").doc(t).collection("wods").doc(a)).onSnapshot((function(t){e.setState({wodMD:t.data()})}),(function(e){console.log(e)})),this.scoreListener=n.collection("scores").where("wodID","==",this.state.wodID).onSnapshot((function(t){if(t.empty)e.setState({scores:[],userScore:{}});else{var a=[],n={},r="";t.forEach((function(t){var o=t.data();a.push(o),r=o.scoreType,o.uid===e.state.uid&&(n=o)}));var o=r&&"time"===r?1:0;a.sort((function(e,t){return o?parseFloat(e.score)<parseFloat(t.score)?-1:1:parseFloat(e.score)>parseFloat(t.score)?1:-1})),e.setState({scores:a,userScore:n})}}),(function(e){}))}},{key:"componentWillUnmount",value:function(){void 0!==this.scoreListener&&this.scoreListener(),void 0!==this.wodListener&&this.wodListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveScore",value:function(e){this.setState({curRemoveScoreID:e,showRemoveAlert:!0})}},{key:"removeScore",value:function(){var e=this,t=this.state.curRemoveScoreID;""===t||t.length<=0?this.props.onAlert({type:"warning",message:"Invalid scoreID!"}):(this.setState({showRemoveAlert:!1}),de(t).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t})})))}},{key:"render",value:function(){var e=this.state.wodMD.date?S.DateTime.fromMillis(this.state.wodMD.date):{monthLong:"",day:"",year:""};return r.a.createElement(r.a.Fragment,null,Object.keys(this.state.wodMD).length>0?r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,align:"center",xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,this.state.wodMD.boxTitle),r.a.createElement(M.a,null,this.state.wodMD.gymClassTitle),r.a.createElement(M.a,null,this.state.wodMD.title),r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"For ",this.state.wodMD.scoreType),r.a.createElement(M.a,{variant:"caption",color:"secondary"},e.monthLong," ",e.day,", ",e.year))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:6,style:{margin:"8px 0px 8px 0px",padding:"8px"}},r.a.createElement(v.a,{item:!0,xs:12,align:"center"},r.a.createElement(M.a,{variant:"subtitle2",color:"primary"},"Workout")),r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(Ce,{wodText:this.state.wodMD.wodText})))),Object.keys(this.state.userMD).length>0?r.a.createElement(ve,{userMD:this.state.userMD,wodMD:this.state.wodMD}):r.a.createElement(r.a.Fragment,null),r.a.createElement(v.a,{item:!0,xs:12,margin:{marginTop:"16px"}},this.state.scores&&this.state.scores.length>0?r.a.createElement(K,{scores:this.state.scores}):r.a.createElement(r.a.Fragment,null)),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(ne,{scores:this.state.scores,uid:this.state.userMD.uid,onRemove:this.handleRemoveScore.bind(this)}))),r.a.createElement(be,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.removeScore.bind(this),modalText:"Remove score?",actionText:"Remove",cancelText:"Cancel"})):r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,"Wod not found!"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),ke=De=Object(O.a)(De),Oe=a(328),Me=a(26),Se=a.n(Me),Ie=h.firestore();function je(e){return Ie.collection("gymClasses").doc(e).collection("classes")}function Ae(e,t){var a=["scores","wods/".concat(t,"/wods"),"classAdmins","classMembers","notifications/admins/invites","notifications/members/invites","classAdminsShallow/".concat(t,"/users"),"classMembersShallow/".concat(t,"/users"),"classOwners/".concat(t,"/users/"),"gymClasses/".concat(e,"/classes")].map((function(e){return new Promise((function(a,n){!function e(t,a,n,r,o){var s=Ie.batch();Ie.collection(t).where(a,"==",n).get().then((function(i){var l=0;i.size,i.forEach((function(e){s.delete(e.ref),l++})),s.commit().then((function(){l>=500&&e(t,a,n,r,o)})).catch((function(e){return o(0)}))})),r(1)}(e,"gymClassID",t,a,n)}))}));return Promise.all(a)}h.firestore();var Te=Object(O.a)((function(e){var t=e.info.title,a=e.info.boxID,n=e.info.gymClassID;return r.a.createElement(Y.a,{id:"class/".concat(n),name:"GymClassRow",onClick:function(t){e.onRowClick(t,"/class/".concat(a,"/").concat(n))}},r.a.createElement(_.a,{align:"left"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},t)),r.a.createElement(_.a,{align:"right"},e.isOwner?r.a.createElement($.a,{onClick:function(){e.onRemove(e.info)}},r.a.createElement(te.a,{color:"error"})):r.a.createElement(r.a.Fragment,null)))}));var Le=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(_.a,{colSpan:3,align:"center"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"No Classes!")))})),Pe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,isOwner:e.isOwner,boxID:e.boxID,redirect:!1,redirectTo:"",filteredGymClasses:[],gymClasses:[],removeClassID:"",removeClassTitle:"",openModal:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){console.log(this.state),this.getGymClasses(this.state.boxID)}},{key:"getGymClasses",value:function(e){var t=this;e&&!this.gymClassListener&&(this.gymClassListener=je(this.state.boxID).onSnapshot((function(e){if(console.log(e),e.empty)t.setState({gymClasses:[],filteredGymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data())})),t.setState({gymClasses:a,filteredGymClasses:a})}}),(function(e){console.log(e)})))}},{key:"componentDidUpdate",value:function(){this.getGymClasses(this.state.boxID)}},{key:"componentWillUnmount",value:function(){this.gymClassListener&&this.gymClassListener()}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.gymClasses.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredGymClasses:a})}},{key:"onRowClick",value:function(e,t){var a=e.target.tagName;["span","svg","path"].indexOf(a)<0&&this.setState({redirect:!0,redirectTo:t})}},{key:"handleRemoveGymClass",value:function(){var e=this;this.closeModal(),this.state.boxID||this.state.removeClassID?Ae(this.state.boxID,this.state.removeClassID).then((function(t){console.log(t),e.props.onAlert({type:"success",message:"Deleted class!"})})).catch((function(e){console.log(e)})):this.props.onAlert({type:"error",message:"Class info missing!"})}},{key:"onRemove",value:function(e){this.setState({openModal:!0,removeClassID:e.gymClassID,removeClassTitle:e.title})}},{key:"closeModal",value:function(){this.setState({openModal:!1})}},{key:"render",value:function(){var e=this;return console.log(this.state.gymClasses),r.a.createElement(v.a,{item:!0,xs:12},this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectTo}):r.a.createElement(r.a.Fragment,null),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},r.a.createElement(k.a,{elevation:2,component:"form"},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Classes",InputProps:{startAdornment:r.a.createElement(Oe.a,{position:"start"},r.a.createElement(Se.a,{color:"primary"}))}}))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(H.a,null,r.a.createElement(J.a,{stickyHeader:!0},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Classes"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.filteredGymClasses.length>0?this.state.filteredGymClasses.map((function(t,a){return r.a.createElement(Te,{key:a,info:t,onRemove:e.onRemove.bind(e),isOwner:e.props.isOwner,onRowClick:e.onRowClick.bind(e)})})):r.a.createElement(Le,null)))))),r.a.createElement(be,{open:this.state.openModal,actionText:"Remove",cancelText:"Cancel",modalText:"Remove Class (".concat(this.state.removeClassTitle,")?"),onAction:this.handleRemoveGymClass.bind(this),onClose:this.closeModal.bind(this)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Be=Pe=Object(O.a)(Pe),Ue=a(280),Fe=a(351),Re=a(358),We=a(129),Ne=a.n(We),Ve=Object(x.a)({root:{padding:"4px 0px 4px 4px"}})(_.a),Ge=Object(x.a)((function(e){return{root:{margin:"8px 0px 8px 0px",padding:"4px 0px 4px 4px",backgroundColor:e.palette.primary.main,borderRadius:"8px"}}}))(v.a);var ze=Object(O.a)((function(e){var t=e.info.title,a=(e.info.scoreType,e.info.wodText,e.info.wodID),n=e.info.gymClassID,o=e.info.date;return r.a.createElement(Ge,{container:!0,item:!0,xs:12,style:{margin:"8px 0px 8px 0px"},onClick:function(t){var r=t.target.tagName;["path","svg"].indexOf(r)>-1||e.onViewScores("/wod/".concat(n,"/").concat(a))}},r.a.createElement(v.a,{item:!0,xs:10,align:"left"},r.a.createElement(M.a,{variant:"subtitle2",component:"h2",gutterBottom:!0,style:{overflowWrap:"break-word"}},t),r.a.createElement(M.a,{variant:"caption",component:"h2",gutterBottom:!0},new Date(o).toLocaleDateString("en-US"))),r.a.createElement(v.a,{item:!0,alignItems:"center",container:!0,xs:2,align:"right",justify:"center"},e.showOwnerBtns?r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement(Ue.a,{size:"small",color:"secondary",onClick:function(){return e.handleEdit(e.info)}},r.a.createElement(Ne.a,null))),r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement(Ue.a,{size:"small",onClick:function(){return e.handleRemove(e.info)}},r.a.createElement(te.a,{color:"error"})))):r.a.createElement(r.a.Fragment,null)))}));var Ke=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(Ve,{colSpan:3,align:"center"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"No Workouts!")))})),He=Object(x.a)({root:{overflow:"hidden"},actions:{margin:"0px"}})(Fe.a),Je=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={headers:e.headers,rows:e.rows,filteredRows:e.filteredRows,orderTableBy:"date",orderTable:"asc",pageNum:0,rowsPerPage:5,pageStart:0,pageEnd:5,redirectUrl:"",redirect:!1},n}return Object(l.a)(a,[{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.rows.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredRows:a})}},{key:"descendingComparator",value:function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}},{key:"getComparator",value:function(e,t){var a=this;return"desc"===e?function(e,n){return a.descendingComparator(e,n,t)}:function(e,n){return-a.descendingComparator(e,n,t)}}},{key:"stableSort",value:function(e){var t=this.state.filteredRows.map((function(e,t){return[e,t]}));return t.sort((function(t,a){var n=e(t[0],a[0]);return 0!==n?n:t[1]-a[1]})),t.map((function(e){return e[0]}))}},{key:"createSortHandler",value:function(e){var t=this.state.orderTableBy===e&&"asc"===this.state.orderTable;this.setState({orderTableBy:e,orderTable:t?"desc":"asc"})}},{key:"handleChangePage",value:function(e,t){var a=t*this.state.rowsPerPage,n=t*this.state.rowsPerPage+this.state.rowsPerPage;this.setState({pageNum:t,pageStart:a,pageEnd:n})}},{key:"handleChangeRowsPerPage",value:function(e){var t=parseInt(e.target.value);console.log(t),this.setState({pageNum:0,rowsPerPage:t,pageStart:0,pageEnd:t})}},{key:"onViewScores",value:function(e){this.setState({redirectUrl:e,redirect:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12,align:"center"},this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectUrl}):r.a.createElement(r.a.Fragment,null),r.a.createElement(k.a,{style:{margin:"16px 0px 0px 0px"},component:"form"},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search",InputProps:{startAdornment:r.a.createElement(Oe.a,{position:"start"},r.a.createElement(Se.a,{color:"primary"}))}})),r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(H.a,{style:{margin:"8px 0px 0px 0px"}},r.a.createElement(J.a,null,r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,this.state.headers.map((function(t,a){return r.a.createElement(Ve,{key:a},t.sortable?r.a.createElement(Re.a,{active:t.id===e.state.orderTableBy,direction:t.id===e.state.orderTableBy?e.state.orderTable:"asc",onClick:function(){e.createSortHandler(t.id)}},t.label):r.a.createElement(r.a.Fragment,null,t.label))})))))),this.state.filteredRows.length>0?this.stableSort(this.getComparator(this.state.orderTable,this.state.orderTableBy)).slice(this.state.pageStart,this.state.pageEnd).map((function(t,a){return r.a.createElement(ze,{key:a,handleView:e.props.handleView,handleRemove:e.props.handleRemove,handleEdit:e.props.handleEdit,info:t,showOwnerBtns:e.props.showOwnerBtns,onViewScores:e.onViewScores.bind(e)})})):r.a.createElement(Ke,null),r.a.createElement(He,{rowsPerPageOptions:[5,10,25],component:v.a,count:this.state.filteredRows.length,rowsPerPage:this.state.rowsPerPage,page:this.state.pageNum,onChangePage:this.handleChangePage.bind(this),onChangeRowsPerPage:this.handleChangeRowsPerPage.bind(this)})),r.a.createElement(v.a,{item:!0,xs:12}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.rows.length>0?t:e}}]),a}(n.Component),Ze=Je=Object(O.a)(Je),Ye=h.firestore(),_e=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),n=t.call(this,e),console.log(e),n.state={userMD:e.userMD,boxID:e.boxID,boxMD:{}},n}return Object(l.a)(a,[{key:"getBoxListener",value:function(){var e=this;this.boxListener||(this.boxListener=Ye.collection("boxes").doc(this.state.boxID).onSnapshot((function(t){console.log(t),console.log(e.state.boxID),console.log(t.data()),t.exists?e.setState({boxMD:t.data()}):e.setState({boxMD:{}})}),(function(e){console.log(e)})))}},{key:"checkListeners",value:function(){void 0===this.boxListener&&this.getBoxListener()}},{key:"componentDidMount",value:function(){this.checkListeners()}},{key:"componentDidUpdate",value:function(){this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.boxListener&&this.boxListener()}},{key:"render",value:function(){var e=this.state.userMD.uid===this.state.boxMD.uid;return r.a.createElement(v.a,{item:!0,xs:12},Object.keys(this.state.boxMD).length>0?r.a.createElement(Be,{user:this.state.user,userMD:this.state.userMD,boxID:this.state.boxID,isOwner:e,onAlert:this.props.onAlert}):r.a.createElement(r.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),qe=_e=Object(O.a)(_e),Qe=a(83),Xe=a.n(Qe);function $e(e){var t=h.firestore();return new Promise((function(a,n){t.collection("following").doc(e).delete().then((function(){a("Finished delete.")})).catch((function(e){n(e)}))}))}function et(e,t,a,n){var r=h.firestore();return new Promise((function(o,s){r.collection("following").where("uid","==",e).get().then((function(i){var l=!1;if(i.empty||i.forEach((function(e){e.data().boxID===a&&(l=!0)})),!l){var c=r.collection("following").doc(),u={followID:c.id,uid:e,username:t,boxID:a,title:n,date:Date.now()};c.set(u).then((function(){o("Followed.")})).catch((function(e){s(e)}))}}))}))}var tt=h.firestore();var at=Object(O.a)((function(e){var t=e.info.title,a=e.info.boxID;return r.a.createElement(Y.a,{id:"box/".concat(a),onClick:function(t){return e.onRowClick(t,"box/".concat(a))}},r.a.createElement(_.a,{align:"left"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},t)),r.a.createElement(_.a,{align:"right"},e.isUserFollowing?r.a.createElement(Ue.a,{variant:"outlined",onClick:function(){e.handleUnfollow(a)}},r.a.createElement(Xe.a,{color:"primary"})):r.a.createElement(Ue.a,{onClick:function(){e.handleFollow(e.info)}},r.a.createElement(Xe.a,{style:{fill:e.theme.palette.text.primary}})),e.isOwner?r.a.createElement($.a,{onClick:function(){e.handleRemoveBox(a,t)}},r.a.createElement(te.a,{color:"error"})):r.a.createElement(r.a.Fragment,null)))}));var nt=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(_.a,{colSpan:3,align:"center"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"No Gyms!")))})),rt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,isOwner:e.isOwner,allBoxes:e.allBoxes,filteredBoxes:e.filteredBoxes,userFollowing:{},redirect:!1,redirectTo:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.listenForFollowing()}},{key:"componentWillUnmount",value:function(){this.followListener&&this.followListener()}},{key:"componentDidUpdate",value:function(){this.listenForFollowing()}},{key:"listenForFollowing",value:function(){var e=this;this.state.userMD&&!this.followListener&&(this.followListener=tt.collection("following").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a={};t.empty||t.forEach((function(e){var t=e.data();a[t.boxID]=t.followID})),e.setState({userFollowing:a})}),(function(e){return console.log(e)})))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allBoxes.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));console.log("filteredBoxes"),console.log(a),this.setState({filteredBoxes:a})}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"handleFollow",value:function(e){et(this.state.userMD.uid,this.state.userMD.username,e.boxID,e.title).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){$e(this.state.userFollowing[e]).then((function(e){e&&console.log("Succefully unfollowed.")})).catch((function(e){console.log(e)}))}},{key:"onRowClick",value:function(e,t){var a=e.target.tagName;["span","svg","path","BUTTON","SPAN"].indexOf(a)<0&&this.setState({redirect:!0,redirectTo:t})}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"3vh"}},this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectTo}):r.a.createElement(r.a.Fragment,null),r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},r.a.createElement(k.a,{elevation:2,component:"form"},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Boxes",InputProps:{startAdornment:r.a.createElement(Oe.a,{position:"start"},r.a.createElement(Se.a,{color:"primary"}))}}))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(H.a,null,r.a.createElement(J.a,{stickyHeader:!0},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Boxes"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.filteredBoxes.length>0?this.state.filteredBoxes.map((function(t,a){return r.a.createElement(at,{key:a,theme:e.props.theme,info:t,color:e.props.theme.palette.primary.mainGrad,handleBoxView:e.props.handleBoxView,handleRemoveBox:e.props.handleRemoveBox,isOwner:e.props.isOwner,isUserFollowing:e.isUserFollowing(t.boxID),handleFollow:e.handleFollow.bind(e),handleUnfollow:e.handleUnfollow.bind(e),onRowClick:e.onRowClick.bind(e)})})):r.a.createElement(nt,null))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.userMD?t:e}}]),a}(n.Component),ot=rt=Object(O.a)(rt),st=h.firestore(),it=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,allBoxes:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.allBoxesListener=st.collection("boxes").onSnapshot((function(t){if(!t.empty){var a=[];t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.title.toLowerCase()>t.title.toLowerCase()?-1:1})),e.setState({allBoxes:a})}}))}},{key:"componentWillUnmount",value:function(){this.allBoxesListener&&this.allBoxesListener()}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},this.state.allBoxes.length>0?r.a.createElement(ot,{user:this.state.user,userMD:this.state.userMD,allBoxes:this.state.allBoxes,filteredBoxes:this.state.allBoxes,isOwner:!1,isReadOnly:!1,handleRemoveBox:this.props.handleRemoveBox}):r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:2},"No boxes!")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),lt=it=Object(O.a)(it),ct=a(330),ut=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,currentPassword:"",newPassword:"",confirmPassword:""},n}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=this.state.currentPassword,n=this.state.newPassword,r=this.state.confirmPassword;if(console.log(this.state),console.log(a,n,r),n===r){var o=h.auth.EmailAuthProvider.credential(this.state.user.email,a);this.state.user.reauthenticateWithCredential(o).then((function(){t.state.user.updatePassword(n).then((function(e){console.log("Changed password.")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),console.log("Incorrect password.")}))}else console.log("New passwords do not match.")}},{key:"onChange",value:function(e){console.log(e),e.persist();var t=e.target,a=t.name,n=t.value;this.setState(Object(oe.a)({},a,n))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.user?r.a.createElement(k.a,{elevation:6},r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12,align:"center"},r.a.createElement(M.a,{variant:"h3"},"Change Password")),r.a.createElement(v.a,{item:!0,xs:12,align:"center"},r.a.createElement(me.a,{id:"currentPassword",type:"password",name:"currentPassword",onChange:this.onChange.bind(this),style:{margin:8},placeholder:"Current Password",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement(me.a,{id:"password",type:"password",name:"newPassword",color:"primary",onChange:this.onChange.bind(this),style:{margin:8},placeholder:"New Password",margin:"normal",InputLabelProps:{shrink:!0}})),r.a.createElement(v.a,{item:!0,xs:12,align:"center"},r.a.createElement(me.a,{id:"passwordConfirm",name:"confirmPassword",onChange:this.onChange.bind(this),type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})),r.a.createElement(v.a,{item:!0,xs:12,align:"center",style:{margin:"16px 0px 16px 0px"}},r.a.createElement($.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Change Password")))):r.a.createElement("h1",null,"Loading"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.user?t:e}}]),a}(n.Component),mt=ut=Object(O.a)(ut),ht=(h.firestore(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userConfirmText:"",redirectUrl:"",redirect:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"confirmText",value:function(){return this.state.user.uid.slice(-5)}},{key:"onChange",value:function(e){var t=e.target.value;this.setState({userConfirmText:t})}},{key:"removeUser",value:function(){this.state.userConfirmText===this.confirmText()?(console.log("Deleting user, actual code commented out."),this.setState({redirect:!0,redirectUrl:"/boxSearch"})):console.log("User entered incorrect confirmation.")}},{key:"render",value:function(){return r.a.createElement(k.a,{elevation:6},this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectUrl}):r.a.createElement(r.a.Fragment,null),r.a.createElement(v.a,{item:!0,container:!0,align:"center",xs:12,style:{marginTop:"16px"}},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,null,"Type to Confirm Delete: ",this.confirmText())),r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"16px"}},r.a.createElement(me.a,{type:"text",placeholder:"Type username to confirm delete",onChange:this.onChange.bind(this)})),r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"32px"}},r.a.createElement($.a,{size:"small",fullWidth:!0,variant:"outlined",onClick:this.removeUser.bind(this),style:{color:this.props.theme.palette.error.main}},"Confirm Remove"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.user?t:e}}]),a}(n.Component)),dt=ht=Object(O.a)(ht),pt=h.firestore();var ft=Object(x.a)({root:{borderBottom:"none"}})(_.a),vt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD},n}return Object(l.a)(a,[{key:"updateUsername",value:function(e){var t=document.getElementById("updateUsernameInput");if("none"===t.style.display)t.style.display="block";else{if(t.value.length>12)return void this.props.onAlert({type:"warning",message:"Username cannot be longer than 12 characters"});if(null!==/\W/g.exec(t.value))return void this.props.onAlert({type:"warning",message:"Username can only contain letters & numbers"});if(t.value.length<=0)return;(function(e,t){var a={username:t},n=[pt.collection("users").doc(e).update(a)];return pt.collection("scores").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),pt.collection("scores").doc(e.data().scoreID).update(a)}))})),pt.collection("following").where("uid","==",e).get().then((function(e){e.docs.map((function(e){return console.log(e.data()),pt.collection("following").doc(e.data().followID).update(a)}))})),new Promise((function(e,t){Promise.all(n).then((function(){e("Updated!")})).catch((function(e){t(e)}))}))})(this.state.userMD.uid,t.value).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.updateUsername()}},{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,id:"usernamePanel"},this.state.userMD?r.a.createElement(H.a,null,r.a.createElement(J.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null,r.a.createElement(ft,{align:"left"},"Username"),r.a.createElement(ft,{colSpan:2,align:"left"},r.a.createElement(M.a,{gutterBottom:!0,variant:"h5"},this.state.userMD.username))),r.a.createElement(Y.a,null,r.a.createElement(ft,null,r.a.createElement(me.a,{id:"updateUsernameInput",type:"text",pattern:"[A-Za-z]{12}",inputProps:{title:"Letters only, max length 12",placeholder:"New username"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),r.a.createElement(ft,{align:"left"},r.a.createElement(M.a,{gutterBottom:!0,variant:"h5"},r.a.createElement($.a,{size:"small",variant:"outlined",color:"primary",onClick:this.updateUsername.bind(this)},"Update"))))))):r.a.createElement("h1",null," Loading "))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),gt=vt=Object(O.a)(vt);h.firestore();var yt=Object(O.a)((function(e){return r.a.createElement(Y.a,{onClick:function(){e.openSetting(e.info.id)}},r.a.createElement(_.a,{align:"left",colSpan:2},e.info.title))})),bt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,currentPage:"home"},n.settings=[{id:"change username",title:"Change Username"},{id:"change password",title:"Change Password"},{id:"delete account",title:"Delete Account"}],n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"openSetting",value:function(e){console.log("clicked ",e),this.setState({currentPage:e})}},{key:"handleBack",value:function(){this.setState({currentPage:"home"})}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},"home"===this.state.currentPage?r.a.createElement(J.a,null,r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,{align:"center",colSpan:2},r.a.createElement(M.a,{gutterBottom:!0,variant:"h3"},"Settings")))),r.a.createElement(q.a,null,this.settings.map((function(t,a){return r.a.createElement(yt,{key:a,info:t,openSetting:e.openSetting.bind(e)})})))):"change password"===this.state.currentPage?r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(mt,{user:this.state.user}))):"delete account"==this.state.currentPage?r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(dt,{user:this.state.user}))):"change username"===this.state.currentPage?r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{style:{color:this.props.theme.palette.text.primary},onClick:this.handleBack.bind(this)},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(gt,{userMD:this.state.userMD,onAlert:this.props.onAlert}))):r.a.createElement("span",null,"Default"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.userMD.currentPage!==t.userMD.currentPage||t.user?t:e}}]),a}(n.Component),Et=bt=Object(O.a)(bt),xt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={redirect:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(e){var t=document.getElementById("email"),a=document.getElementById("password"),n=document.getElementById("passwordConfirm");console.log(t.value,a.value),a.value===n.value?h.auth().createUserWithEmailAndPassword(t.value,a.value).then((function(e){console.log(e);var t=h.firestore(),a={username:"",admin:!1,uid:e.user.uid,accountType:"athlete"};t.collection("users").doc(e.user.uid).set(a)})).catch((function(e){console.log(e)})):alert("Passwords do not match")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.redirect?r.a.createElement(f.a,{to:"/"}):r.a.createElement(v.a,{container:!0,xs:12,id:"login",align:"center",justify:"center"},r.a.createElement(k.a,{elevation:2},r.a.createElement("br",null),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement("h1",null,"Register")),r.a.createElement("br",null),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(me.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(me.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(me.a,{id:"passwordConfirm",type:"password",style:{margin:8},placeholder:"Confirm Password",margin:"normal",InputLabelProps:{shrink:!0}})," ",r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement($.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Submit")))))}}]),a}(n.Component),wt=xt=Object(O.a)(xt),Ct=(h.database(),Object(x.a)((function(e){return{root:{marginTop:"2.5vh",marginBottom:"2.5vh"}}}))(v.a)),Dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,r;return Object(i.a)(this,a),(r=t.call(this,e)).state=(n={open:e.open,wodInfo:e.wodInfo,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes},Object(oe.a)(n,"open",e.open),Object(oe.a)(n,"onClose",e.onClose),n),r}return Object(l.a)(a,[{key:"editWOD",value:function(){var e=this;this.props.onClose(),function(e){var t=h.firestore();return console.log("Edit wod"),console.log(e),new Promise((function(a,n){t.collection("wods").doc(e.gymClassID).collection("wods").doc(e.wodID).update(e).then((function(){a("Finished updating.")})).catch((function(e){n(e)}))}))}(this.state.wodInfo).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"handleValChange",value:function(e){var t=this.state.wodInfo,a=e.target,n=a.name,r=a.value;t[n]=r,this.setState({wodInfo:t})}},{key:"render",value:function(){return r.a.createElement(ge.a,{open:this.state.open,onClose:this.props.onClose,"aria-labelledby":"edit-wod-modal","aria-describedby":"edit-wod"},r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"80vw",transform:"translate(-50%, -50%)"}},r.a.createElement(v.a,{item:!0,align:"center",xs:12},r.a.createElement(k.a,{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement(M.a,{variant:"h6"},"Edit Wod (",this.state.wodInfo.wodID,")"),r.a.createElement(Ct,{item:!0,xs:12},r.a.createElement(me.a,{type:"text",name:"title",style:{margin:8},value:this.state.wodInfo.title,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}})),r.a.createElement(Ct,{item:!0,xs:12},r.a.createElement(me.a,{type:"text",name:"wodText",style:{margin:8},value:this.state.wodInfo.wodText,onChange:this.handleValChange.bind(this),pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Workout here"},margin:"normal",color:"primary",multiline:!0,rows:5,InputLabelProps:{shrink:!0}})),r.a.createElement(Ct,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{variant:"outlined",color:"primary",onClick:this.props.onClose},"Cancel")),r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{variant:"outlined",color:"primary",onClick:this.editWOD.bind(this)},"Update")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),kt=Dt=Object(O.a)(Dt),Ot=h.firestore();function Mt(e,t){var a=Ot.collection("notifications").doc("admins").collection("invites");return new Promise((function(n,r){console.log("idAdmin?"),St(e,t.gymClassID).then((function(o){o?n("Already an admin."):(console.log("isSent?"),function(e,t){return new Promise((function(a,n){console.log("isSent: start"),Ot.collection("notifications").doc("admins").collection("invites").where("uid","==",e).where("gymClassID","==",t).get().then((function(e){console.log("isSent: snapshot"),e.empty?a(!1):a(!0)}),(function(e){n(e)}))}))}(e,t.gymClassID).then((function(e){if(e)n("Admin notified already.");else{console.log("Setting adminf notify data");var o=a.doc();o.set(Object(I.a)(Object(I.a)({},t),{},{adminInviteID:o.id})).then((function(){n("Sent admin invite.")})).catch((function(e){r(e)}))}})).catch((function(e){r(e)})))}))}))}function St(e,t){return new Promise((function(a,n){Ot.collection("classAdmins").where("gymClassID","==",t).get().then((function(t){t.empty||t.forEach((function(t){t.data().uid==e&&a(!0)})),a(!1)}),(function(e){n(e)}))}))}var It=a(345),jt=(h.firestore(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={filteredUsers:e.filteredUsers},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement(ge.a,{open:this.props.modalOpen,onClose:this.props.onModalClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",width:"90vw",transform:"translate(-50%, -50%)"}},r.a.createElement(k.a,{style:{padding:"8px",display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement(v.a,{item:!0,container:!0,align:"center",xs:12},r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"16px"}},r.a.createElement(M.a,{variant:"h6"},this.props.title)),r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"16px"}},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",onChange:this.props.onChange.bind(this),placeholder:"Search Users",style:{margin:"0px 0px 8px 0px"},InputProps:{endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(Se.a,{color:"primary"}))}})),r.a.createElement(v.a,{item:!0,xs:12,style:{marginTop:"16px"}},r.a.createElement(It.a,{native:!0,style:{width:"100%",margin:"0px 0px 8px 0px",padding:"4px"},color:"primary",onChange:this.props.onSelectChange.bind(this)},this.state.filteredUsers?this.state.filteredUsers.map((function(e,t){return r.a.createElement("option",{key:t,value:JSON.stringify(e)},e.username)})):r.a.createElement("option",{"aria-label":"None",value:""},"No users!"))),r.a.createElement(v.a,{item:!0,xs:6,style:{margin:"16px 0px 16px 0px"}},r.a.createElement($.a,{fullWidth:!0,style:{borderColor:this.props.theme.palette.text.primary},size:"small",onClick:this.props.onModalClose},"Cancel")),r.a.createElement(v.a,{item:!0,xs:6,style:{marginTop:"16px"}},r.a.createElement($.a,{fullWidth:!0,color:"primary",size:"small",onClick:this.props.sendInvite.bind(this)},"Invite"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),At=jt=Object(O.a)(jt),Tt=h.firestore(),Lt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,gymClassMD:e.gymClassMD,allUsers:[],filteredUsers:[],selectedUser:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.listener=Tt.collection("users").onSnapshot((function(t){var a=[];t.empty?e.setState({allUsers:a,filteredUsers:a,selectedUser:{}}):(t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.username>t.username?1:-1})),e.setState({allUsers:a,filteredUsers:a,selectedUser:a[0]}))}))}},{key:"componentWillUnmount",value:function(){this.listener&&this.listener()}},{key:"onChange",value:function(e){var t=e.target.value;console.log(t);var a=this.state.allUsers.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredUsers:a,selectedUser:a[0]})}},{key:"sendInvite",value:function(){var e=this;if(this.state.selectedUser){console.log("Send invite to ".concat(this.state.selectedUser.uid," from ").concat(this.state.userMD.uid));var t={msg:"Accept invite?",gymClassID:this.state.gymClassMD.gymClassID,senderUID:this.state.userMD.uid,senderUsername:this.state.userMD.username,gymClassTitle:this.state.gymClassMD.title,boxTitle:this.state.gymClassMD.boxTitle,boxID:this.state.gymClassMD.boxID,uid:this.state.selectedUser.uid,date:Date.now()};this.props.onModalClose(),console.log("Sending data"),console.log(t),Mt(this.state.selectedUser.uid,t).then((function(t){e.props.onAlert({type:"success",message:String(t)})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}}},{key:"onSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.setState({selectedUser:t})}},{key:"render",value:function(){return r.a.createElement(At,Object(oe.a)({modalOpen:this.state.open,title:"Invite Admin",onChange:this.onChange.bind(this),onSelectChange:this.onSelectChange.bind(this),onModalClose:this.props.onModalClose,sendInvite:this.sendInvite.bind(this),filteredUsers:this.state.filteredUsers},"modalOpen",this.props.modalOpen))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Pt=Lt=Object(O.a)(Lt),Bt=h.firestore();function Ut(e,t){var a=Bt.collection("notifications").doc("members").collection("invites");return new Promise((function(n,r){console.log("isMember"),Ft(e,t.gymClassID).then((function(o){o?n("Already a member."):(console.log("isSent"),function(e,t){return new Promise((function(a,n){Bt.collection("notifications").doc("members").collection("invites").where("uid","==",e).where("gymClassID","==",t).get().then((function(n){console.log(e,t),console.log(n.docs),n.empty?a(!1):a(!0)}),(function(e){n(e)}))}))}(e,t.gymClassID).then((function(e){if(e)n("Member notified already.");else{console.log("Creating notification");var o=a.doc();o.set(Object(I.a)(Object(I.a)({},t),{},{memberInviteID:o.id})).then((function(){n("Sent member invite.")})).catch((function(e){r(e)}))}})).catch((function(e){r(e)})))}))}))}function Ft(e,t){return new Promise((function(a,n){Bt.collection("classMembers").where("gymClassID","==",t).get().then((function(t){console.log(t),t.empty||t.forEach((function(t){t.data().uid==e&&a(!0)})),a(!1)}),(function(e){n(e)}))}))}var Rt=h.firestore(),Wt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,gymClassMD:e.gymClassMD,allUsers:[],filteredUsers:[],selectedUser:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;Rt.collection("users").onSnapshot((function(t){var a=[];t.empty?e.setState({allUsers:a,filteredUsers:a,selectedUser:{}}):(t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.username>t.username?1:-1})),e.setState({allUsers:a,filteredUsers:a,selectedUser:a[0]}))}))}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.allUsers.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredUsers:a,selectedUser:a[0]})}},{key:"sendInvite",value:function(){var e=this;if(this.state.selectedUser){var t={msg:"Accept invite?",gymClassID:this.state.gymClassMD.gymClassID,senderUID:this.state.userMD.uid,senderUsername:this.state.userMD.username,gymClassTitle:this.state.gymClassMD.title,boxTitle:this.state.gymClassMD.boxTitle,boxID:this.state.gymClassMD.boxID,uid:this.state.selectedUser.uid,date:Date.now()};this.props.onModalClose(),console.log("Send invite to ".concat(this.state.selectedUser.uid," from ").concat(this.state.userMD.uid)),Ut(this.state.selectedUser.uid,t).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}}},{key:"onSelectChange",value:function(e){var t=JSON.parse(e.target.value);console.log(t),this.setState({selectedUser:t})}},{key:"render",value:function(){return r.a.createElement(At,Object(oe.a)({modalOpen:this.state.open,title:"Invite Member",onChange:this.onChange.bind(this),onSelectChange:this.onSelectChange.bind(this),onModalClose:this.props.onModalClose,sendInvite:this.sendInvite.bind(this),filteredUsers:this.state.filteredUsers},"modalOpen",this.props.modalOpen))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Nt=Wt=Object(O.a)(Wt);h.firestore();var Vt=Object(O.a)((function(e){return console.log(e),r.a.createElement(Y.a,null,r.a.createElement(_.a,{align:"left"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},e.info.username)),r.a.createElement(_.a,{align:"right"},e.isOwner?r.a.createElement($.a,{onClick:function(){e.handleRemoveAdmin(e.info)}},r.a.createElement(te.a,{color:"error"})):r.a.createElement(r.a.Fragment,null)))}));var Gt=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(_.a,{colSpan:3,align:"center"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"No Admins!")))})),zt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassID:e.gymClassID,isOwner:e.isOwner,filteredAdmins:e.filteredAdmins,admins:e.admins,showRemoveAlert:!1,removeClassAdmin:{}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.admins.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredAdmins:a})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveAdmin",value:function(e){console.log("remove admin w/ data: ",e),this.setState({removeClassAdmin:e,showRemoveAlert:!0})}},{key:"onRemoveAdmin",value:function(){var e,t=this;this.setState({showRemoveAlert:!1}),(e=this.state.removeClassAdmin,Promise.all([Ot.collection("classAdmins").doc(e.classAdminID).delete(),Ot.collection("classAdminsShallow").doc(e.gymClassID).collection("users").doc(e.uid).delete()])).then((function(e){t.props.onAlert({type:"success",message:"Removed admin!"})})).catch((function(e){t.props.onAlert({type:"error",message:e.message})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},r.a.createElement(k.a,{elevation:2,component:"form"},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",inputProps:{style:{fontSize:"0.8em"}},onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Admins",InputProps:{startAdornment:r.a.createElement(Oe.a,{position:"start"},r.a.createElement(Se.a,{color:"primary"}))}}),r.a.createElement(H.a,null,r.a.createElement(J.a,{stickyHeader:!0,size:"small"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Admin Username"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.filteredAdmins.length>0?this.state.filteredAdmins.map((function(t,a){return r.a.createElement(Vt,{key:a,info:t,handleRemoveAdmin:e.handleRemoveAdmin.bind(e),isOwner:e.props.isOwner})})):r.a.createElement(Gt,null))))))),r.a.createElement(be,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.onRemoveAdmin.bind(this),modalText:"Remove admin, ".concat(this.state.removeUsername,"?"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.admins.length>0?t:e}}]),a}(n.Component),Kt=zt=Object(O.a)(zt);h.firestore();var Ht=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(_.a,{align:"left"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},e.info.username)),r.a.createElement(_.a,{align:"right"},e.isOwner?r.a.createElement($.a,{onClick:function(){e.handleRemoveMember(e.info)}},r.a.createElement(te.a,{color:"error"})):r.a.createElement(r.a.Fragment,null)))}));var Jt=Object(O.a)((function(e){return r.a.createElement(Y.a,null,r.a.createElement(_.a,{colSpan:3,align:"center"},r.a.createElement(M.a,{variant:"subtitle1",color:"primary"},"No Members!")))})),Zt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassID:e.gymClassID,isOwner:e.isOwner,filteredMembers:e.filteredMembers,members:e.members,showRemoveAlert:!1,classMember:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){e.keyCode||e.which}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.members.filter((function(e){return e.username.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredMembers:a})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveMember",value:function(e){this.setState({classMember:e,showRemoveAlert:!0})}},{key:"onRemoveMember",value:function(){var e,t=this;this.setState({showRemoveAlert:!1}),console.log("Remvoing"),console.log(this.state.classMember),(e=this.state.classMember,Promise.all([Bt.collection("classMembers").doc(e.classMemberID).delete(),Bt.collection("classMembersShallow").doc(e.gymClassID).collection("users").doc(e.uid).delete()])).then((function(e){t.props.onAlert({type:"success",message:"Removed member!"})})).catch((function(e){t.props.onAlert({type:"error",message:e})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"0px 0px 8px 0px"}},r.a.createElement(k.a,{elevation:2,component:"form"},r.a.createElement(me.a,{fullWidth:!0,variant:"outlined",inputProps:{style:{fontSize:"0.8em"}},onKeyUp:this.onKeyUp.bind(this),onChange:this.onChange.bind(this),placeholder:"Search Members",InputProps:{startAdornment:r.a.createElement(Oe.a,{position:"start"},r.a.createElement(Se.a,{color:"primary"}))}}),r.a.createElement(H.a,null,r.a.createElement(J.a,{stickyHeader:!0,size:"small"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Member Username"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.filteredMembers.length>0?this.state.filteredMembers.map((function(t,a){return r.a.createElement(Ht,{key:a,info:t,handleRemoveMember:e.handleRemoveMember.bind(e),isOwner:e.props.isOwner})})):r.a.createElement(Jt,null))))))),r.a.createElement(be,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.onRemoveMember.bind(this),modalText:"Remove member, ".concat(this.state.classMember.username,"?"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.members.length>0?t:e}}]),a}(n.Component),Yt=Zt=Object(O.a)(Zt),_t=(h.firestore(),["reps","rounds","time","total"]),qt=Object(x.a)({root:{borderBottom:"none"}})(_.a),Qt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={gymClassMD:e.gymClassMD,titleForm:"",scoreTypeForm:_t[0],wodTextForm:""},n}return Object(l.a)(a,[{key:"onTitleChange",value:function(e){console.log(e.target.value);var t=e.target.value;this.setState({titleForm:t})}},{key:"onScoreTypeSelectChange",value:function(e){console.log(e.target.value);var t=e.target.value;this.setState({scoreTypeForm:t})}},{key:"onWodTextChange",value:function(e){var t=e.target.value;this.setState({wodTextForm:t})}},{key:"createWOD",value:function(){var e=this,t=this.state.gymClassMD.boxID,a=this.state.gymClassMD.boxTitle,n=this.state.gymClassMD.gymClassID,r=this.state.gymClassMD.title,o=this.state.titleForm,s=this.state.scoreTypeForm,i=this.state.wodTextForm;if(console.log("Creating Wod"),console.log(t,n,o,s,i),!t||!n||!o||!s||!i)return console.log("Error with input createWod"),void console.log(t,n,o,s,i);xe({boxID:t,gymClassID:n,title:o,scoreType:s,wodText:i,boxTitle:a,gymClassTitle:r}).then((function(t){e.props.onAlert({type:"success",message:"Added workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(H.a,null,r.a.createElement(J.a,null,r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(qt,{colSpan:2,align:"center"},"Add Workout"))),r.a.createElement(q.a,null,r.a.createElement(Y.a,null,r.a.createElement(qt,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Score Type")),r.a.createElement(qt,null,r.a.createElement(It.a,{native:!0,style:{width:"100%"},onChange:this.onScoreTypeSelectChange.bind(this),inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},_t.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e.replace(e[0],e[0].toUpperCase()))}))))),r.a.createElement(Y.a,null,r.a.createElement(qt,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Title")),r.a.createElement(qt,null,r.a.createElement(me.a,{id:"ownerBoxAddWodTitle",type:"text",onChange:this.onTitleChange.bind(this),style:{width:"100%"},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),r.a.createElement(Y.a,null,r.a.createElement(qt,{colSpan:2,align:"center"},r.a.createElement(M.a,{color:"primary",variant:"caption"},"Workout"))),r.a.createElement(Y.a,null,r.a.createElement(qt,{colSpan:2},r.a.createElement(me.a,{id:"wodText",type:"text",style:{width:"100%"},onChange:this.onWodTextChange.bind(this),inputProps:{title:"Enter workout",placeholder:"workout"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0},multiline:!0,rows:12}))),r.a.createElement(Y.a,null,r.a.createElement(qt,{colSpan:2,align:"center"},r.a.createElement($.a,{variant:"outlined",color:"primary",size:"small",onClick:this.createWOD.bind(this)},"Submit")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Xt=Qt=Object(O.a)(Qt),$t=h.firestore(),ea=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,boxID:e.boxID,gymClassID:e.gymClassID,gymClassMD:{},gymClasses:[],userBoxes:[],hasBoxes:!1,wods:[],currentWodID:"",currentWodMD:{},showRemoveAlert:!1,showEditModal:!1,editWodInfo:{},curRemovewodInfo:{},inviteModalOpen:!1,inviteMemberModalOpen:!1,admins:[],adminUids:[],members:[],memberUids:[],showAdminList:!1,showMemberList:!1,isAdmin:!1,isMember:!1,showAddWod:!1},n}return Object(l.a)(a,[{key:"getGymClassListener",value:function(){var e=this;this.gymClassListener||(this.gymClassListener=$t.collection("gymClasses").doc(this.state.boxID).collection("classes").doc(this.state.gymClassID).onSnapshot((function(t){t.exists&&e.setState({gymClassMD:t.data()})})))}},{key:"getUserBoxListener",value:function(){var e=this;this.state.userMD.uid&&!this.userBoxesListener&&(this.userBoxesListener=$t.collection("boxes").where("uid","==",this.state.userMD.uid).onSnapshot((function(t){var a=[];t.empty||t.forEach((function(e){a.push(e.data())})),e.setState({userBoxes:a,hasBoxes:!!a.length})})))}},{key:"getAdminListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.adminListener&&(this.adminListener=(e=this.state.gymClassID,Ot.collection("classAdmins").where("gymClassID","==",e)).onSnapshot((function(e){var a=[],n=[];if(e.empty)t.setState({admins:a,adminUids:n,isAdmin:!1});else{e.docs.forEach((function(e){a.push(e.data()),n.push(e.data().uid)}));var r=n.indexOf(t.state.userMD.uid)>=0;t.setState({admins:a,adminUids:n,isAdmin:r})}}),(function(e){console.log(e)})))}},{key:"getMemberListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.memberListener&&(this.memberListener=(e=this.state.gymClassID,Bt.collection("classMembers").where("gymClassID","==",e)).onSnapshot((function(e){var a=[],n=[];if(e.empty)t.setState({members:a,memberUids:n,isMember:!1});else{e.docs.forEach((function(e){a.push(e.data()),n.push(e.data().uid)}));var r=n.indexOf(t.state.userMD.uid)>=0;t.setState({members:a,memberUids:n,isMember:r})}}),(function(e){console.log(e)})))}},{key:"getWodListener",value:function(){var e=this;console.log("Getting wods for user: ".concat(this.state.gymClassID)),this.wodListener||(this.wodListener=function(e){var t=Ee.collection("wods").doc(e).collection("wods");return console.log(t),t}(this.state.gymClassID).onSnapshot((function(t){if(console.log(t),t.empty)e.setState({wods:[]});else{var a=[];t.forEach((function(e){a.push(e.data())})),e.setState({wods:a})}}),(function(t){console.log(t),e.wodListener(),e.wodListener=void 0})))}},{key:"checkListeners",value:function(){this.userBoxesListener||this.getUserBoxListener(),this.adminListener||this.getAdminListener(),this.memberListener||this.getMemberListener()}},{key:"componentDidMount",value:function(){this.checkListeners(),this.getGymClassListener(),this.getWodListener()}},{key:"componentDidUpdate",value:function(){this.checkListeners()}},{key:"componentWillUnmount",value:function(){this.adminListener&&this.adminListener(),this.memberListener&&this.memberListener(),this.userBoxesListener&&this.userBoxesListener(),this.wodListener&&this.wodListener(),this.gymClassListener&&this.gymClassListener()}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"handleRemoveWod",value:function(e){this.setState({showRemoveAlert:!0,curRemovewodInfo:e})}},{key:"deleteWod",value:function(){var e=this;this.setState({showRemoveAlert:!1}),we(this.state.curRemovewodInfo).then((function(t){e.props.onAlert({type:"success",message:"Deleted workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"onChange",value:function(e){var t=e.target.value,a=this.state.wods.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));this.setState({filteredWods:a})}},{key:"handleEdit",value:function(e){this.userBoxesListener||this.getUserBoxListener(),this.setState({editWodInfo:e,showEditModal:!0})}},{key:"handleEditModalClose",value:function(){this.setState({showEditModal:!1})}},{key:"isOwner",value:function(){return this.state.gymClassMD.uid===this.state.userMD.uid}},{key:"openAdminInvite",value:function(){this.setState({inviteModalOpen:!0})}},{key:"openMemberInvite",value:function(){this.setState({inviteMemberModalOpen:!0})}},{key:"onInviteModalClose",value:function(){this.setState({inviteModalOpen:!1})}},{key:"onInviteMemberModalClose",value:function(){this.setState({inviteMemberModalOpen:!1})}},{key:"empty",value:function(e){return e&&0===Object.keys(e).length&&e.constructor===Object}},{key:"openViewAdmins",value:function(){this.setState({showAdminList:!0})}},{key:"openViewMembers",value:function(){this.setState({showMemberList:!0})}},{key:"closeDetailView",value:function(){this.setState({showAdminList:!1,showMemberList:!1,showAddWod:!1})}},{key:"isAdmin",value:function(){return(this.state.isAdmin||this.isOwner())&&this.state.userMD}},{key:"isMember",value:function(){return(this.state.isMember||this.isAdmin())&&this.state.userMD}},{key:"isOnlyMember",value:function(){return this.state.isMember&&this.state.userMD&&!this.isAdmin()}},{key:"toggleShowAddWod",value:function(){this.setState({showAddWod:!0})}},{key:"render",value:function(){var e=this.isOnlyMember()?12:6;return this.empty(this.state.userMD)||this.empty(this.state.gymClassMD)?r.a.createElement(r.a.Fragment,null,"Loading"):this.state.gymClassMD.isPrivate&&!this.isMember()?r.a.createElement(v.a,{item:!0,xs:12,align:"center"},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,null,"This is a Private Class"))):this.state.showAdminList&&this.isAdmin()?r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Kt,{gymClassID:this.state.gymClassID,filteredAdmins:this.state.admins,admins:this.state.admins,isOwner:this.isAdmin(),onAlert:this.props.onAlert}))):this.state.showMemberList&&this.isMember()?r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Yt,{gymClassID:this.state.gymClassID,filteredMembers:this.state.members,members:this.state.members,isOwner:this.isAdmin(),onAlert:this.props.onAlert}))):this.state.showAddWod?r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ue.a,{onClick:this.closeDetailView.bind(this),style:{color:this.props.theme.palette.text.primary}},r.a.createElement(ct.a,null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Xt,{gymClassMD:this.state.gymClassMD,onAlert:this.props.onAlert}))):r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,align:"center",xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,{align:"center",variant:"h3"},this.state.gymClassMD.title),r.a.createElement(M.a,{align:"center",variant:"h6"},this.state.gymClassMD.boxTitle))),r.a.createElement(v.a,{item:!0,container:!0,spacing:1,xs:12,style:{marginTop:"16px"}},this.isAdmin()?r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{color:"primary",variant:"outlined",style:{width:"100%"},onClick:this.openAdminInvite.bind(this)},"Invite Admin")),r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{color:"primary",variant:"outlined",style:{width:"100%"},onClick:this.openViewAdmins.bind(this)},"View Admins")),r.a.createElement(Pt,{userMD:this.state.userMD,gymClassMD:this.state.gymClassMD,onModalClose:this.onInviteModalClose.bind(this),modalOpen:this.state.inviteModalOpen,onAlert:this.props.onAlert})):r.a.createElement(r.a.Fragment,null),this.isMember()?r.a.createElement(r.a.Fragment,null,this.isOnlyMember()?r.a.createElement(r.a.Fragment,null):r.a.createElement(v.a,{item:!0,xs:6},r.a.createElement($.a,{color:"secondary",variant:"outlined",style:{width:"100%"},onClick:this.openMemberInvite.bind(this)},"Invite Member")),r.a.createElement(v.a,{item:!0,xs:e},r.a.createElement($.a,{color:"secondary",variant:"outlined",style:{width:"100%"},onClick:this.openViewMembers.bind(this)},"View Members")),r.a.createElement(Nt,{userMD:this.state.userMD,gymClassMD:this.state.gymClassMD,onModalClose:this.onInviteMemberModalClose.bind(this),modalOpen:this.state.inviteMemberModalOpen,onAlert:this.props.onAlert})):r.a.createElement(r.a.Fragment,null),this.isAdmin()&&this.state.gymClassMD?r.a.createElement($.a,{color:"primary",variant:"outlined",fullWidth:!0,onClick:this.toggleShowAddWod.bind(this)},"Add Workout"):r.a.createElement(r.a.Fragment,null)),r.a.createElement(k.a,{elevation:6,style:{padding:"8px"}},r.a.createElement(Ze,{rows:this.state.wods,filteredRows:this.state.wods,headers:(this.isOwner(),[{id:"date",sortable:!0,label:"Date"},{id:"title",sortable:!0,label:"Title"},{id:"title2",sortable:!0,label:""},{id:"btns",sortable:!1,label:""}]),handleRemove:this.handleRemoveWod.bind(this),handleEdit:this.handleEdit.bind(this),showOwnerBtns:this.isAdmin()})),r.a.createElement(be,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteWod.bind(this),modalText:"Remove ".concat(this.state.curRemoveWodTitle," (").concat(this.state.curRemoveWodID,")?"),actionText:"Delete",cancelText:"Cancel"}),r.a.createElement(kt,{open:this.state.showEditModal,onClose:this.handleEditModalClose.bind(this),userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,wodInfo:this.state.editWodInfo,onAlert:this.props.onAlert}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.userMD?t:e}}]),a}(n.Component),ta=ea=Object(O.a)(ea),aa=a(323),na=a(347),ra=(a(156),a(331)),oa=a(346),sa=a(332),ia=(a(259),h.firestore());function la(e){var t=["notifications/admins/invites","notifications/members/invites","classAdmins","classMembers","gymClasses/".concat(e,"/classes"),"wods","scores","boxes"].map((function(t){return new Promise((function(a,n){!function e(t,a,n,r,o){var s=ia.batch();ia.collection(t).where(a,"==",n).get().then((function(i){var l=0;i.forEach((function(e){s.delete(e.ref),l++})),s.commit().then((function(){l>=500&&e(t,a,n,r,o)})).catch((function(e){return o(0)}))})),r(1)}(t,"boxID",e,a,n)}))}));return t.push(new Promise((function(t,a){!function e(t,a,n,r,o){var s=ia.batch();ia.collection(t).where(a,"==",n).get().then((function(i){var l=0;i.forEach((function(e){s.update(e.ref,{boxID:""}),l++})),s.commit().then((function(){l>=500&&e(t,a,n,r,o)})).catch((function(e){return o(0)}))})),r(1)}("following","boxID",e,t,a)}))),Promise.all(t)}var ca=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,currentBoxID:"",showRemoveAlert:!1,curRemoveBoxID:"",curRemoveBoxTitle:""},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){console.log("Component will unmount")}},{key:"handleRemoveBox",value:function(e,t){this.setState({showRemoveAlert:!0,curRemoveBoxID:e,curRemoveBoxTitle:t})}},{key:"handleModalClose",value:function(){this.setState({showRemoveAlert:!1})}},{key:"deleteBox",value:function(){var e=this;this.handleModalClose(),la(this.state.curRemoveBoxID).then((function(t){e.props.onAlert({type:"success",message:"Removed gym!"})})).catch((function(t){e.props.onAlert({type:"error",message:t})}))}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},this.state.userBoxes.length>0?r.a.createElement(ot,{userMD:this.state.userMD,allBoxes:this.state.userBoxes,filteredBoxes:this.state.userBoxes,handleRemoveBox:this.handleRemoveBox.bind(this),isOwner:!0,onAlert:this.props.onAlert}):r.a.createElement(v.a,{item:!0,zeroMinWidth:!0,xs:12},r.a.createElement(k.a,{elevation:4,style:{padding:"1vw"}},r.a.createElement(M.a,{noWrap:!0,align:"left"},"No gyms Found!")))),r.a.createElement(be,{open:this.state.showRemoveAlert,onClose:this.handleModalClose.bind(this),onAction:this.deleteBox.bind(this),modalText:"Remove ".concat(this.state.curRemoveBoxTitle," (").concat(this.state.curRemoveBoxID,")"),actionText:"Remove",cancelText:"Cancel"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return console.log(e),e}}]),a}(n.Component),ua=ca=Object(O.a)(ca),ma=a(350),ha=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(_.a)),da=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,title:"",box:e.userBoxes[0],isPrivate:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){13==(e.keyCode||e.which)&&this.createGymClass()}},{key:"createGymClass",value:function(){var e=this,t=this.state.title,a=this.state.box,n=this.state.isPrivate;console.log("Creating class"),console.log(t,a,n),t&&a&&null!==n&&function(e,t,a,n,r){return new Promise((function(o,s){Ie.collection("gymClasses").doc(a).collection("classes").where("title","==",e).get().then((function(i){if(i.empty){var l,c=Ie.collection("gymClasses").doc(a).collection("classes").doc();Ie.collection("classOwners").doc(c.id).collection("users").doc(t).set({owner:t,boxID:a,gymClassID:c.id,isPrivate:r}),c.set((l={gymClassID:c.id,boxID:a,boxTitle:n,title:e,uid:t},Object(oe.a)(l,"uid",t),Object(oe.a)(l,"isPrivate",r),Object(oe.a)(l,"date",Date.now()),l)).then((function(){o("Added gymClass")})).catch((function(e){s(e)}))}else o("Name Taken")})).catch((function(e){s(e)}))}))}(t,this.props.userMD.uid,a.boxID,a.title,n).then((function(t){e.props.onAlert({type:"success",message:"Added class!"})})).catch((function(t){e.props.onAlert({type:"error",message:t})}))}},{key:"handleCheckboxChange",value:function(e){var t=e.target.checked;this.setState({isPrivate:t})}},{key:"onTitleChange",value:function(e){console.log(e.target.value),this.setState({title:e.target.value})}},{key:"onSelectChange",value:function(e){console.log(e.target.value),this.setState({box:JSON.parse(e.target.value)})}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(J.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null,r.a.createElement(ha,null,"Gym"),r.a.createElement(ha,null,r.a.createElement(It.a,{native:!0,style:{width:"100%"},onChange:this.onSelectChange.bind(this),inputProps:{name:"Box",id:"addGymClassBox"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return r.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):r.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),r.a.createElement(Y.a,null,r.a.createElement(ha,null,"Title"),r.a.createElement(ha,null,r.a.createElement(me.a,{id:"addGymClassTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",onChange:this.onTitleChange.bind(this),inputProps:{title:"Letters only, max length 35",placeholder:"Name of class"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),r.a.createElement(Y.a,null,r.a.createElement(ha,null,"Private"),r.a.createElement(ha,null,r.a.createElement(ma.a,{checked:this.state.isPrivate,onChange:this.handleCheckboxChange.bind(this)}))),r.a.createElement(Y.a,null,r.a.createElement(ha,{align:"center",colSpan:2},r.a.createElement($.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){e.createGymClass()}},"Submit"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),pa=da=Object(O.a)(da),fa=(h.firestore(),["reps","rounds","time","total"]),va=Object(x.a)({root:{borderBottom:"none"}})(_.a),ga=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userBoxes:e.userBoxes,hasBoxes:e.hasBoxes,gymClasses:[],box:e.userBoxes[0],gymClass:{},titleForm:"",scoreTypeForm:fa[0],wodTextForm:""},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){!this.gymClassListener&&this.state.userBoxes&&this.setGymClassListner(this.state.userBoxes[0].boxID)}},{key:"setGymClassListner",value:function(e){var t=this;this.gymClassListener=je(e).onSnapshot((function(e){if(e.empty)t.setState({gymClasses:[]});else{var a=[];e.forEach((function(e){a.push(e.data())}));var n=a[0];t.setState({gymClasses:a,gymClass:n})}}),(function(e){console.log(e)}))}},{key:"componentWillUnmount",value:function(){this.gymClassListener&&this.gymClassListener()}},{key:"onBoxSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.gymClassListener&&this.gymClassListener(),this.setGymClassListner(t.boxID),this.setState({box:t})}},{key:"onClassSelectChange",value:function(e){var t=JSON.parse(e.target.value);this.setState({gymClass:t})}},{key:"onTitleChange",value:function(e){var t=e.target.value;this.setState({titleForm:t})}},{key:"onScoreTypeSelectChange",value:function(e){var t=e.target.value;this.setState({scoreTypeForm:t})}},{key:"onWodTextChange",value:function(e){var t=e.target.value;this.setState({wodTextForm:t})}},{key:"createWOD",value:function(){var e=this,t=this.state.box.boxID,a=this.state.box.title,n=this.state.gymClass.gymClassID,r=this.state.gymClass.isPrivate,o=this.state.gymClass.title,s=this.state.titleForm,i=this.state.scoreTypeForm,l=this.state.wodTextForm;if(!t||!n||!s||!i||!l)return console.log("Error with input createWod"),void console.log(t,n,s,i,l);xe({boxID:t,gymClassID:n,title:s,scoreType:i,wodText:l,boxTitle:a,gymClassTitle:o,isPrivate:r}).then((function(t){e.props.onAlert({type:"success",message:"Added workout!"})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(H.a,null,r.a.createElement(J.a,null,r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(va,null),r.a.createElement(va,null))),r.a.createElement(q.a,null,r.a.createElement(Y.a,null,r.a.createElement(va,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Box")),r.a.createElement(va,null,r.a.createElement(It.a,{native:!0,style:{width:"100%"},onChange:this.onBoxSelectChange.bind(this),inputProps:{name:"Box",id:"ownerBoxAddWodBoxID"}},this.state.hasBoxes?this.state.userBoxes.map((function(e,t){return r.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):r.a.createElement("option",{"aria-label":"None",value:""},"No boxes!")))),r.a.createElement(Y.a,null,r.a.createElement(va,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Class")),r.a.createElement(va,null,r.a.createElement(It.a,{native:!0,style:{width:"100%"},onChange:this.onClassSelectChange.bind(this),inputProps:{name:"gymClass",id:"AddWodGymClassID"}},this.state.gymClasses.length>0?this.state.gymClasses.map((function(e,t){return r.a.createElement("option",{key:t,value:JSON.stringify(e)},e.title)})):r.a.createElement("option",{"aria-label":"None",value:""},"No Classes!")))),r.a.createElement(Y.a,null,r.a.createElement(va,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Score Type")),r.a.createElement(va,null,r.a.createElement(It.a,{native:!0,style:{width:"100%"},onChange:this.onScoreTypeSelectChange.bind(this),inputProps:{name:"Score Type",id:"ownerBoxAddWodScoreType"}},fa.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e.replace(e[0],e[0].toUpperCase()))}))))),r.a.createElement(Y.a,null,r.a.createElement(va,null,r.a.createElement(M.a,{color:"primary",variant:"caption"},"Title")),r.a.createElement(va,null,r.a.createElement(me.a,{id:"ownerBoxAddWodTitle",type:"text",onChange:this.onTitleChange.bind(this),style:{width:"100%"},pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Title"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0}}))),r.a.createElement(Y.a,null,r.a.createElement(va,{colSpan:2,align:"center"},r.a.createElement(M.a,{color:"primary",variant:"caption"},"Workout"))),r.a.createElement(Y.a,null,r.a.createElement(va,{colSpan:2},r.a.createElement(me.a,{id:"wodText",type:"text",style:{width:"100%"},onChange:this.onWodTextChange.bind(this),inputProps:{title:"Enter workout",placeholder:"workout"},margin:"normal",color:"primary",InputLabelProps:{shrink:!0},multiline:!0,rows:12}))),r.a.createElement(Y.a,null,r.a.createElement(va,{colSpan:2,align:"center"},r.a.createElement($.a,{variant:"outlined",color:"primary",size:"small",onClick:this.createWOD.bind(this)},"Submit")))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),ya=ga=Object(O.a)(ga),ba=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(_.a)),Ea=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onKeyUp",value:function(e){if(13==(e.keyCode||e.which)){var t=document.getElementById("ownerBoxAddBoxTitle").value;this.createBox(t)}}},{key:"createBox",value:function(e){var t=this;e&&function(e,t){return new Promise((function(a,n){ia.collection("boxes").where("title","==",e).get().then((function(r){if(r.empty){var o,s=ia.collection("boxes").doc();s.set((o={boxID:s.id,title:e,uid:t},Object(oe.a)(o,"uid",t),Object(oe.a)(o,"date",Date.now()),o)).then((function(){a("Added box")}))}else n("Name Taken")}))}))}(e,this.props.userMD.uid).then((function(e){t.props.onAlert({type:"success",message:"Added gym!"})})).catch((function(e){t.props.onAlert({type:"error",message:e})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(J.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null,r.a.createElement(ba,null,"Title"),r.a.createElement(ba,null,r.a.createElement(me.a,{id:"ownerBoxAddBoxTitle",type:"text",pattern:"[\\sA-Za-z0-9]{35}",inputProps:{title:"Letters only, max length 35",placeholder:"Name of gym"},onKeyUp:this.onKeyUp.bind(this),margin:"normal",color:"primary",style:{width:"100%"},InputLabelProps:{shrink:!0}}))),r.a.createElement(Y.a,null,r.a.createElement(ba,{align:"center",colSpan:2},r.a.createElement($.a,{size:"small",variant:"outlined",color:"primary",onClick:function(){var t=document.getElementById("ownerBoxAddBoxTitle");e.createBox(t.value)}},"Submit"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),xa=Ea=Object(O.a)(Ea),wa=h.firestore();var Ca=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userBoxes:[],hasBoxes:!1,addBoxProgress:!0,index:0,tabs:{0:"show",1:"hide",2:"hide",3:"hide"}},console.log(e),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.listenForBoxes()}},{key:"componentDidUpdate",value:function(){"owner"===this.state.userMD.accountType&&this.listenForBoxes()}},{key:"componentWillUnmount",value:function(){this.boxListener&&this.boxListener()}},{key:"listenForBoxes",value:function(){var e=this;this.state.user&&!this.boxListener&&(this.boxListener=wa.collection("boxes").where("uid","==",this.state.user.uid).onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(e.data())})),console.log("Setting new state for userBoxes"),e.setState({hasBoxes:!0,userBoxes:a})}),(function(t){e.setState({hasBoxes:!1,userBoxes:[]})})))}},{key:"handleChange",value:function(e,t){console.log(t),this.state.tabs[this.state.index]="hide",this.state.tabs[t]="show",this.setState({index:t,tabs:this.state.tabs})}},{key:"handleChangeIndex",value:function(e){this.setState({index:e})}},{key:"render",value:function(){return console.log(this.state),r.a.createElement(v.a,{item:!0,xs:12,id:"ownerBox"},r.a.createElement(ra.a,{position:"static"},r.a.createElement(oa.a,{value:this.state.index,variant:"fullWidth",selectionFollowsFocus:!0,onChange:this.handleChange.bind(this),"aria-label":"simple tabs example"},r.a.createElement(sa.a,{label:"View Gyms"}),r.a.createElement(sa.a,{label:"Add Workout"}),r.a.createElement(sa.a,{label:"Add Class"}),r.a.createElement(sa.a,{label:"Add Gym"}))),r.a.createElement(v.a,{item:!0,xs:12,style:{minHeight:"50vh",maxHeight:"150vh",overflowY:"scroll"}},this.state.hasBoxes?r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{item:!0,xs:12,className:"".concat(this.state.tabs[0]," slide-left")},r.a.createElement(ua,{user:this.state.user,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert})),r.a.createElement(v.a,{item:!0,xs:12,className:"slide-left ".concat(this.state.tabs[1])},r.a.createElement(ya,{isOwnerView:!0,userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert})),r.a.createElement(v.a,{item:!0,xs:12,className:"slide-right ".concat(this.state.tabs[2])},r.a.createElement(pa,{userMD:this.state.userMD,userBoxes:this.state.userBoxes,hasBoxes:this.state.hasBoxes,onAlert:this.props.onAlert}))):r.a.createElement(r.a.Fragment,null),r.a.createElement(v.a,{item:!0,xs:12,className:"slide-right ".concat(this.state.tabs[3])},r.a.createElement(xa,{userMD:this.state.userMD,onAlert:this.props.onAlert}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Da=Object(O.a)(Ca),ka=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,userFollows:[],userFollowing:{}},n}return Object(l.a)(a,[{key:"extractData",value:function(e){var t=[],a={};return e.forEach((function(e){var n=e.data();t.push(n),a[n.boxID]=n.followID})),[t,a]}},{key:"componentDidMount",value:function(){var e,t=this;this.getFollowers=(e=this.state.user.uid,h.firestore().collection("following").where("uid","==",e)).onSnapshot((function(e){var a=t.extractData(e),n=Object(j.a)(a,2),r=n[0],o=n[1];e.docChanges().forEach((function(e){switch(e.type){case"added":t.setState({userFollows:r,userFollowing:o});break;case"modified":var a=e.doc.data();console.log(a),t.setState({userFollows:r,userFollowing:o});break;case"removed":var n=e.doc.data(),s=t.state.userFollowing;s[n.boxID]=void 0,t.setState({userFollowing:s});break;default:console.log("Uncaught change.")}}))}))}},{key:"componentWillUnmount",value:function(){this.getFollowers&&this.getFollowers()}},{key:"handleFollow",value:function(e){console.log(e),""!==e.boxID&&et(this.state.user.uid,this.state.userMD.username,e.boxID,e.title).then((function(e){console.log("Succefully followed.")})).catch((function(e){console.log(e)}))}},{key:"handleUnfollow",value:function(e){var t=this;$e(this.state.userFollowing[e]).then((function(a){if(a){var n=t.state.userFollowing;n[e]=void 0,t.setState({userFollowing:n}),console.log("Succefully unfollowed.")}})).catch((function(e){console.log(e)}))}},{key:"isUserFollowing",value:function(e){return!!this.state.userFollowing[e]}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,null,"Following")),r.a.createElement(v.a,{item:!0,xs:12},this.state.userFollows.length>0?r.a.createElement(H.a,null,r.a.createElement(J.a,null,r.a.createElement(q.a,null,this.state.userFollows.map((function(t,a){return r.a.createElement(Y.a,{key:a},r.a.createElement(_.a,null,""===t.boxID?r.a.createElement($.a,null,t.title," ",r.a.createElement(M.a,{variant:"caption",component:"span"},"\xa0(deleted)")):r.a.createElement($.a,{to:"box/".concat(t.boxID),component:p.b},t.title)),r.a.createElement(_.a,{align:"right"},e.isUserFollowing(t.boxID)?r.a.createElement(Ue.a,{onClick:function(){e.handleUnfollow(t.boxID)}},r.a.createElement(Xe.a,{color:"primary"})):r.a.createElement(Ue.a,{onClick:function(){e.handleFollow(t)}},r.a.createElement(Xe.a,{style:{fill:e.props.theme.palette.text.primary}}))))}))))):r.a.createElement(r.a.Fragment,null,"Not following anyone!"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Oa=ka=Object(O.a)(ka),Ma=a(333),Sa=(h.database(),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={scores:e.scores,uid:e.uid,showRemoveAlert:!1,removeScoreID:"",redirectUrl:"",redirect:!1},n}return Object(l.a)(a,[{key:"handleViewWod",value:function(e){console.log("Go to wodID: ".concat(e))}},{key:"handleViewBox",value:function(e){console.log("Go to boxID: ".concat(e))}},{key:"showRemoveAlert",value:function(e){this.setState({showRemoveAlert:!0,removeScoreID:e})}},{key:"onRemove",value:function(){var e=this;this.hideRemoveAlert(),de(this.state.removeScoreID).then((function(t){e.props.onAlert({type:"success",message:t})})).catch((function(t){e.props.onAlert({type:"error",message:t.message})}))}},{key:"hideRemoveAlert",value:function(){this.setState({showRemoveAlert:!1})}},{key:"onView",value:function(e){this.setState({redirectUrl:e,redirect:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.scores.length>0?r.a.createElement(H.a,{component:k.a},this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectUrl}):r.a.createElement(r.a.Fragment,null),r.a.createElement(J.a,{"aria-label":"score table"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(_.a,null,"Title"),r.a.createElement(_.a,null,"Score"),r.a.createElement(_.a,null))),r.a.createElement(q.a,null,this.state.scores.map((function(t,a){return r.a.createElement(ja,{key:a,info:t,onViewBox:e.handleViewBox.bind(e),onViewWod:e.handleViewWod.bind(e),onRemove:e.showRemoveAlert.bind(e),onView:e.onView.bind(e)})}))))):r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Q.a,{variant:"outlined",color:"primary"},r.a.createElement(X.a,null,r.a.createElement(M.a,{variant:"h5",component:"h2",gutterBottom:!0},"No Scores!")))),r.a.createElement(be,{open:this.state.showRemoveAlert,actionText:"Remove",cancelText:"Cancel",modalText:"Remove score?",onAction:this.onRemove.bind(this),onClose:this.hideRemoveAlert.bind(this)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component)),Ia=Sa=Object(O.a)(Sa);function ja(e){var t=e.info.score,a=e.info.title,n=e.info.wodID,o=(e.info.uid,e.info.scoreID),s=e.info.gymClassID;return r.a.createElement(Y.a,{onClick:function(t){var a=t.target.tagName;["path","svg"].indexOf(a)>-1||e.onView("wod/".concat(s,"/").concat(n))}},r.a.createElement(_.a,null,a),r.a.createElement(_.a,null,t),r.a.createElement(_.a,{align:"right"},r.a.createElement($.a,{size:"small",onClick:function(){return e.onRemove(o)}},r.a.createElement(Ma.a,{color:"error"}))))}var Aa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,scores:e.scores},n}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:6},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,null,"Scores")),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(Ia,{uid:this.state.user.uid,scores:this.state.scores,onAlert:this.props.onAlert})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ta=Aa=Object(O.a)(Aa),La=a(334),Pa=a(335);h.firestore();var Ba=Object(O.a)((function(e){var t=e.info.senderUsername,a=(e.info.adminInviteID,e.info.gymClassTitle),n=e.info.boxTitle;return r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:8},r.a.createElement(M.a,{variant:"caption"},t," wants you to be an Admin of ",a," at ",n)),r.a.createElement(v.a,{item:!0,xs:2},r.a.createElement(Ue.a,{size:"small",onClick:function(){e.acceptInvite(e.info)},color:"secondary"},r.a.createElement(La.a,null))),r.a.createElement(v.a,{item:!0,xs:2},r.a.createElement(Ue.a,{size:"small",onClick:function(){e.removeNotification(e.info)}},r.a.createElement(Pa.a,{color:"error"}))))})),Ua=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,notifications:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.notificationsListener&&this.notificationsListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD&&!this.notificationsListener&&(this.notificationsListener=(e=this.state.userMD.uid,Ot.collection("notifications").doc("admins").collection("invites").where("uid","==",e)).onSnapshot((function(e){var a=[];e.empty||(e.docs.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({notifications:a})})))}},{key:"onRemoveNotification",value:function(e){(function(e){return new Promise((function(t,a){Ot.collection("notifications").doc("admins").collection("invites").where("uid","==",e.uid).get().then((function(a){a.empty||(a.docs.forEach((function(t){t.data().gymClassID===e.gymClassID&&t.ref.delete()})),t("Removed notifications.")),t("No notifications found.")}),(function(e){a(e)}))}))})(e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"acceptInvite",value:function(e){var t=this,a=e.gymClassID,n=e.gymClassTitle,r=e.boxTitle,o=e.boxID,s=(e.adminInviteID,{gymClassID:a,gymClassTitle:n,boxTitle:r,boxID:o,uid:this.state.userMD.uid,username:this.state.userMD.username,date:Date.now()});(function(e,t,a){return new Promise((function(n,r){St(e,t).then((function(e){if(e)n("User is an admin.");else{var t=Ot.collection("classAdmins").doc(),o=Ot.collection("classAdminsShallow").doc(a.gymClassID).collection("users").doc(a.uid);Promise.all([t.set(Object(I.a)(Object(I.a)({},a),{},{classAdminID:t.id})),o.set({uid:a.uid,gymClassID:a.gymClassID,classAdminID:t.id})]).then((function(){n("Added user as an admin.")})).catch((function(e){r(e)}))}})).catch((function(e){r(e)}))}))})(this.state.userMD.uid,a,s).then((function(a){console.log(a),t.onRemoveNotification(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12},this.state.notifications.length>0?r.a.createElement(k.a,{style:{margin:"16px 0px 0px 0px "}},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,{variant:"subtitle2"},"Admin Notifications")),r.a.createElement(v.a,{item:!0,xs:12},this.state.notifications.map((function(t,a){return r.a.createElement(Ba,{key:a,info:t,removeNotification:e.onRemoveNotification.bind(e),acceptInvite:e.acceptInvite.bind(e)})})))):r.a.createElement(r.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Fa=Ua=Object(O.a)(Ua);h.firestore();var Ra=Object(O.a)((function(e){var t=e.info.senderUsername,a=(e.info.memberInviteID,e.info.gymClassTitle),n=e.info.boxTitle;return r.a.createElement(v.a,{container:!0,item:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:8},r.a.createElement(M.a,{variant:"caption"},t," wants you to be a Member of ",a," at ",n)),r.a.createElement(v.a,{item:!0,xs:2},r.a.createElement(Ue.a,{size:"small",onClick:function(){e.acceptInvite(e.info)},color:"secondary"},r.a.createElement(La.a,null))),r.a.createElement(v.a,{item:!0,xs:2},r.a.createElement(Ue.a,{size:"small",onClick:function(){e.removeNotification(e.info)}},r.a.createElement(Pa.a,{color:"error"}))))})),Wa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,notifications:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.notificationsListener&&this.notificationsListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.notificationsListener&&(this.notificationsListener=(e=this.state.userMD.uid,Bt.collection("notifications").doc("members").collection("invites").where("uid","==",e)).onSnapshot((function(e){var a=[];e.empty||(e.docs.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({notifications:a})})))}},{key:"onRemoveNotification",value:function(e){(function(e){return new Promise((function(t,a){Bt.collection("notifications").doc("members").collection("invites").where("uid","==",e.uid).where("gymClassID","==",e.gymClassID).get().then((function(e){e.empty||(e.docs.forEach((function(e){e.ref.delete()})),t("Removed notifications.")),t("No notifications found.")})).catch((function(e){a(e)}))}))})(e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"acceptInvite",value:function(e){var t=this,a=e.gymClassID,n=e.gymClassTitle,r=e.boxTitle,o=e.boxID,s=(e.memberInviteID,{gymClassID:a,gymClassTitle:n,boxTitle:r,uid:this.state.userMD.uid,boxID:o,username:this.state.userMD.username,date:Date.now()});(function(e,t,a){return new Promise((function(n,r){Ft(e,t).then((function(e){if(e)r("User is a member.");else{var t=Bt.collection("classMembers").doc(),o=Bt.collection("classMembersShallow").doc(a.gymClassID).collection("users").doc(a.uid);Promise.all([t.set(Object(I.a)(Object(I.a)({},a),{},{classMemberID:t.id})),o.set({uid:a.uid,gymClassID:a.gymClassID,classMemberID:t.id})]).then((function(e){n("Added user as a member.")}))}})).catch((function(e){r(e)}))}))})(this.state.userMD.uid,a,s).then((function(a){console.log(a),t.onRemoveNotification(e)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},this.state.notifications.length>0?r.a.createElement(k.a,{elevation:6},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,{variant:"subtitle2"},"Member Notifications")),r.a.createElement(v.a,{item:!0,xs:12},this.state.notifications.map((function(t,a){return r.a.createElement(Ra,{key:a,info:t,removeNotification:e.onRemoveNotification.bind(e),acceptInvite:e.acceptInvite.bind(e)})})))):r.a.createElement(r.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Na=Wa=Object(O.a)(Wa),Va=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(_.a));var Ga=Object(O.a)((function(e){var t=e.info.gymClassTitle,a=e.info.boxTitle,n=e.info.boxID,o="class/".concat(n,"/").concat(e.info.gymClassID);return r.a.createElement(Y.a,{onClick:function(t){return e.onView(o)}},r.a.createElement(Va,null,r.a.createElement(M.a,{color:"primary"},a)),r.a.createElement(Va,null,r.a.createElement(M.a,{color:"primary"},t)))})),za=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,classes:[],redirect:!1,redirectUrl:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD.uid&&!this.userClassAdminsListener&&(this.userClassAdminsListener=(e=this.state.userMD.uid,Ot.collection("classAdmins").where("uid","==",e)).onSnapshot((function(e){var a=[];e.empty||(e.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({classes:a})})))}},{key:"componentWillUnmount",value:function(){this.userClassAdminsListener&&this.userClassAdminsListener()}},{key:"onView",value:function(e){this.setState({redirect:!0,redirectUrl:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.redirect?r.a.createElement(f.a,{to:this.state.redirectUrl}):r.a.createElement(r.a.Fragment,null),this.state.classes.length>0?r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px"}},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,{variant:"subtitle1"},"Admin Roles"),r.a.createElement(J.a,{size:"small"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(Va,{align:"center"},"Gym"),r.a.createElement(Va,{align:"center"},"Class"))),r.a.createElement(q.a,null,this.state.classes.map((function(t,a){return r.a.createElement(Ga,{key:a,info:t,onView:e.onView.bind(e)})})))))):r.a.createElement(r.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ka=za=Object(O.a)(za),Ha=(h.firestore(),Object(x.a)({root:{borderBottom:"none"}})(_.a));var Ja=Object(O.a)((function(e){var t=e.info.gymClassTitle,a=e.info.boxTitle,n=e.info.boxID,o="class/".concat(n,"/").concat(e.info.gymClassID);return r.a.createElement(Y.a,{onClick:function(t){return e.onView(o)}},r.a.createElement(Ha,null,r.a.createElement(M.a,{color:"primary"},a)),r.a.createElement(Ha,null,r.a.createElement(M.a,{color:"primary"},t)))})),Za=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={userMD:e.userMD,classes:[],redirect:!1,redirectUrl:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getListener()}},{key:"componentDidUpdate",value:function(){this.getListener()}},{key:"componentWillUnmount",value:function(){this.userClassMembersListener&&this.userClassMembersListener()}},{key:"getListener",value:function(){var e,t=this;this.state.userMD&&!this.userClassMembersListener&&(this.userClassMembersListener=(e=this.state.userMD.uid,Bt.collection("classMembers").where("uid","==",e)).onSnapshot((function(e){var a=[];e.empty||(e.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1}))),t.setState({classes:a})})))}},{key:"onView",value:function(e){this.setState({redirect:!0,redirectUrl:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.redirect?r.a.createElement(f.a,{key:"redirectClassMemberView",to:this.state.redirectUrl}):r.a.createElement(r.a.Fragment,null),this.state.classes.length>0?r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px"}},r.a.createElement(k.a,{elevation:6},r.a.createElement(M.a,{variant:"subtitle1"},"Membership"),r.a.createElement(J.a,{size:"small"},r.a.createElement(Z.a,null,r.a.createElement(Y.a,null,r.a.createElement(Ha,{align:"center"},"Gym"),r.a.createElement(Ha,{align:"center"},"Class"))),r.a.createElement(q.a,null,this.state.classes.map((function(t,a){return r.a.createElement(Ja,{key:a,info:t,onView:e.onView.bind(e)})})))))):r.a.createElement(r.a.Fragment,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Ya=Za=Object(O.a)(Za),_a=a(344);var qa=Object(x.a)((function(e){return{root:{borderRadius:"4px",height:"5px"}}}))(k.a),Qa=Object(x.a)((function(e){return{root:{background:"transparent",display:"block",borderRadius:"4px",padding:"0px 0px 0px 2px",margin:"1px auto",width:"12%",height:"6px"}}}))(_a.a),Xa=Object(x.a)((function(e){return{root:{display:"flex"}}}))(v.a),$a=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, #ff0b0b, transparent)"}}}))(qa),en=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, grey, transparent)"}}}))(qa),tn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent, #00fb42, #00fb42, ".concat(e.palette.primary.main,")")}}}))(qa),an=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent,  white, ".concat(e.palette.primary.main,")")}}}))(qa),nn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, transparent,  ".concat(e.palette.primary.main,", #6700c5)")}}}))(qa),rn=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, white, #1118f3, #1118f3, white)"}}}))(qa),on=Object(x.a)((function(e){return{root:{background:"linear-gradient(45deg, white, #ffeb00, #ffeb00, white)"}}}))(qa);function sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"grey",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{color:e,valid:t,isToday:a,count:1}}var ln=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(i.a)(this,a),n=t.call(this,e);var r=S.DateTime.now();return n.calendar=n.createCalendar(r),console.log(r),n.state={userMD:e.userMD,scores:e.scores,today:r},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){}},{key:"getFirstOfMonth",value:function(e){return S.DateTime.local(e.year,e.month,1,0,0,0,0)}},{key:"getEndOfMonth",value:function(e){return S.DateTime.local(e.year,e.month,e.daysInMonth,0,0,0,0)}},{key:"getFirstAndLast",value:function(e){return[this.getFirstOfMonth(e),this.getEndOfMonth(e)]}},{key:"createCalendar",value:function(e){for(var t,a,n=this.getFirstAndLast(e),r=Object(j.a)(n,2),o=r[0],s=r[1],i=[],l=[],c=[],u=0;u<7;u++)l.push(sn("white",!0,!1));t=[].concat(l),a=[].concat(l);for(var m=0;m<o.weekday;m++)i.push(sn());for(var h=o.weekday;h<7;h++)i[h]=sn("white",!0,!1);for(var d=0;d<=s.weekday;d++)c.push(sn("white",!0,!1));for(var p=s.weekday+1;p<7;p++)c[p]=sn();for(var f=[[].concat(i),[].concat(l),Object(A.a)(t),Object(A.a)(a),[].concat(c)],v=this.getOffsetDayOfMonthFromDate(o),g=this.getOffsetDayOfMonthFromDate(e),y=7*v[0]+v[1],b=7*g[0]+g[1],E=y;E<b;E++){var x=E%7;f[parseInt(E/7)][x]=sn("red",!0,!1)}var w=b%7;return f[parseInt(b/7)][w]=sn("white",!0,!0),f}},{key:"getOffsetDayOfMonthFromDate",value:function(e){var t=this.getFirstOfMonth(e).weekday+e.day-1;return[parseInt(t/7),t%7]}},{key:"fillCalendar",value:function(){var e,t=[],a=Object(B.a)(this.calendar);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(Object(A.a)(n))}}catch(d){a.e(d)}finally{a.f()}var r,o=Object(B.a)(this.state.scores);try{for(o.s();!(r=o.n()).done;){var s=r.value,i=S.DateTime.fromMillis(s.date),l=this.getOffsetDayOfMonthFromDate(i),c=Object(j.a)(l,2),u=c[0],m=c[1],h=i.day===this.state.today.day&&i.month===this.state.today.month&&i.year===this.state.today.year;"green"!==t[u][m].color?t[u][m]=sn("green",!0,h):t[u][m].count+=1}}catch(d){o.e(d)}finally{o.f()}return t}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,container:!0,xs:12},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(M.a,{gutterBottom:!0,variant:"subtitle2"},this.state.today.monthLong)),r.a.createElement(v.a,{item:!0,xs:3}),r.a.createElement(v.a,{item:!0,container:!0,xs:6},this.fillCalendar().map((function(e,t){return r.a.createElement(Xa,{className:"appearSlow",item:!0,xs:12,key:t},e.map((function(e,t){var a=e.isToday?"whiteBorder":"";if("green"===e.color){var n=null;return 1==e.count&&(n=nn),2==e.count&&(n=rn),3==e.count&&(n=tn),e.count>3&&(n=on),r.a.createElement(Qa,{key:t,className:"appearFast"},r.a.createElement(n,{className:a}))}return"white"===e.color?r.a.createElement(Qa,{key:t},r.a.createElement(an,{className:a})):"red"===e.color?r.a.createElement(Qa,{key:t},r.a.createElement($a,{className:a})):r.a.createElement(Qa,{key:t},r.a.createElement(en,{className:a}))})))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),cn=ln=Object(O.a)(ln);var un=h.firestore(),mn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD,emailAlertOpen:!1,scores:[]},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.cancelablePromise&&(console.log("email cancelled"),this.cancelablePromise.cancel()),this.listener&&this.listener()}},{key:"componentDidMount",value:function(){this.listenForUserScores()}},{key:"listenForUserScores",value:function(){var e=this;this.listener||(this.listener=un.collection("scores").where("uid","==",this.state.user.uid).onSnapshot((function(t){if(t.empty)e.setState({scores:[]});else{var a=[];t.forEach((function(e){a.push(e.data())})),a.sort((function(e,t){return e.date>t.date?1:-1})),e.setState({scores:a})}}),(function(e){console.log(e)})))}},{key:"sendVerificationEmail",value:function(){var e=this,t=new Promise((function(t,a){e.state.user.sendEmailVerification().then((function(){return e.setState({emailAlertOpen:!0})})).catch((function(e){a(e)}))}));this.cancelablePromise=function(e){var t=!1;return{promise:new Promise((function(a,n){e.then((function(e){return t?n({isCanceled:!0}):a(e)}),(function(e){return n(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}(t)}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{item:!0,container:!0,align:"center"},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(aa.a,{in:this.state.emailAlertOpen},r.a.createElement(na.a,{onClose:function(){e.setState({emailAlertOpen:!1})}},"Email sent!"))),r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},r.a.createElement(k.a,{elevation:4},r.a.createElement(M.a,{gutterBottom:!0,variant:"h5"},this.state.userMD.username))),r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},r.a.createElement(k.a,{elevation:4},r.a.createElement(cn,{userMD:this.state.userMD,scores:this.state.scores}))),r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},r.a.createElement(k.a,{elevation:4})),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(v.a,{item:!0,container:!0,xs:12},this.state.user.emailVerified?r.a.createElement(r.a.Fragment,null):r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},r.a.createElement(k.a,{elevation:4},r.a.createElement(M.a,null,"Verification"),r.a.createElement($.a,{color:"secondary",style:{margin:"0px 0px 4px 0px "},onClick:this.sendVerificationEmail.bind(this)},r.a.createElement(M.a,{variant:"subtitle2"},"Send Verification Email")))),r.a.createElement(Fa,{userMD:this.state.userMD}),r.a.createElement(Na,{userMD:this.state.userMD}),r.a.createElement(Ka,{userMD:this.state.userMD}),r.a.createElement(Ya,{userMD:this.state.userMD}),r.a.createElement(v.a,{item:!0,xs:12,style:{margin:"16px 0px 0px 0px "}},r.a.createElement(k.a,{elevation:4},r.a.createElement(Oa,{user:this.state.user,userMD:this.state.userMD})))),r.a.createElement(k.a,{elevation:2,style:{margin:"16px 0px 0px 0px"}},"owner"===this.state.userMD.accountType?r.a.createElement(Da,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert}):r.a.createElement(Ta,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert,scores:this.state.scores}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),hn=Object(O.a)(mn),dn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={user:e.user,userMD:e.userMD},n}return Object(l.a)(a,[{key:"handleLogIn",value:function(e){this.setState({user:e})}},{key:"render",value:function(){return r.a.createElement(v.a,{item:!0,xs:12,id:"profilepage"},r.a.createElement(hn,{user:this.state.user,userMD:this.state.userMD,onAlert:this.props.onAlert}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),pn=dn=Object(O.a)(dn),fn=a(357),vn=a(329),gn=a(337),yn=a(338),bn=a(339),En=a(356),xn=a(336),wn=Object(x.a)((function(e){return{root:{"&:hover":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(fn.a),Cn=Object(x.a)((function(e){return{root:{color:e.palette.text.primary}}}))(M.a),Dn=Object(x.a)((function(e){return{root:{border:"1px solid",borderColor:e.palette.text.primary}}}))(k.a);var kn=Object(O.a)((function(e){return r.a.createElement(na.a,{severity:e.alertInfo.type,onClose:e.onCloseAlert},e.alertInfo.message)})),On=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).menuRef=Object(n.createRef)(),r.state={user:e.user,userMD:e.userMD,open:!1,alertOpen:e.alertOpen,alertInfo:e.alertInfo},r}return Object(l.a)(a,[{key:"handleToggle",value:function(){this.setState({open:!this.state.open})}},{key:"handleClose",value:function(e){console.log("Should close"),this.setState({open:!1})}},{key:"handleListKeyDown",value:function(e){"Tab"===e.key&&(e.preventDefault(),this.setState({open:!1}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(ra.a,{position:"sticky",ref:this.menuRef,style:{background:this.props.theme.palette.background.toolbar}},r.a.createElement(vn.a,{disableGutters:!1},r.a.createElement(Cn,{variant:"h3"},"WodTrackrr"),r.a.createElement("section",{style:{marginLeft:"auto",marginRight:-12}},r.a.createElement(Ue.a,{color:"primary",onClick:this.handleToggle.bind(this)},r.a.createElement(xn.a,null)),r.a.createElement(gn.a,{open:this.state.open,anchorEl:this.menuRef.current,placement:"bottom-end",transition:!0,disablePortal:!0,className:t.popper},(function(t){var a=t.TransitionProps,n=t.placement;return r.a.createElement(yn.a,Object.assign({},a,{style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),r.a.createElement(Dn,null,r.a.createElement(bn.a,{onClickAway:e.handleClose.bind(e)},r.a.createElement(En.a,{id:"menu-list-grow",onKeyDown:e.handleListKeyDown.bind(e)},r.a.createElement(wn,{onClick:e.props.changeTheme},"Change Theme"),r.a.createElement(wn,{onClick:e.handleClose.bind(e),component:p.b,to:"/settings/"},"Settings"),e.state.user?r.a.createElement(wn,{onClick:function(t){e.handleClose.bind(e)(t),e.props.handleLogout()}},"Logout"):r.a.createElement(wn,{component:p.b,to:"/login",onClick:e.handleClose.bind(e)},"Login")))))})))),r.a.createElement(aa.a,{in:this.props.alertOpen},this.state.alertInfo?r.a.createElement(kn,{alertInfo:this.state.alertInfo,onCloseAlert:this.props.onCloseAlert}):r.a.createElement(r.a.Fragment,null)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(n.Component),Mn=Object(x.a)((function(e){return{popper:{zIndex:100}}}),{withTheme:!0})(On),Sn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"handleSubmit",value:function(e){var t=this,a=document.getElementById("email"),n=document.getElementById("password");document.getElementById("passwordConfirm");console.log(a.value,n),h.auth().signInWithEmailAndPassword(a.value,n.value).then((function(e){t.props.onLogin(e.user)})).catch((function(e){t.props.onAlert({type:"warning",message:e.message})}))}},{key:"render",value:function(){return r.a.createElement(v.a,{container:!0,id:"login",align:"center",justify:"center"},r.a.createElement("br",null),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:2},r.a.createElement(M.a,{variant:"h4"},"Login"),r.a.createElement("br",null),r.a.createElement(me.a,{id:"email",style:{margin:8},placeholder:"Email",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(me.a,{id:"password",type:"password",style:{margin:8},placeholder:"Password",margin:"normal",InputLabelProps:{shrink:!0}}),r.a.createElement("br",null),r.a.createElement("br",null))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(k.a,{elevation:2},r.a.createElement($.a,{variant:"outlined",color:"primary",onClick:this.handleSubmit.bind(this)},"Login"),r.a.createElement(p.b,{to:"/register",className:"no-line",style:{paddingLeft:"10px"}},r.a.createElement($.a,{variant:"outlined",color:"secondary"},"Register")))))}}]),a}(n.Component),In={overrides:{MuiContainer:{root:{"background-color":"#212121"}},MuiSelect:{icon:{color:"white"}},MuiInputBase:{root:{}},PrivateTabIndicator:{colorSecondary:{backgroundColor:"white"}},MuiInput:{underline:{"&:before":{borderBottomColor:"white"}}},MuiBottomNavigation:{root:{zIndex:100}}},palette:{common:{black:"#000",white:"#fff"},appBackground:{main:"black"},background:{paper:"#212121",toolbar:"#333333",tableHeader:"#2e3134",default:"rgba(48, 48, 48, 1)"},primary:{main1:"#0072fff7",main:"#4ec5ff",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#14eac3",main:"#14eac3",dark:"#14eac3",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},text:{primary:"#ffffff",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},jn=In=In,An={overrides:{MuiContainer:{root:{"background-color":"#ffffff"}},MuiSelect:{icon:{color:"black"}},PrivateTabIndicator:{colorSecondary:{backgroundColor:"white"}},MuiBottomNavigation:{root:{zIndex:100}}},palette:{common:{black:"#000",white:"#fff"},background:{paper:"#ffffff",toolbar:"#fffffff5",tableHeader:"#f1f1f1",default:"#f1f1f1"},primary:{main1:"#0072fff7",main:"#4ec5ff",mainGrad:"linear-gradient(90deg,#0890fd,#01d3fe)",contrastText:"rgba(255, 255, 255, 1)"},secondary:{light:"#14eac3",main:"#14eac3",dark:"#14eac3",contrastText:"#fff"},error:{light:"#ea4331",main:"#c43627",dark:"#2d0d0b",contrastText:"rgba(255, 255, 255, 1)"},follow:{main:"#09e073"},unfollow:{main:"#e07609"},text:{primary:"#000000",secondary:"#e0dfdf",disabled:"#bdbdbd",hint:"#afafaf"}}},Tn=An=An,Ln=Object(b.a)(jn);Ln=Object(E.a)(Ln);var Pn=Object(b.a)(Tn);Pn=Object(E.a)(Pn);var Bn=Object(x.a)((function(e){return{root:{backgroundColor:e.palette.background.paper}}}))(v.a),Un=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={btmnav:0,user:h.auth().currentUser,userMD:!1,theme:Ln,darkTheme:!0,alertOpen:!1,alertInfo:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.firebaseAuthListener=h.auth().onAuthStateChanged((function(t){var a=h.firestore();if(t){var n=a.collection("users").doc(t.uid);e.userMDListener=n.onSnapshot((function(a){a.exists?e.setState({user:t,userMD:a.data()}):e.setState({user:t,userMD:!1})}),(function(e){console.log(e)}))}else e.setState({user:null,userMD:!1})}))}},{key:"handleLogin",value:function(e){this.setState({user:e})}},{key:"handleLogout",value:function(){var e=this;h.auth().signOut().then((function(){e.setState({user:null})}),(function(e){console.error("Sign Out Error",e)}))}},{key:"componentWillUnmount",value:function(){void 0!==this.firebaseAuthListener&&this.firebaseAuthListener&&this.firebaseAuthListener(),null!==this.userMDListener&&this.userMDListener&&this.userMDListener()}},{key:"changeTheme",value:function(){var e=this.state.darkTheme?Pn:Ln;this.setState({theme:e,darkTheme:!this.state.darkTheme})}},{key:"onAlert",value:function(e){console.log(e),this.setState({alertInfo:e,alertOpen:!0})}},{key:"onCloseAlert",value:function(){this.setState({alertOpen:!1,alertInfo:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement(d.Provider,null,r.a.createElement(p.a,null,r.a.createElement(w.a,{theme:this.state.theme},r.a.createElement(Mn,{className:"header",user:this.state.user,userMD:this.state.userMD,changeTheme:this.changeTheme.bind(this),handleLogout:this.handleLogout.bind(this),alertOpen:this.state.alertOpen,alertInfo:this.state.alertInfo,onCloseAlert:this.onCloseAlert.bind(this)}),r.a.createElement(Bn,{container:!0,id:"testCont"},r.a.createElement(v.a,{item:!0,container:!0,xs:12,style:{minHeight:"100vh",paddingTop:"8px"}},r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/boxSearch"},r.a.createElement(lt,{user:this.state.user,userMD:this.state.userMD,onAlert:this.onAlert.bind(this)})),r.a.createElement(f.b,{exact:!0,path:"/profile"},this.state.user?r.a.createElement(pn,{user:this.state.user,userMD:this.state.userMD,onAlert:this.onAlert.bind(this)}):r.a.createElement(f.a,{to:"/login"})),r.a.createElement(f.b,{path:"/box/:boxID",render:function(t){return r.a.createElement(qe,{userMD:e.state.userMD,boxID:t.match.params.boxID,onAlert:e.onAlert.bind(e)})}}),r.a.createElement(f.b,{path:"/class/:boxID/:gymClassID",render:function(t){return r.a.createElement(ta,{userMD:e.state.userMD,gymClassID:t.match.params.gymClassID,boxID:t.match.params.boxID,onAlert:e.onAlert.bind(e)})}}),r.a.createElement(f.b,{path:"/wod/:gymClassID/:wodID",render:function(t){return r.a.createElement(ke,{userMD:e.state.userMD,gymClassID:t.match.params.gymClassID,wodID:t.match.params.wodID,isReadOnly:!0,onAlert:e.onAlert.bind(e)})}}),r.a.createElement(f.b,{exact:!0,path:"/register",render:function(t){return e.state.user?r.a.createElement(f.a,{to:"/profile"}):r.a.createElement(wt,{onAlert:e.onAlert.bind(e)})}}),r.a.createElement(f.b,{exact:!0,path:"/settings",render:function(t){return r.a.createElement(Et,{user:e.state.user,userMD:e.state.userMD,onAlert:e.onAlert.bind(e)})}}),r.a.createElement(f.b,{exact:!0,path:"/login"},this.state.user?r.a.createElement(f.a,{to:"/boxSearch"}):r.a.createElement(Sn,{onLogin:this.handleLogin.bind(this),onAlert:this.onAlert.bind(this)}))),r.a.createElement("div",{style:{margin:"5vh"}}))),r.a.createElement(g.a,{className:"footer",value:this.state.btmnav,onChange:function(t,a){e.setState({btmnav:a})},style:{background:this.state.theme.palette.primary.mainGrad},showLabels:!0},r.a.createElement(y.a,{label:"Search",component:p.b,to:"/boxSearch",icon:r.a.createElement(D.a,null)}),r.a.createElement(y.a,{label:"Profile",component:p.b,to:"/profile",icon:r.a.createElement(D.a,null)})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t}}]),a}(r.a.Component);Un.contextType=d,s.a.render(r.a.createElement(Un,null),document.getElementById("root"))}},[[170,1,2]]]);
//# sourceMappingURL=main.be161af7.chunk.js.map